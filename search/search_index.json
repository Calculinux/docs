{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Calculinux","text":"<p>Calculinux is a powerful Linux distribution designed specifically for the PicoCalc handheld computer running on the Luckfox Lyra and similar single-board computers (SBCs).</p>"},{"location":"#what-is-calculinux","title":"What is Calculinux?","text":"<p>Calculinux transforms your PicoCalc into a fully-functional Linux computer, opening up endless possibilities for computation, development, and experimentation in a pocket-sized form factor.</p> <p>Built on the robust Yocto Project framework, Calculinux provides:</p> <ul> <li>\u2705 Optimized Performance - Tailored specifically for the PicoCalc hardware</li> <li>\ud83d\udd27 Developer-Friendly - Full access to Linux tools and development environments</li> <li>\ud83d\udce6 Package Management - Easy installation of additional software</li> <li>\ud83c\udfa8 Customizable - Open-source and fully modifiable</li> <li>\ud83d\ude80 Active Development - Regular updates and community support</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li> <p> Getting Started</p> <p>New to Calculinux? Start here to get up and running.</p> <p> Installation Guide</p> </li> <li> <p> Hardware</p> <p>Learn about compatible hardware and modifications.</p> <p> Hardware Guide</p> </li> <li> <p> User Guide</p> <p>Discover how to use Calculinux effectively.</p> <p> User Guide</p> </li> <li> <p> Developer Guide</p> <p>Build, customize, and contribute to Calculinux.</p> <p> Developer Guide</p> </li> </ul>"},{"location":"#community-support","title":"Community &amp; Support","text":"<p>Calculinux is an open-source community project. Join us!</p> <ul> <li>\ud83d\udcac Discord Community: Join our Discord</li> <li>\ud83d\udcac Forum Discussion: ClockworkPi Forum Thread</li> <li>\ud83d\udc1b Issue Tracker: GitHub Issues</li> <li>\ud83d\udca1 Contributing: See our contribution guidelines</li> <li>\ud83d\udcda Source Code: GitHub Repository</li> </ul>"},{"location":"#system-requirements","title":"System Requirements","text":"<p>Minimum Requirements</p> <ul> <li>Hardware: PicoCalc with Luckfox Lyra SBC (128MB RAM)</li> <li>Storage: MicroSD card (8GB minimum, 16GB+ recommended)</li> </ul> <p>See Hardware Requirements for purchasing guidance and Hardware Specifications for complete technical details.</p>"},{"location":"#current-status","title":"Current Status","text":"<p>Calculinux is under active development. The current release includes:</p> <ul> <li>\u2705 Working LCD and keyboard drivers</li> <li>\u2705 Basic system functionality</li> <li>\u2705 Audio drivers</li> <li>\u2705 A/B Upgrade support, preserving user data</li> <li>\u2705 Package management (PRs for new packages welcome!)</li> <li>\ud83d\udea7 Additional hardware support (planned)</li> </ul> <p>Check the roadmap for upcoming features.</p>"},{"location":"#acknowledgments","title":"Acknowledgments","text":"<p>Calculinux builds upon the incredible work of:</p> <ul> <li>hisptoot - Original Luckfox Lyra port and driver development</li> <li>0xd61 - Yocto-based image development</li> <li>johnlaur - Kernel driver and image development</li> <li>nekocharm - display driver contributions</li> <li>benklop - Calculinux organization and setup</li> <li>Luckfox - SDK and hardware support</li> <li>ClockworkPi - PicoCalc hardware</li> <li>Yocto Project - Build system foundation</li> <li>The broader open-source community</li> </ul> <p>Ready to get started?</p> <p>Head over to the Getting Started Guide to begin your Calculinux journey!</p>"},{"location":"about/roadmap/","title":"Roadmap","text":"<p>Active Development</p> <p>Calculinux is under active development. This roadmap outlines planned features and improvements.</p>"},{"location":"about/roadmap/#current-status","title":"Current Status","text":"<p>Calculinux currently includes:</p> <ul> <li>\u2705 Working LCD and keyboard drivers</li> <li>\u2705 Basic system functionality</li> <li>\u2705 Audio drivers</li> <li>\u2705 A/B upgrade support with user data preservation</li> <li>\u2705 Package management (opkg)</li> <li>\u2705 Network support (WiFi, USB)</li> </ul>"},{"location":"about/roadmap/#short-term-goals","title":"Short-term Goals","text":"<p>Q4 2024 - Q1 2025</p> <ul> <li>[ ] Complete documentation for all user guides</li> <li>[ ] Expand hardware compatibility testing</li> <li>[ ] Improve boot time optimization</li> <li>[ ] Additional driver support</li> <li>[ ] Desktop environment options</li> </ul>"},{"location":"about/roadmap/#medium-term-goals","title":"Medium-term Goals","text":"<p>Q2-Q3 2025</p> <ul> <li>[ ] Additional SBC support (Milk-V Duo, etc.)</li> <li>[ ] Enhanced power management</li> <li>[ ] Application ecosystem expansion</li> <li>[ ] Development tooling improvements</li> <li>[ ] Community contribution framework</li> </ul>"},{"location":"about/roadmap/#long-term-vision","title":"Long-term Vision","text":"<p>2025 and Beyond</p> <ul> <li>[ ] Full-featured desktop experience</li> <li>[ ] Comprehensive application library</li> <li>[ ] Hardware expansion support</li> <li>[ ] Multiple board variants</li> <li>[ ] Stable release process</li> <li>[ ] Professional documentation</li> </ul>"},{"location":"about/roadmap/#how-to-contribute","title":"How to Contribute","text":"<p>Interested in helping? See our Contributing Guide for:</p> <ul> <li>Code contributions</li> <li>Documentation improvements</li> <li>Testing and bug reports</li> <li>Feature requests</li> <li>Community support</li> </ul>"},{"location":"about/roadmap/#stay-updated","title":"Stay Updated","text":"<ul> <li>\ud83d\udcac Discord Community: Join our Discord</li> <li>\ud83d\udcac Forum Discussion: Forum Discussion</li> <li>\ud83d\udc1b GitHub Issues: GitHub Issues</li> <li>\ud83d\udcda Source Repository: Source Repository</li> </ul> <p>Roadmap updated: October 2024</p>"},{"location":"developer/adding-packages/","title":"Adding Packages","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for package development guides.</p>"},{"location":"developer/adding-packages/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Developer Overview - Development environment setup</li> <li>Building Calculinux - Building the system</li> <li>Yocto Setup - Yocto/BitBake basics</li> </ul>"},{"location":"developer/adding-packages/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Creating new recipes</li> <li>Using devtool</li> <li>Recipe syntax and structure</li> <li>Package dependencies</li> <li>Testing packages</li> <li>Submitting packages</li> <li>Package maintenance</li> </ul> <p>Content planned for future release</p>"},{"location":"developer/building/","title":"Building Calculinux","text":"<p>This guide covers building the Calculinux distribution from source.</p>"},{"location":"developer/building/#prerequisites","title":"Prerequisites","text":""},{"location":"developer/building/#system-requirements","title":"System Requirements","text":"<ul> <li>Host OS: Linux (Ubuntu 22.04 LTS or similar recommended)</li> <li>Disk Space: Minimum 50GB free space (100GB+ recommended)</li> <li>Memory: 8GB RAM minimum (16GB+ recommended for parallel builds)</li> <li>CPU: Multi-core processor (builds can take 2-6 hours depending on hardware)</li> </ul>"},{"location":"developer/building/#required-software","title":"Required Software","text":"<p>Install the required packages on your build host:</p> <pre><code># Ubuntu/Debian\nsudo apt install gawk wget git diffstat unzip texinfo \\\n    gcc build-essential chrpath socat cpio python3 \\\n    python3-pip python3-pexpect xz-utils debianutils \\\n    iputils-ping python3-git python3-jinja2 libegl1-mesa \\\n    libsdl1.2-dev pylint3 xterm python3-subunit mesa-common-dev \\\n    zstd liblz4-tool\n</code></pre>"},{"location":"developer/building/#build-system-overview","title":"Build System Overview","text":"<p>Calculinux uses the Yocto Project build system with:</p> <ul> <li>Build Tool: KAS for simplified configuration</li> <li>Base: Yocto Scarthgap (4.2)</li> <li>Distribution: Calculinux (based on Poky)</li> <li>Layers: Multiple meta-layers for hardware support and software packages</li> </ul>"},{"location":"developer/building/#quick-start","title":"Quick Start","text":""},{"location":"developer/building/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>mkdir calculinux-build &amp;&amp; cd calculinux-build\ngit clone https://github.com/Calculinux/meta-calculinux.git\ncd meta-calculinux\n</code></pre>"},{"location":"developer/building/#2-build-with-kas","title":"2. Build with KAS","text":"<p>The simplest way to build is using the KAS container:</p> <pre><code>./kas-container --ssh-dir ~/.ssh build --update kas-luckfox-lyra-bundle.yaml\n</code></pre> <p>This command will:</p> <ol> <li>Download all required Yocto layers</li> <li>Configure the build for Luckfox Lyra</li> <li>Build the complete distribution image</li> <li>Generate IPK packages</li> </ol>"},{"location":"developer/building/#3-locate-build-output","title":"3. Locate Build Output","text":"<p>After the build completes (2-6 hours), find your images in:</p> <pre><code>build/tmp/deploy/images/luckfox-lyra/\n</code></pre> <p>Key outputs:</p> <ul> <li><code>calculinux-image-luckfox-lyra.rootfs.wic.gz</code> - Full disk image for initial installation</li> <li><code>calculinux-bundle-luckfox-lyra.raucb</code> - RAUC update bundle for updating existing installations</li> </ul>"},{"location":"developer/building/#build-types-and-package-feed-configuration","title":"Build Types and Package Feed Configuration","text":"<p>Calculinux images are automatically configured with the appropriate package feed based on how they are built. Feeds are pre-configured in the image and typically do not require manual intervention. This section is primarily informational to help you understand the feed structure.</p>"},{"location":"developer/building/#understanding-feed-configuration","title":"Understanding Feed Configuration","text":"<p>Package feeds are organized by:</p> <ol> <li>DISTRO_CODENAME - The Yocto/Poky codename (e.g., <code>walnascar</code> for Scarthgap 4.2)</li> <li>FEED_SUBFOLDER - Either <code>continuous</code> (development) or <code>release</code> (stable tags)</li> </ol> <p>The feed URL structure is: <pre><code>https://opkg.calculinux.org/ipk/{DISTRO_CODENAME}/{FEED_SUBFOLDER}/\n</code></pre></p>"},{"location":"developer/building/#ci-build-configuration-automated","title":"CI Build Configuration (Automated)","text":"<p>When building via GitHub Actions CI, the build system automatically generates <code>build/conf/auto.conf</code> to configure the package feeds:</p> Build Trigger DISTRO_CODENAME FEED_SUBFOLDER Resulting Feed URL <code>main</code> branch push <code>walnascar</code> <code>continuous</code> <code>https://opkg.calculinux.org/ipk/walnascar/continuous/</code> <code>develop</code> branch push <code>develop</code> <code>continuous</code> <code>https://opkg.calculinux.org/ipk/develop/continuous/</code> Tagged release (e.g., <code>v1.0.0</code>) <code>walnascar</code> <code>release</code> <code>https://opkg.calculinux.org/ipk/walnascar/release/</code> Pre-release tag (e.g., <code>v1.0.0-rc1</code>) <code>walnascar</code> <code>release</code> <code>https://opkg.calculinux.org/ipk/walnascar/release/</code> <p>Example auto.conf generated by CI: <pre><code># For main branch:\nDISTRO_CODENAME = \"walnascar\"\nCALCULINUX_FEED_SUBFOLDER = \"continuous\"\n\n# For develop branch:\nDISTRO_CODENAME = \"develop\"\nCALCULINUX_FEED_SUBFOLDER = \"continuous\"\n\n# For tagged release (v1.0.0):\nDISTRO_CODENAME = \"walnascar\"\nCALCULINUX_FEED_SUBFOLDER = \"release\"\n</code></pre></p>"},{"location":"developer/building/#manual-build-configuration","title":"Manual Build Configuration","text":"<p>When you build manually (without CI), auto.conf is not created, so the configuration comes from the distribution defaults in <code>meta-calculinux-distro/conf/distro/calculinux-distro.conf</code>:</p> <pre><code># Default values from calculinux-distro.conf:\nDISTRO_CODENAME = \"walnascar\"           # Inherited from poky.conf\nCALCULINUX_FEED_SUBFOLDER ??= \"continuous\"  # Defaults to continuous\n</code></pre> <p>Manual Build Behavior:</p> What You Do DISTRO_CODENAME FEED_SUBFOLDER Feed URL <code>kas-container build kas-luckfox-lyra-bundle.yaml</code> <code>walnascar</code> (from Poky) <code>continuous</code> (default) <code>ipk/walnascar/continuous/</code> Add <code>CALCULINUX_FEED_SUBFOLDER = \"release\"</code> to <code>build/conf/local.conf</code> <code>walnascar</code> (from Poky) <code>release</code> (override) <code>ipk/walnascar/release/</code> Add <code>DISTRO_CODENAME = \"develop\"</code> to <code>build/conf/local.conf</code> <code>develop</code> (override) <code>continuous</code> (default) <code>ipk/develop/continuous/</code>"},{"location":"developer/building/#feed-configuration-variables","title":"Feed Configuration Variables","text":"<p>These variables control which package feed your image will use:</p> <ul> <li><code>DISTRO_CODENAME</code>: Distribution codename</li> <li>Inherited from <code>poky.conf</code> (currently <code>walnascar</code> for Scarthgap 4.2)</li> <li>CI overrides this to <code>develop</code> for develop branch builds</li> <li> <p>Can be manually overridden in <code>build/conf/local.conf</code> or <code>build/conf/auto.conf</code></p> </li> <li> <p><code>CALCULINUX_FEED_SUBFOLDER</code>: Feed subdirectory</p> </li> <li>Defaults to <code>continuous</code> if not specified</li> <li>CI sets to <code>release</code> for tagged builds</li> <li>Can be manually overridden in <code>build/conf/local.conf</code></li> </ul>"},{"location":"developer/building/#when-to-change-feed-configuration","title":"When to Change Feed Configuration","text":"<p>You typically don't need to change feed configuration unless:</p> <ol> <li>Testing a different feed: You want to test your local build with a different package repository</li> <li>Custom deployment: You're creating a custom image variant with specific package sources</li> <li>Development workflow: You're developing packages and want to use a test feed</li> </ol> <p>To change the feed configuration for manual builds, create or edit <code>build/conf/local.conf</code>:</p> <pre><code># Example: Use the release feed instead of continuous\nCALCULINUX_FEED_SUBFOLDER = \"release\"\n\n# Example: Use the develop feed\nDISTRO_CODENAME = \"develop\"\nCALCULINUX_FEED_SUBFOLDER = \"continuous\"\n</code></pre>"},{"location":"developer/building/#verifying-feed-configuration","title":"Verifying Feed Configuration","text":"<p>To check which feed your image will use:</p> <pre><code># Inside kas-container shell:\n./kas-container shell kas-luckfox-lyra-bundle.yaml\n\n# Query the feed configuration:\nbitbake -e calculinux-image | grep -E \"^(DISTRO_CODENAME|CALCULINUX_FEED_SUBFOLDER|PACKAGE_FEED_BASE_PATHS)=\"\n</code></pre> <p>Example output: <pre><code>DISTRO_CODENAME=\"walnascar\"\nCALCULINUX_FEED_SUBFOLDER=\"continuous\"\nPACKAGE_FEED_BASE_PATHS=\"ipk/walnascar/continuous\"\n</code></pre></p>"},{"location":"developer/building/#how-feed-configuration-works","title":"How Feed Configuration Works","text":"<p>The feed configuration is baked into the image during build:</p> <ol> <li>Build Time: Yocto reads <code>DISTRO_CODENAME</code> and <code>CALCULINUX_FEED_SUBFOLDER</code> variables</li> <li>Image Creation: Feed URL is written to <code>/etc/opkg/opkg.conf</code> in the image</li> <li>Runtime: <code>opkg</code> uses the configured feed URL to install/update packages</li> </ol> <p>Users can still manually change feeds after installation by editing <code>/etc/opkg/opkg.conf</code>, but this is only needed for advanced use cases (see Package Management for details).</p>"},{"location":"developer/building/#configuring-your-build","title":"Configuring Your Build","text":""},{"location":"developer/building/#setting-distribution-codename","title":"Setting Distribution Codename","text":"<p>To manually set the distribution codename, edit <code>conf/local.conf</code>:</p> <pre><code># For stable builds\nDISTRO_CODENAME = \"walnascar\"\n\n# For development builds\nDISTRO_CODENAME = \"develop\"\n</code></pre>"},{"location":"developer/building/#setting-feed-subfolder","title":"Setting Feed Subfolder","text":"<p>To configure the package feed subfolder, edit <code>conf/local.conf</code>:</p> <pre><code># For continuous/rolling releases\nCALCULINUX_FEED_SUBFOLDER = \"continuous\"\n\n# For stable releases\nCALCULINUX_FEED_SUBFOLDER = \"release\"\n</code></pre>"},{"location":"developer/building/#complete-build-configuration-example","title":"Complete Build Configuration Example","text":"<p>For a development build:</p> <pre><code># conf/local.conf\nDISTRO_CODENAME = \"develop\"\nCALCULINUX_FEED_SUBFOLDER = \"continuous\"\n</code></pre> <p>For a release build:</p> <pre><code># conf/local.conf\nDISTRO_CODENAME = \"walnascar\"\nCALCULINUX_FEED_SUBFOLDER = \"release\"\n</code></pre>"},{"location":"developer/building/#build-targets","title":"Build Targets","text":"<p>Calculinux provides several build targets:</p>"},{"location":"developer/building/#main-image","title":"Main Image","text":"<pre><code>bitbake calculinux-image\n</code></pre> <p>The primary Calculinux image with desktop environment and applications.</p>"},{"location":"developer/building/#minimal-image","title":"Minimal Image","text":"<pre><code>bitbake calculinux-image-minimal\n</code></pre> <p>A minimal base system without desktop environment.</p>"},{"location":"developer/building/#sdk","title":"SDK","text":"<pre><code>bitbake calculinux-image -c populate_sdk\n</code></pre> <p>Generates a cross-compilation SDK for application development.</p>"},{"location":"developer/building/#build-options","title":"Build Options","text":""},{"location":"developer/building/#clean-build","title":"Clean Build","text":"<p>To perform a clean build:</p> <pre><code># Clean everything\nbitbake -c cleanall calculinux-image\n\n# Clean specific package\nbitbake -c cleanall &lt;package-name&gt;\n</code></pre>"},{"location":"developer/building/#parallel-builds","title":"Parallel Builds","text":"<p>Configure parallel builds in <code>conf/local.conf</code>:</p> <pre><code># Number of parallel BitBake tasks\nBB_NUMBER_THREADS ?= \"8\"\n\n# Number of parallel make tasks\nPARALLEL_MAKE ?= \"-j 8\"\n</code></pre> <p>Adjust numbers based on your CPU cores and available RAM.</p>"},{"location":"developer/building/#disk-space-management","title":"Disk Space Management","text":"<p>Monitor disk usage:</p> <pre><code># Check build directory size\ndu -sh build/tmp\n\n# Clean shared state cache\nrm -rf build/sstate-cache/*\n\n# Clean downloads (only if needed)\nrm -rf build/downloads/*\n</code></pre>"},{"location":"developer/building/#build-output","title":"Build Output","text":"<p>After a successful build, find images in:</p> <pre><code>build/tmp/deploy/images/luckfox-lyra/\n</code></pre> <p>Key files:</p> <ul> <li><code>calculinux-image-*.wic.gz</code> - Flashable SD card image</li> <li><code>calculinux-image-*.tar.gz</code> - Root filesystem archive</li> <li><code>calculinux-image-*.manifest</code> - List of installed packages</li> </ul>"},{"location":"developer/building/#flashing-the-image","title":"Flashing the Image","text":""},{"location":"developer/building/#to-sd-card-linux","title":"To SD Card (Linux)","text":"<pre><code># Decompress the image\ngunzip calculinux-image-*.wic.gz\n\n# Flash to SD card (replace /dev/sdX with your card)\nsudo dd if=calculinux-image-*.wic of=/dev/sdX bs=4M status=progress\nsudo sync\n</code></pre>"},{"location":"developer/building/#to-sd-card-cross-platform","title":"To SD Card (Cross-platform)","text":"<p>Use Etcher or Raspberry Pi Imager with the <code>.wic.gz</code> file.</p>"},{"location":"developer/building/#cicd-integration","title":"CI/CD Integration","text":"<p>Calculinux uses GitHub Actions for automated builds. The CI system automatically:</p> <ol> <li>Detects the branch or tag being built</li> <li>Sets appropriate <code>DISTRO_CODENAME</code> and <code>CALCULINUX_FEED_SUBFOLDER</code></li> <li>Builds the image</li> <li>Publishes packages to the correct feed location</li> <li>Uploads build artifacts</li> </ol>"},{"location":"developer/building/#ci-configuration-files","title":"CI Configuration Files","text":"<p>The build behavior is controlled by:</p> <ul> <li><code>.github/workflows/build.yml</code> - Main CI workflow</li> <li><code>conf/auto.conf</code> - Auto-generated build configuration</li> <li><code>conf/calculinux.conf</code> - Distribution configuration</li> </ul>"},{"location":"developer/building/#package-feed-publishing","title":"Package Feed Publishing","text":"<p>After building, packages can be published to the opkg feed:</p> <pre><code># Upload to continuous feed (development)\nrsync -avz tmp/deploy/ipk/ \\\n  user@opkg.calculinux.org:/var/www/opkg/ipk/walnascar/continuous/\n\n# Upload to release feed (stable)\nrsync -avz tmp/deploy/ipk/ \\\n  user@opkg.calculinux.org:/var/www/opkg/ipk/walnascar/release/\n</code></pre> <p>The CI system handles this automatically for official builds.</p>"},{"location":"developer/building/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer/building/#build-failures","title":"Build Failures","text":"<p>If a build fails:</p> <ol> <li>Check the error message in the build log</li> <li>Clean the failing package: <code>bitbake -c cleanall &lt;package&gt;</code></li> <li>Retry the build</li> <li>Check Common Issues</li> </ol>"},{"location":"developer/building/#disk-space-issues","title":"Disk Space Issues","text":"<p>If you run out of disk space:</p> <pre><code># Remove old build artifacts\nbitbake -c clean calculinux-image\n\n# Clear shared state cache\nrm -rf build/sstate-cache/*\n</code></pre>"},{"location":"developer/building/#network-issues","title":"Network Issues","text":"<p>If downloads fail:</p> <pre><code># Use mirrors\n# Add to conf/local.conf:\nPREMIRRORS_prepend = \"\\\n  git://.*/.* http://downloads.yoctoproject.org/mirror/sources/ \\n \\\n  ftp://.*/.* http://downloads.yoctoproject.org/mirror/sources/ \\n \\\n  http://.*/.* http://downloads.yoctoproject.org/mirror/sources/ \\n \\\n  https://.*/.* http://downloads.yoctoproject.org/mirror/sources/ \\n\"\n</code></pre>"},{"location":"developer/building/#next-steps","title":"Next Steps","text":"<ul> <li>Customizing Images - Learn how to customize your build</li> <li>Adding Packages - Add your own packages</li> <li>Kernel Development - Customize the kernel</li> <li>Release Process - Create official releases</li> </ul>"},{"location":"developer/building/#see-also","title":"See Also","text":"<ul> <li>Yocto Project Documentation</li> <li>BitBake User Manual</li> <li>Package Management Guide - Using opkg feeds</li> </ul>"},{"location":"developer/calculinux-update/","title":"Calculinux Update System","text":"<p>Developer documentation for the <code>calculinux-update</code> package and OPKG reconciliation system.</p>"},{"location":"developer/calculinux-update/#architecture-overview","title":"Architecture Overview","text":"<p>The Calculinux update system consists of three main components:</p> <pre><code>graph TD\n    subgraph CLI[\"cup (CLI)\"]\n        mirror[Mirror browsing]\n        download[Bundle download]\n        prefetch[Package prefetch]\n        install[RAUC installation]\n    end\n\n    subgraph Hook[\"cup-hook (RAUC Integration)\"]\n        slothook[slot-post-install hook]\n        reconcile[Status file reconciliation]\n        queue[Pending operation queueing]\n    end\n\n    subgraph Postreboot[\"cup-postreboot (Systemd Service)\"]\n        update[opkg update]\n        reinstall[Package reinstall]\n        upgrade[Package upgrade]\n    end\n\n    CLI --&gt; Hook\n    Hook --&gt;|reboot| Postreboot\n\n    style CLI fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\n    style Hook fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    style Postreboot fill:#e8f5e9,stroke:#388e3c,stroke-width:2px</code></pre>"},{"location":"developer/calculinux-update/#module-structure","title":"Module Structure","text":"<pre><code>src/calculinux_update/\n\u251c\u2500\u2500 cli.py              # Main CLI entry point (cup command)\n\u251c\u2500\u2500 config.py           # Configuration file parsing\n\u251c\u2500\u2500 mirror.py           # Mirror browsing and bundle listing\n\u251c\u2500\u2500 installer.py        # RAUC installation and coordination\n\u251c\u2500\u2500 bundle.py           # Bundle extras extraction\n\u251c\u2500\u2500 prefetch.py         # Package prefetch before update\n\u251c\u2500\u2500 hooks.py            # RAUC hook and post-reboot entry points\n\u2514\u2500\u2500 opkg/\n    \u251c\u2500\u2500 status.py       # OPKG status file parser\n    \u2514\u2500\u2500 reconcile.py    # Reconciliation algorithm\n</code></pre>"},{"location":"developer/calculinux-update/#bundle-extras","title":"Bundle Extras","text":""},{"location":"developer/calculinux-update/#overview","title":"Overview","text":"<p>RAUC bundles can include additional files beyond the root filesystem image. Calculinux bundles include a <code>bundle-extras.tar.gz</code> file containing OPKG configuration and package status information from the new image. This enables the prefetch system to work correctly.</p>"},{"location":"developer/calculinux-update/#bundle-structure","title":"Bundle Structure","text":"<pre><code>bundle.raucb (squashfs)\n\u251c\u2500\u2500 manifest.raucb      # RAUC manifest\n\u251c\u2500\u2500 rootfs.img          # Root filesystem image\n\u2514\u2500\u2500 bundle-extras.tar.gz\n    \u2514\u2500\u2500 extras/\n        \u2514\u2500\u2500 opkg/\n            \u251c\u2500\u2500 etc/\n            \u2502   \u2514\u2500\u2500 opkg/\n            \u2502       \u251c\u2500\u2500 opkg.conf\n            \u2502       \u2514\u2500\u2500 *.conf\n            \u2514\u2500\u2500 status.image\n</code></pre>"},{"location":"developer/calculinux-update/#extraction-process","title":"Extraction Process","text":"<p>Module: <code>bundle.py</code></p> <p>The <code>extract_bundle_extras()</code> function performs a two-stage extraction:</p> <ol> <li>Extract tarball from bundle - Uses <code>unsquashfs</code> to extract <code>bundle-extras.tar.gz</code> from the squashfs bundle</li> <li>Extract tarball contents - Uses Python's <code>tarfile</code> module to extract the <code>extras/</code> directory structure</li> </ol> <pre><code>def extract_bundle_extras(bundle_path: Path) -&gt; Optional[BundleExtras]:\n    \"\"\"Extract Calculinux-specific extras from a RAUC bundle.\n\n    Returns None when extras are missing. The caller is responsible for calling\n    ``cleanup`` on the returned BundleExtras once finished with the temporary\n    directory.\n    \"\"\"\n    # Stage 1: Extract tarball from bundle\n    subprocess.run([\n        \"unsquashfs\", \"-f\", \"-d\", str(temp_dir),\n        str(bundle_path), \"bundle-extras.tar.gz\"\n    ])\n\n    # Stage 2: Extract tarball contents\n    with tarfile.open(tarball_path, \"r:gz\") as tar:\n        tar.extractall(path=temp_dir, filter=\"data\")\n\n    # Validate and return\n    if not (temp_dir / \"extras/opkg/status.image\").exists():\n        return None\n\n    return BundleExtras(root=temp_dir, opkg_root=temp_dir / \"extras/opkg\", ...)\n</code></pre> <p>Security: The extraction uses <code>filter=\"data\"</code> (Python 3.13+) to prevent path traversal attacks.</p>"},{"location":"developer/calculinux-update/#bundle-extras-creation","title":"Bundle Extras Creation","text":"<p>Yocto Recipe: <code>meta-calculinux-distro/recipes-core/image/calculinux-image.bb</code></p> <p>The <code>calculinux_export_bundle_extras()</code> function runs during <code>do_rootfs</code>:</p> <pre><code>calculinux_export_bundle_extras() {\n    extras_dir=\"${DEPLOY_DIR_IMAGE}/bundle-extras/extras/opkg\"\n\n    # Export OPKG configuration\n    if [ -d \"${IMAGE_ROOTFS}/etc/opkg\" ]; then\n        install -d \"${extras_dir}/etc\"\n        cp -r \"${IMAGE_ROOTFS}/etc/opkg\" \"${extras_dir}/etc/\"\n    fi\n\n    # Export image status file\n    if [ -f \"${IMAGE_ROOTFS}/var/lib/opkg/status.image\" ]; then\n        install -d \"${extras_dir}\"\n        install -m 0644 \"${IMAGE_ROOTFS}/var/lib/opkg/status.image\" \\\n            \"${extras_dir}/status.image\"\n    fi\n\n    # Create tarball only if we have data\n    if [ \"$has_data\" = \"1\" ]; then\n        tar -czf \"${DEPLOY_DIR_IMAGE}/bundle-extras.tar.gz\" \\\n            -C \"${DEPLOY_DIR_IMAGE}/bundle-extras\" extras\n    fi\n}\n</code></pre> <p>Bundle Recipe: <code>meta-calculinux-distro/recipes-core/bundles/calculinux-bundle.bb</code></p> <pre><code>inherit bundle\n\nRAUC_BUNDLE_EXTRA_FILES += \"bundle-extras.tar.gz\"\n</code></pre> <p>The <code>bundle</code> class automatically includes files listed in <code>RAUC_BUNDLE_EXTRA_FILES</code> from <code>DEPLOY_DIR_IMAGE</code>.</p>"},{"location":"developer/calculinux-update/#why-bundle-extras","title":"Why Bundle Extras?","text":"<p>Without bundle extras, the prefetch system would need to:</p> <ol> <li>Mount the inactive slot after RAUC installation</li> <li>Access the filesystem to read OPKG configuration</li> <li>Deal with potential mounting failures or filesystem issues</li> </ol> <p>With bundle extras:</p> <p>\u2705 Self-contained: Bundle includes all necessary metadata \u2705 No mounting required: Extracts directly from the bundle file \u2705 Offline-friendly: Works even if slots can't be mounted \u2705 Faster: No need to wait for RAUC to finish installation  </p>"},{"location":"developer/calculinux-update/#error-handling","title":"Error Handling","text":"<p>If bundle extras are missing or corrupted:</p> <pre><code>extras = extract_bundle_extras(bundle_path)\nif not extras:\n    # Graceful degradation - skip prefetch\n    console.print(\"[yellow]Bundle extras missing, skipping prefetch[/]\")\n    # Installation continues normally\n</code></pre> <p>The update installation continues without prefetch, but post-reboot reconciliation will require network access.</p>"},{"location":"developer/calculinux-update/#opkg-reconciliation-system","title":"OPKG Reconciliation System","text":""},{"location":"developer/calculinux-update/#the-problem","title":"The Problem","text":"<p>Calculinux uses a dual-layer package system:</p> <ul> <li>Base layer: Read-only packages in the RAUC image (<code>/var/lib/opkg/status.image</code>)</li> <li>Overlay layer: User-installed packages in writable storage (<code>/var/lib/opkg/status</code>)</li> </ul> <p>When updating the base image, three problems arise:</p> <ol> <li>Shadowing: Packages installed in overlay that now exist in the new base (duplicates)</li> <li>Missing packages: Packages removed from new base that overlay packages depend on</li> <li>Version conflicts: Overlay packages built against old base versions</li> </ol>"},{"location":"developer/calculinux-update/#the-solution","title":"The Solution","text":"<p>The reconciliation system solves this in three phases:</p>"},{"location":"developer/calculinux-update/#phase-1-prefetch-before-update","title":"Phase 1: Prefetch (Before Update)","text":"<p>Module: <code>prefetch.py</code>, <code>bundle.py</code></p> <pre><code>def prefetch_for_bundle(\n    bundle_path: str,\n    bundle_sha256: str,\n    console: Optional[Console] = None\n) -&gt; PrefetchResult:\n    \"\"\"Pre-download packages needed for reconciliation.\"\"\"\n</code></pre> <p>Process:</p> <ol> <li>Extract bundle extras from the RAUC bundle</li> <li>Load OPKG configuration and status.image from extras</li> <li>Compute reconciliation plan against current writable status</li> <li>Download all packages marked for reinstall using bundle's OPKG config</li> <li>Cache packages in <code>/var/cache/calculinux-update/prefetch/</code></li> </ol> <p>Key Implementation:</p> <pre><code># Extract bundle extras\nextras = extract_bundle_extras(bundle_path)\nif not extras:\n    return PrefetchResult(skipped=True, reason=\"bundle extras missing\")\n\n# Use extras to configure opkg downloader\ndownloader = OpkgDownloader(extras.opkg_root)\ndownloaded = downloader.download(plan.reinstall, PREFETCH_CACHE_DIR)\n</code></pre> <p>Benefits:</p> <ul> <li>No need to mount inactive slot during prefetch</li> <li>Self-contained: All metadata in the bundle</li> <li>Offline reconciliation capability</li> <li>Faster post-reboot (packages already cached)</li> <li>Handles network unavailability during reboot</li> </ul>"},{"location":"developer/calculinux-update/#phase-2-hook-during-rauc-install","title":"Phase 2: Hook (During RAUC Install)","text":"<p>Module: <code>hooks.py</code> \u2192 <code>run_slot_hook()</code></p> <p>RAUC Integration:</p> <pre><code># /etc/rauc/system.conf\n[hooks]\npost-install=/usr/bin/cup-hook\n</code></pre> <p>Process:</p> <ol> <li>Triggered by RAUC during <code>slot-post-install</code> phase</li> <li>Mounts newly installed slot read-only</li> <li>Loads current writable status and new slot's status</li> <li>Computes reconciliation plan</li> <li>Prunes writable status - removes packages now in base</li> <li>Writes pending operation files:</li> <li><code>/var/lib/opkg/opkg-status-hook.pending-reinstalls</code></li> <li><code>/var/lib/opkg/opkg-status-hook.pending-upgrades</code></li> </ol> <p>Key Implementation:</p> <pre><code>def run_slot_hook(slot_device: str, slot_type: str) -&gt; bool:\n    \"\"\"RAUC hook for slot-post-install phase.\"\"\"\n\n    # 1. Mount new slot\n    with TemporaryDirectory() as tmpdir:\n        subprocess.run([\"mount\", \"-o\", \"ro\", slot_device, tmpdir])\n\n        # 2. Load status files\n        writable_status = load_status_entries(\"/var/lib/opkg/status\")\n        new_image_status = load_status_entries(f\"{tmpdir}/var/lib/opkg/status.image\")\n\n        # 3. Compute plan\n        plan = compute_reconcile_plan(writable_status, new_image_status)\n\n        # 4. Prune writable status (remove duplicates)\n        pruned_status = [e for e in writable_status if e[\"Package\"] not in plan.remove_overlay]\n        write_status_entries(\"/var/lib/opkg/status\", pruned_status)\n\n        # 5. Queue pending operations\n        write_pending_file(\"pending-reinstalls\", plan.reinstall_packages)\n        write_pending_file(\"pending-upgrades\", plan.upgrade_packages)\n</code></pre> <p>Critical: This phase runs in the pre-reboot environment with the new slot mounted. After this, the writable status is clean and ready for the new slot.</p>"},{"location":"developer/calculinux-update/#phase-3-post-reboot-after-slot-switch","title":"Phase 3: Post-Reboot (After Slot Switch)","text":"<p>Module: <code>hooks.py</code> \u2192 <code>postreboot_entrypoint()</code></p> <p>Systemd Integration:</p> <pre><code># /lib/systemd/system/calculinux-update-postreboot.service\n[Unit]\nDescription=Calculinux Update Post-Reboot Package Reconciliation\nAfter=network-online.target\nConditionPathExists=/var/lib/opkg/opkg-status-hook.pending-reinstalls\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/cup-postreboot\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Process:</p> <ol> <li>Runs on first boot into new slot (triggered by pending files)</li> <li>Updates opkg package feeds (<code>opkg update</code>)</li> <li>Reinstalls packages removed from base:    <pre><code>for pkg in plan.reinstall_packages:\n    opkg(\"install\", pkg)  # Prefers cached .ipk if available\n</code></pre></li> <li>Upgrades overlay packages to match new base:    <pre><code>for pkg in plan.upgrade_packages:\n    opkg(\"upgrade\", pkg)\n</code></pre></li> <li>Cleans up pending files</li> </ol> <p>Key Implementation:</p> <pre><code>def postreboot_entrypoint() -&gt; int:\n    \"\"\"Post-reboot package reconciliation.\"\"\"\n\n    # Load pending operations\n    reinstalls = read_pending_file(\"pending-reinstalls\")\n    upgrades = read_pending_file(\"pending-upgrades\")\n\n    # Update feeds\n    run_opkg_command([\"update\"])\n\n    # Reinstall missing packages\n    for pkg in reinstalls:\n        cached_ipk = _find_cached_package(pkg)\n        if cached_ipk:\n            run_opkg_command([\"install\", cached_ipk])\n        else:\n            run_opkg_command([\"install\", pkg])\n\n    # Upgrade overlay packages\n    for pkg in upgrades:\n        run_opkg_command([\"upgrade\", pkg])\n\n    # Cleanup\n    remove_pending_files()\n</code></pre> <p>Cache Preference: The system prefers prefetched <code>.ipk</code> files from <code>/var/cache/calculinux-update/opkg-cache/</code> for offline operation.</p>"},{"location":"developer/calculinux-update/#reconciliation-algorithm","title":"Reconciliation Algorithm","text":"<p>Module: <code>reconcile.py</code></p> <p>Core Function:</p> <pre><code>@dataclass\nclass ReconcilePlan:\n    \"\"\"Plan for reconciling overlay packages with new base image.\"\"\"\n    remove_overlay: List[str]      # Packages now in base (duplicates)\n    reinstall_packages: List[str]  # Missing packages to reinstall\n    upgrade_packages: List[str]    # Overlay packages to upgrade\n\ndef compute_reconcile_plan(\n    writable_status: List[StatusEntry],\n    new_image_status: List[StatusEntry]\n) -&gt; ReconcilePlan:\n    \"\"\"Compute what needs to change in writable status.\"\"\"\n</code></pre> <p>Algorithm:</p> <ol> <li> <p>Identify duplicates - packages in both writable and new image:    <pre><code>writable_pkgs = {e[\"Package\"] for e in writable_status}\nnew_image_pkgs = {e[\"Package\"] for e in new_image_status}\nremove_overlay = list(writable_pkgs &amp; new_image_pkgs)\n</code></pre></p> </li> <li> <p>Find missing packages - packages removed from new image:    <pre><code>old_image_status = load_status_entries(\"/var/lib/opkg/status.image\")\nold_image_pkgs = {e[\"Package\"] for e in old_image_status}\nmissing_from_new = old_image_pkgs - new_image_pkgs\n\n# Only reinstall if writable packages depend on them\nreinstall = []\nfor pkg in missing_from_new:\n    if any(pkg in get_dependencies(w) for w in writable_status):\n        reinstall.append(pkg)\n</code></pre></p> </li> <li> <p>Identify upgrades needed - overlay packages that may conflict:    <pre><code>upgrade_packages = []\nfor entry in writable_status:\n    pkg_name = entry[\"Package\"]\n    if pkg_name not in remove_overlay:  # Not a duplicate\n        upgrade_packages.append(pkg_name)\n</code></pre></p> </li> </ol> <p>Why upgrade everything?: Overlay packages were compiled against the old base. The new base may have updated shared libraries or APIs. Upgrading ensures ABI compatibility.</p>"},{"location":"developer/calculinux-update/#status-file-parsing","title":"Status File Parsing","text":"<p>Module: <code>status.py</code></p> <p>Format: OPKG status files use a paragraph-based format (like Debian control files):</p> <pre><code>Package: foo\nVersion: 1.0-r0\nDepends: libbar (&gt;= 2.0)\nStatus: install user installed\nArchitecture: cortexa9t2hf-neon\n\nPackage: bar\n...\n</code></pre> <p>Key Functions:</p> <pre><code>def load_status_entries(status_path: str) -&gt; List[StatusEntry]:\n    \"\"\"Parse status file into list of package entries.\"\"\"\n    # Returns list of dicts, one per package\n\ndef write_status_entries(status_path: str, entries: List[StatusEntry]) -&gt; None:\n    \"\"\"Write entries back to status file.\"\"\"\n    # Preserves original format and field order\n\ndef _iter_paragraphs(file: TextIO) -&gt; Iterator[List[str]]:\n    \"\"\"Iterate over paragraph blocks in status file.\"\"\"\n    # Handles blank lines, comments, continuations\n</code></pre> <p>Robustness:</p> <ul> <li>Handles missing files (returns empty list)</li> <li>Preserves field order when round-tripping</li> <li>Respects blank lines between entries</li> <li>Case-insensitive field lookup</li> </ul>"},{"location":"developer/calculinux-update/#configuration","title":"Configuration","text":"<p>Module: <code>config.py</code></p> <p>File: <code>/etc/calculinux-update.toml</code></p> <pre><code>@dataclass\nclass ChannelConfig:\n    name: str\n    path: str\n    enable: bool = True\n\n@dataclass\nclass AppConfig:\n    mirror_base_url: str\n    channels: List[ChannelConfig]\n    cache_dir: str = \"/var/cache/calculinux-update\"\n\ndef load_config() -&gt; AppConfig:\n    \"\"\"Load config from /etc or fallback to package defaults.\"\"\"\n</code></pre> <p>Configuration Resolution:</p> <ol> <li>Try <code>/etc/calculinux-update.toml</code> (system config)</li> <li>Fall back to <code>src/calculinux_update/defaults/calculinux-update.toml</code></li> <li>Merge channels (system config channels override defaults by name)</li> </ol>"},{"location":"developer/calculinux-update/#mirror-browsing","title":"Mirror Browsing","text":"<p>Module: <code>mirror.py</code></p> <p>Structure:</p> <pre><code>@dataclass\nclass BundleInfo:\n    filename: str\n    timestamp: datetime\n    size: int\n    sha256: Optional[str] = None\n\ndef list_bundles_for_channel(\n    channel: ChannelConfig,\n    base_url: str\n) -&gt; List[BundleInfo]:\n    \"\"\"List available bundles from mirror channel.\"\"\"\n    # Fetches channel/bundles.txt\n    # Parses bundle metadata\n    # Sorts by timestamp (newest first)\n</code></pre> <p>Bundles Metadata (<code>bundles.txt</code>):</p> <pre><code># timestamp filename size sha256\n1732147200 calculinux-bundle-20241120.raucb 123456789 abc123...\n1731542400 calculinux-bundle-20241113.raucb 123456780 def456...\n</code></pre> <p>Download:</p> <pre><code>def download_bundle(\n    bundle: BundleInfo,\n    channel: ChannelConfig,\n    base_url: str,\n    destination: str,\n    verify_checksum: bool = True\n) -&gt; bool:\n    \"\"\"Download bundle from mirror with optional verification.\"\"\"\n</code></pre>"},{"location":"developer/calculinux-update/#installation-flow","title":"Installation Flow","text":"<p>Module: <code>installer.py</code></p> <p>Main Orchestrator:</p> <pre><code>def install_update_interactive(\n    config: AppConfig,\n    channel_name: Optional[str] = None,\n    bundle_name: Optional[str] = None,\n    dry_run: bool = False,\n    prefetch: bool = True,\n    require_confirmation: bool = True\n) -&gt; bool:\n    \"\"\"Interactive update installation with prefetch.\"\"\"\n</code></pre> <p>Process:</p> <ol> <li>Select channel - prompt if not specified</li> <li>List bundles - from mirror, sorted newest first</li> <li>Select bundle - prompt if not specified</li> <li>Prefetch packages - if enabled and not dry-run</li> <li>Download bundle - to cache directory</li> <li>Confirm installation - if required</li> <li>Invoke RAUC - <code>rauc install &lt;bundle&gt;</code></li> </ol> <p>RAUC Integration:</p> <pre><code>def install_with_rauc(bundle_path: str) -&gt; bool:\n    \"\"\"Install bundle using RAUC.\"\"\"\n    result = subprocess.run(\n        [\"rauc\", \"install\", bundle_path],\n        capture_output=True,\n        text=True\n    )\n    return result.returncode == 0\n</code></pre>"},{"location":"developer/calculinux-update/#testing","title":"Testing","text":""},{"location":"developer/calculinux-update/#test-structure","title":"Test Structure","text":"<pre><code>tests/\n\u251c\u2500\u2500 test_cli.py             # CLI argument parsing and commands\n\u251c\u2500\u2500 test_config.py          # Configuration loading\n\u251c\u2500\u2500 test_mirror.py          # Mirror browsing and downloads\n\u251c\u2500\u2500 test_installer.py       # Installation orchestration\n\u251c\u2500\u2500 test_opkg_status.py     # Status file parsing\n\u251c\u2500\u2500 test_opkg_reconcile.py  # Reconciliation algorithm\n\u251c\u2500\u2500 test_hooks.py           # Hook and post-reboot logic\n\u2514\u2500\u2500 test_prefetch.py        # Package prefetch\n</code></pre>"},{"location":"developer/calculinux-update/#key-testing-principles","title":"Key Testing Principles","text":"<p>Avoid Brittleness:</p> <pre><code># \u274c BAD: Too specific, fragile\ndef test_find_booted_device(mock_run):\n    mock_run.return_value = MagicMock(stdout=\"/dev/mmcblk0p1\")\n    device = find_booted_device()\n    assert device == \"/dev/mmcblk0p1\"  # Breaks if device changes\n\n# \u2705 GOOD: Checks behavior, not exact values\ndef test_find_booted_device(mock_run):\n    mock_run.return_value = MagicMock(stdout=\"/dev/mmcblk0p1\")\n    device = find_booted_device()\n    assert device.startswith(\"/dev/\")  # Flexible\n    assert len(device) &gt; 0\n</code></pre> <p>Test Behavior, Not Implementation:</p> <pre><code># \u274c BAD: Tests exact argument order\ndef test_install_pkg(mock_run):\n    install_package(\"foo\")\n    mock_run.assert_called_with([\"opkg\", \"install\", \"foo\"])\n\n# \u2705 GOOD: Tests that package is installed\ndef test_install_pkg(mock_run):\n    install_package(\"foo\")\n    args = mock_run.call_args[0][0]\n    assert \"install\" in args\n    assert \"foo\" in args\n</code></pre>"},{"location":"developer/calculinux-update/#running-tests","title":"Running Tests","text":"<pre><code># All tests with coverage\npytest --cov=calculinux_update --cov-report=term-missing\n\n# Specific module\npytest tests/test_hooks.py -v\n\n# Coverage threshold (CI)\npytest --cov=calculinux_update --cov-fail-under=80\n</code></pre> <p>Current Coverage: ~84% (above 80% threshold)</p>"},{"location":"developer/calculinux-update/#mocking-external-commands","title":"Mocking External Commands","text":"<p>RAUC:</p> <pre><code>@patch(\"subprocess.run\")\ndef test_rauc_install(mock_run):\n    mock_run.return_value = MagicMock(returncode=0)\n    result = install_with_rauc(\"/tmp/bundle.raucb\")\n    assert result is True\n    assert any(\"rauc\" in str(call) for call in mock_run.call_args_list)\n</code></pre> <p>OPKG:</p> <pre><code>@patch(\"subprocess.run\")\ndef test_opkg_update(mock_run):\n    mock_run.return_value = MagicMock(returncode=0, stdout=\"Updated 3 feeds\")\n    run_opkg_command([\"update\"])\n    assert mock_run.called\n</code></pre>"},{"location":"developer/calculinux-update/#integration-points","title":"Integration Points","text":""},{"location":"developer/calculinux-update/#rauc","title":"RAUC","text":"<p>Configuration: <code>/etc/rauc/system.conf</code></p> <pre><code>[hooks]\npost-install=/usr/bin/cup-hook\n</code></pre> <p>Hook Environment Variables:</p> <ul> <li><code>RAUC_SLOT_DEVICE</code> - Block device of newly installed slot (e.g., <code>/dev/mmcblk0p2</code>)</li> <li><code>RAUC_SLOT_TYPE</code> - Slot type (<code>rootfs</code>)</li> <li><code>RAUC_SLOT_NAME</code> - Slot identifier (<code>rootfs.1</code>)</li> </ul>"},{"location":"developer/calculinux-update/#systemd","title":"Systemd","text":"<p>Service File: <code>/lib/systemd/system/calculinux-update-postreboot.service</code></p> <p>Activation: Triggered by <code>ConditionPathExists</code> on pending files.</p> <p>Ordering:</p> <ul> <li><code>After=network-online.target</code> - Ensures network for opkg update</li> <li><code>Type=oneshot</code> - Runs once and exits</li> <li><code>RemainAfterExit=yes</code> - Marks as successful after completion</li> </ul>"},{"location":"developer/calculinux-update/#opkg","title":"OPKG","text":"<p>Configuration: <code>/etc/opkg/opkg.conf</code></p> <pre><code>src/gz calculinux http://feeds.example.com/release\ndest root /\nlists_dir ext /var/lib/opkg/lists\n</code></pre> <p>Key Paths:</p> <ul> <li><code>/var/lib/opkg/status</code> - Current installed packages (writable)</li> <li><code>/var/lib/opkg/status.image</code> - Base image packages (read-only)</li> <li><code>/var/lib/opkg/lists/</code> - Package feed metadata</li> <li><code>/var/cache/calculinux-update/opkg-cache/</code> - Prefetched .ipk files</li> </ul>"},{"location":"developer/calculinux-update/#error-handling_1","title":"Error Handling","text":""},{"location":"developer/calculinux-update/#prefetch-failures","title":"Prefetch Failures","text":"<p>Scenario: opkg not configured, no network, missing feeds</p> <p>Handling:</p> <pre><code>def prefetch_for_bundle(...) -&gt; bool:\n    try:\n        # Attempt download\n        return downloader.download_packages(packages)\n    except Exception as e:\n        logger.warning(f\"Prefetch failed: {e}\")\n        logger.warning(\"Continuing without prefetch - network required after reboot\")\n        return False\n    # Install proceeds regardless\n</code></pre> <p>User Impact: Post-reboot reconciliation requires network if prefetch fails.</p>"},{"location":"developer/calculinux-update/#hook-failures","title":"Hook Failures","text":"<p>Scenario: Can't mount slot, status parsing fails, write failures</p> <p>Handling:</p> <pre><code>def run_slot_hook(...) -&gt; bool:\n    try:\n        # Mount, reconcile, prune, queue\n        return True\n    except Exception as e:\n        logger.error(f\"Hook failed: {e}\")\n        logger.error(\"Reconciliation may be incomplete\")\n        return False\n    # RAUC install continues (slot is valid even if hook fails)\n</code></pre> <p>User Impact: May have duplicate packages or conflicts after reboot. Manual intervention required (<code>opkg remove &lt;pkg&gt;</code>).</p>"},{"location":"developer/calculinux-update/#post-reboot-failures","title":"Post-Reboot Failures","text":"<p>Scenario: Network unavailable, missing packages, opkg failures</p> <p>Handling:</p> <pre><code>def postreboot_entrypoint() -&gt; int:\n    try:\n        # Update feeds, reinstall, upgrade\n        remove_pending_files()\n        return 0\n    except Exception as e:\n        logger.error(f\"Post-reboot failed: {e}\")\n        # Leave pending files for retry\n        return 1\n</code></pre> <p>User Impact: Service fails, pending files remain. User can:</p> <ol> <li>Fix network/feeds and <code>systemctl restart calculinux-update-postreboot</code></li> <li>Manually reconcile with <code>opkg</code></li> <li>Roll back to previous slot</li> </ol>"},{"location":"developer/calculinux-update/#performance-considerations","title":"Performance Considerations","text":""},{"location":"developer/calculinux-update/#prefetch-optimization","title":"Prefetch Optimization","text":"<ul> <li>Parallel downloads: Consider <code>asyncio</code> or threads for multiple packages</li> <li>Delta updates: RAUC supports delta bundles (not currently implemented)</li> <li>Cache cleanup: Old prefetched packages can accumulate</li> </ul>"},{"location":"developer/calculinux-update/#mount-operations","title":"Mount Operations","text":"<ul> <li>Read-only mounts: Hook mounts slots read-only (safe)</li> <li>Unmount cleanup: Use <code>try/finally</code> or <code>with TemporaryDirectory()</code></li> <li>Device detection: <code>findmnt</code> is fast, fallback to <code>/proc/cmdline</code> parsing</li> </ul>"},{"location":"developer/calculinux-update/#status-file-size","title":"Status File Size","text":"<ul> <li>Typical size: A few hundred KB (hundreds of packages)</li> <li>Parse time: &lt;100ms even for large status files</li> <li>Memory usage: Status entries held in memory during reconciliation</li> </ul>"},{"location":"developer/calculinux-update/#future-enhancements","title":"Future Enhancements","text":""},{"location":"developer/calculinux-update/#planned-features","title":"Planned Features","text":"<ol> <li>Delta bundles - Smaller downloads for incremental updates</li> <li>Rollback detection - Detect and skip reconciliation if rolling back to known slot</li> <li>Cache cleanup - Automatic cleanup of old prefetched packages</li> <li>Metrics - Report reconciliation statistics (packages pruned, reinstalled, upgraded)</li> <li>Dry-run reconciliation - Preview reconciliation plan before install</li> </ol>"},{"location":"developer/calculinux-update/#architecture-improvements","title":"Architecture Improvements","text":"<ol> <li>Async downloads - Speed up prefetch with concurrent downloads</li> <li>Dependency resolution - Smarter reinstall logic based on actual dependencies</li> <li>Version pinning - Option to prevent automatic upgrades of specific packages</li> <li>Custom hooks - Allow site-specific pre/post reconciliation scripts</li> </ol>"},{"location":"developer/calculinux-update/#debugging","title":"Debugging","text":""},{"location":"developer/calculinux-update/#enable-debug-logging","title":"Enable Debug Logging","text":"<p>Set <code>LOGLEVEL</code> environment variable:</p> <pre><code>LOGLEVEL=DEBUG cup install\nLOGLEVEL=DEBUG cup-hook /dev/mmcblk0p2 rootfs\nLOGLEVEL=DEBUG cup-postreboot\n</code></pre>"},{"location":"developer/calculinux-update/#inspect-status-files","title":"Inspect Status Files","text":"<pre><code># Current writable status\ncat /var/lib/opkg/status\n\n# Base image status\ncat /var/lib/opkg/status.image\n\n# Pending operations\ncat /var/lib/opkg/opkg-status-hook.pending-reinstalls\ncat /var/lib/opkg/opkg-status-hook.pending-upgrades\n</code></pre>"},{"location":"developer/calculinux-update/#manual-reconciliation","title":"Manual Reconciliation","text":"<pre><code># Simulate hook\nsudo cup-hook /dev/mmcblk0p2 rootfs\n\n# Simulate post-reboot\nsudo cup-postreboot\n\n# Manually prune duplicates\nsudo opkg remove &lt;package&gt;\n\n# Manually upgrade all\nsudo opkg upgrade\n</code></pre>"},{"location":"developer/calculinux-update/#test-reconciliation-plan","title":"Test Reconciliation Plan","text":"<pre><code>from calculinux_update.opkg.status import load_status_entries\nfrom calculinux_update.opkg.reconcile import compute_reconcile_plan\n\nwritable = load_status_entries(\"/var/lib/opkg/status\")\nnew_image = load_status_entries(\"/mnt/newslot/var/lib/opkg/status.image\")\nplan = compute_reconcile_plan(writable, new_image)\n\nprint(f\"Remove: {plan.remove_overlay}\")\nprint(f\"Reinstall: {plan.reinstall_packages}\")\nprint(f\"Upgrade: {plan.upgrade_packages}\")\n</code></pre>"},{"location":"developer/calculinux-update/#references","title":"References","text":"<ul> <li>RAUC Documentation</li> <li>OPKG Package Manager</li> <li>Yocto Project</li> <li>Systemd Service Units</li> </ul> <p>For user-facing documentation, see User Guide: System Updates</p>"},{"location":"developer/contributing/","title":"Contributing","text":"<p>Guidelines for contributing to the Calculinux project.</p>"},{"location":"developer/contributing/#getting-started","title":"Getting Started","text":"<p>How to start contributing to Calculinux.</p>"},{"location":"developer/contributing/#code-contributions","title":"Code Contributions","text":"<p>Guidelines for code contributions.</p>"},{"location":"developer/contributing/#documentation-contributions","title":"Documentation Contributions","text":"<p>How to improve documentation.</p>"},{"location":"developer/contributing/#testing-and-bug-reports","title":"Testing and Bug Reports","text":"<p>Reporting bugs and testing procedures.</p>"},{"location":"developer/contributing/#development-workflow","title":"Development Workflow","text":"<p>Git workflow and development process.</p> <p>This page is under development and will be populated with detailed contribution guidelines.</p>"},{"location":"developer/customization/","title":"Customizing Calculinux","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for customization guides.</p>"},{"location":"developer/customization/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Developer Overview - Development setup and workflow</li> <li>Building Calculinux - How to build images</li> <li>Contributing - How to contribute changes</li> </ul>"},{"location":"developer/customization/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Image customization</li> <li>Adding/removing packages</li> <li>Custom configurations</li> <li>Creating variants</li> <li>Local modifications</li> <li>Custom recipes</li> <li>Advanced configuration</li> </ul> <p>Content planned for future release</p>"},{"location":"developer/kernel/","title":"Kernel Development","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for kernel development guides.</p>"},{"location":"developer/kernel/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Developer Overview - Development environment</li> <li>Building Calculinux - Building system images</li> <li>Display &amp; Input Drivers - Driver implementation examples</li> </ul>"},{"location":"developer/kernel/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Kernel compilation</li> <li>Device tree modifications</li> <li>Kernel configuration</li> <li>Driver development</li> <li>Kernel debugging</li> <li>Submitting kernel patches</li> <li>Rockchip-specific kernel features</li> </ul> <p>Content planned for future release</p>"},{"location":"developer/overview/","title":"Developer Overview","text":"<p>Welcome to the Calculinux developer documentation! This section covers everything you need to know to build, customize, and contribute to Calculinux.</p>"},{"location":"developer/overview/#what-youll-learn","title":"What You'll Learn","text":"<p>This developer guide covers:</p> <ul> <li>Setting up the Yocto build environment</li> <li>Building Calculinux from source</li> <li>Customizing images and configurations</li> <li>Adding packages and applications</li> <li>Kernel and driver development</li> <li>Contributing to the project</li> <li>Release processes</li> </ul>"},{"location":"developer/overview/#who-this-guide-is-for","title":"Who This Guide Is For","text":"<p>This guide is for:</p> <ul> <li>Developers wanting to build Calculinux from source</li> <li>Contributors interested in improving Calculinux</li> <li>Customizers needing specific configurations</li> <li>Maintainers managing their own distributions</li> <li>Learners exploring embedded Linux development</li> </ul>"},{"location":"developer/overview/#prerequisites","title":"Prerequisites","text":""},{"location":"developer/overview/#knowledge-requirements","title":"Knowledge Requirements","text":"<p>You should be familiar with:</p> <ul> <li>Linux command line - Basic shell operations</li> <li>Git - Version control basics</li> <li>Make/build systems - Compilation processes</li> <li>C/C++ (for kernel/driver work)</li> <li>Python (helpful for Yocto recipes)</li> </ul>"},{"location":"developer/overview/#system-requirements","title":"System Requirements","text":"<p>For building Calculinux, you need:</p> Requirement Minimum Recommended OS Linux (Ubuntu 20.04+) Linux (Ubuntu 22.04 LTS) CPU 4 cores 8+ cores RAM 8 GB 16+ GB Disk Space 50 GB 100+ GB (SSD preferred) Internet Required Fast connection <p>Why Linux?</p> <p>While Yocto can run in VMs or containers on other OSes, native Linux is strongly recommended for performance and compatibility.</p>"},{"location":"developer/overview/#calculinux-architecture","title":"Calculinux Architecture","text":""},{"location":"developer/overview/#overview","title":"Overview","text":"<p>Calculinux is built using the Yocto Project, a powerful framework for creating custom Linux distributions.</p> <pre><code>Calculinux Architecture:\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502        Applications                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502     Desktop Environment (Optional)  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502      Package Management (opkg)      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         System Libraries            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502        Linux Kernel 5.10.x          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502         U-Boot Bootloader           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502    Hardware (Luckfox Lyra/RV1106)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/overview/#key-components","title":"Key Components","text":"<p>meta-calculinux - Main Yocto layer for Calculinux - Machine configurations - Custom recipes and patches - Image definitions</p> <p>Linux Kernel - Based on Rockchip 5.10 kernel - Custom drivers (display, keyboard) - Device tree configurations - Hardware support</p> <p>Bootloader - U-Boot for RV1106 - Boot scripts - Device tree selection</p> <p>Userspace - Based on OpenEmbedded core - Package management (opkg) - System services (systemd) - Optional desktop environments</p>"},{"location":"developer/overview/#repository-structure","title":"Repository Structure","text":""},{"location":"developer/overview/#main-repository","title":"Main Repository","text":"<p>The meta-calculinux repository uses a multi-layer Yocto structure:</p> <pre><code>meta-calculinux/\n\u251c\u2500\u2500 meta-calculinux-distro/      # Distribution layer\n\u2502   \u251c\u2500\u2500 conf/distro/\n\u2502   \u2502   \u2514\u2500\u2500 calculinux-distro.conf\n\u2502   \u251c\u2500\u2500 recipes-bsp/\n\u2502   \u251c\u2500\u2500 recipes-connectivity/\n\u2502   \u251c\u2500\u2500 recipes-core/\n\u2502   \u2502   \u251c\u2500\u2500 image/calculinux-image.bb\n\u2502   \u2502   \u2514\u2500\u2500 bundles/calculinux-bundle.bb\n\u2502   \u251c\u2500\u2500 recipes-extended/\n\u2502   \u2514\u2500\u2500 recipes-support/\n\u251c\u2500\u2500 meta-picocalc-bsp-rockchip/  # Hardware BSP layer\n\u2502   \u251c\u2500\u2500 conf/machine/\n\u2502   \u2502   \u2514\u2500\u2500 luckfox-lyra.conf\n\u2502   \u251c\u2500\u2500 recipes-bsp/\n\u2502   \u2502   \u2514\u2500\u2500 u-boot/\n\u2502   \u2514\u2500\u2500 recipes-kernel/\n\u2502       \u2514\u2500\u2500 linux/linux-rockchip_6.1.bbappend\n\u251c\u2500\u2500 meta-calculinux-apps/        # Applications layer\n\u2502   \u251c\u2500\u2500 recipes-connectivity/\n\u2502   \u2502   \u2514\u2500\u2500 zerotier-one/\n\u2502   \u2514\u2500\u2500 recipes-core/\n\u2502       \u2514\u2500\u2500 packagegroups/\n\u251c\u2500\u2500 kas-luckfox-lyra-bundle.yaml # KAS build configuration\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"developer/overview/#external-dependencies","title":"External Dependencies","text":"<p>Calculinux uses external repositories for kernel and bootloader sources:</p> <ul> <li>Kernel: <code>github.com/0xd61/luckfox-linux-6.1-rk3506.git</code> (via linux-rockchip recipe)</li> <li>Bootloader: Provided by meta-rockchip layer</li> <li>Documentation: This repository (github.com/Calculinux/docs)</li> </ul>"},{"location":"developer/overview/#development-workflow","title":"Development Workflow","text":""},{"location":"developer/overview/#typical-development-process","title":"Typical Development Process","text":"<ol> <li>Set up environment - Install dependencies, clone repos</li> <li>Configure build - Select machine, distro, image</li> <li>Build image - Run bitbake to compile everything</li> <li>Test on device - Flash to SD card, boot, verify</li> <li>Iterate - Make changes, rebuild, test again</li> <li>Submit changes - Create pull request</li> </ol>"},{"location":"developer/overview/#build-types","title":"Build Types","text":"<p>Full Build (Clean) - First build or major changes - Builds everything from scratch - Takes 2-8 hours depending on hardware - Uses significant disk space</p> <p>Incremental Build - Rebuilds only changed components - Much faster (minutes to hour) - Used for development iterations</p> <p>Package Build - Builds specific packages - Quick testing of changes - Useful for recipe development</p>"},{"location":"developer/overview/#getting-started","title":"Getting Started","text":""},{"location":"developer/overview/#quick-start-for-developers","title":"Quick Start for Developers","text":"<p>If you're ready to start developing:</p> <ol> <li>Yocto Setup - Install dependencies and configure environment</li> <li>Building Calculinux - Compile your first image</li> <li>Customization - Tailor Calculinux to your needs</li> <li>Adding Packages - Include new software</li> </ol>"},{"location":"developer/overview/#learning-path","title":"Learning Path","text":"<p>Beginner (New to Yocto): 1. Read Yocto Project documentation 2. Follow our Yocto Setup guide 3. Build a stock image 4. Make small customizations</p> <p>Intermediate (Some Yocto experience): 1. Clone meta-calculinux 2. Customize image configurations 3. Add new packages/recipes 4. Modify existing recipes</p> <p>Advanced (Experienced with Yocto): 1. Kernel development 2. Driver development 3. BSP modifications 4. Architecture contributions</p>"},{"location":"developer/overview/#development-tools","title":"Development Tools","text":""},{"location":"developer/overview/#required-tools","title":"Required Tools","text":"<p>Installed via package manager:</p> <pre><code># Ubuntu/Debian\nsudo apt install gawk wget git diffstat unzip texinfo \\\n    gcc build-essential chrpath socat cpio python3 \\\n    python3-pip python3-pexpect xz-utils debianutils \\\n    iputils-ping python3-git python3-jinja2 libegl1-mesa \\\n    libsdl1.2-dev pylint3 xterm python3-subunit mesa-common-dev \\\n    zstd liblz4-tool\n</code></pre>"},{"location":"developer/overview/#helpful-tools","title":"Helpful Tools","text":"<p>Development aids:</p> <ul> <li>devtool - Yocto development tool for recipes</li> <li>bitbake - Build engine</li> <li>runqemu - QEMU emulation (limited use for ARM)</li> <li>oe-pkgdata-util - Package data queries</li> <li>bitbake-layers - Layer management</li> </ul>"},{"location":"developer/overview/#editor-setup","title":"Editor Setup","text":"<p>Recommended editors with Yocto support:</p> <ul> <li>VS Code - With Yocto/BitBake extensions</li> <li>Vim/Neovim - With syntax highlighting</li> <li>Emacs - With bitbake-mode</li> </ul>"},{"location":"developer/overview/#build-system-overview","title":"Build System Overview","text":""},{"location":"developer/overview/#yoctoopenembedded","title":"Yocto/OpenEmbedded","text":"<p>Calculinux uses Yocto for several reasons:</p> <p>Advantages: - \u2705 Reproducible builds - \u2705 Extensive package ecosystem - \u2705 Professional tooling - \u2705 Active community - \u2705 Long-term support - \u2705 Customization flexibility</p> <p>Challenges: - \u26a0\ufe0f Steep learning curve - \u26a0\ufe0f Long initial build times - \u26a0\ufe0f Large disk space requirements - \u26a0\ufe0f Complex dependency management</p>"},{"location":"developer/overview/#bitbake","title":"BitBake","text":"<p>BitBake is the build engine:</p> <ul> <li>Task execution</li> <li>Dependency resolution</li> <li>Parallel builds</li> <li>Caching/reuse</li> </ul>"},{"location":"developer/overview/#recipes","title":"Recipes","text":"<p>Recipes define how to build packages:</p> <pre><code># Example recipe structure\nSUMMARY = \"Example package\"\nLICENSE = \"MIT\"\nSRC_URI = \"https://example.com/package.tar.gz\"\n\ndo_compile() {\n    # Compilation steps\n}\n\ndo_install() {\n    # Installation steps\n}\n</code></pre>"},{"location":"developer/overview/#common-development-tasks","title":"Common Development Tasks","text":""},{"location":"developer/overview/#adding-a-package","title":"Adding a Package","text":"<pre><code># Create new recipe\ndevtool add &lt;package-name&gt; &lt;source-url&gt;\n\n# Test build\ndevtool build &lt;package-name&gt;\n\n# Create recipe\ndevtool finish &lt;package-name&gt; meta-calculinux\n</code></pre>"},{"location":"developer/overview/#modifying-kernel","title":"Modifying Kernel","text":"<pre><code># Extract kernel source\nbitbake linux-rockchip -c unpack\n\n# Make changes\ncd tmp/work/.../linux-rockchip/.../git\n\n# Rebuild\nbitbake linux-rockchip -c compile -f\n</code></pre>"},{"location":"developer/overview/#creating-custom-image","title":"Creating Custom Image","text":"<pre><code># recipes-core/images/calculinux-custom.bb\nrequire calculinux-image.bb\n\nIMAGE_INSTALL += \"mypackage another-package\"\n</code></pre>"},{"location":"developer/overview/#testing-validation","title":"Testing &amp; Validation","text":""},{"location":"developer/overview/#build-testing","title":"Build Testing","text":"<pre><code># Build main image\nbitbake calculinux-image\n\n# Build update bundle\nbitbake calculinux-bundle\n\n# Verify package contents\noe-pkgdata-util list-pkgs\n</code></pre>"},{"location":"developer/overview/#runtime-testing","title":"Runtime Testing","text":"<ol> <li>Flash image to SD card</li> <li>Boot on PicoCalc</li> <li>Verify functionality</li> <li>Check logs: <code>journalctl -b</code></li> <li>Test applications</li> </ol>"},{"location":"developer/overview/#automated-testing","title":"Automated Testing","text":"<p>Coming soon: CI/CD pipeline for automated builds and tests.</p>"},{"location":"developer/overview/#performance-optimization","title":"Performance Optimization","text":""},{"location":"developer/overview/#build-speed","title":"Build Speed","text":"<p>Parallel Builds: <pre><code># local.conf\nBB_NUMBER_THREADS = \"8\"\nPARALLEL_MAKE = \"-j 8\"\n</code></pre></p> <p>Shared State Cache: <pre><code>SSTATE_DIR = \"/path/to/shared/sstate-cache\"\n</code></pre></p> <p>Build History: <pre><code>INHERIT += \"buildhistory\"\nBUILDHISTORY_COMMIT = \"1\"\n</code></pre></p>"},{"location":"developer/overview/#image-size","title":"Image Size","text":"<p>Optimize for small SD cards:</p> <pre><code># Remove documentation\nIMAGE_FEATURES_remove = \"doc-pkgs\"\n\n# Remove development files\nIMAGE_FEATURES_remove = \"dev-pkgs\"\n\n# Minimize locales\nIMAGE_LINGUAS = \"en-us\"\n</code></pre>"},{"location":"developer/overview/#debugging","title":"Debugging","text":""},{"location":"developer/overview/#build-failures","title":"Build Failures","text":"<pre><code># Verbose output\nbitbake -v calculinux-image\n\n# Debug specific task\nbitbake -c devshell &lt;package&gt;\n\n# Clean and rebuild\nbitbake -c cleansstate &lt;package&gt;\nbitbake &lt;package&gt;\n</code></pre>"},{"location":"developer/overview/#runtime-debugging","title":"Runtime Debugging","text":"<pre><code># Serial console\nscreen /dev/ttyUSB0 115200\n\n# SSH access\nssh root@&lt;ip-address&gt;\n\n# System logs\njournalctl -f\n</code></pre>"},{"location":"developer/overview/#contributing","title":"Contributing","text":"<p>We welcome contributions! See Contributing Guide for:</p> <ul> <li>Code style guidelines</li> <li>Submission process</li> <li>Review process</li> <li>Community standards</li> </ul>"},{"location":"developer/overview/#resources","title":"Resources","text":""},{"location":"developer/overview/#official-documentation","title":"Official Documentation","text":"<ul> <li>Yocto Project: https://www.yoctoproject.org/docs/</li> <li>OpenEmbedded: https://www.openembedded.org/</li> <li>BitBake Manual: https://docs.yoctoproject.org/bitbake/</li> </ul>"},{"location":"developer/overview/#calculinux-specific","title":"Calculinux Specific","text":"<ul> <li>Repository: https://github.com/Calculinux/meta-calculinux</li> <li>Issues: GitHub Issues</li> <li>Discussions: Forum Thread</li> </ul>"},{"location":"developer/overview/#learning-resources","title":"Learning Resources","text":"<ul> <li>Yocto Project Quick Start</li> <li>Yocto Project Mega-Manual</li> <li>OpenEmbedded User Manual</li> <li>Linux From Scratch (background)</li> </ul>"},{"location":"developer/overview/#next-steps","title":"Next Steps","text":"<p>Choose your path:</p> <ul> <li> <p> Set Up Environment</p> <p>Install tools and configure Yocto</p> <p> Yocto Setup</p> </li> <li> <p> Build Calculinux</p> <p>Compile your first image</p> <p> Building Guide</p> </li> <li> <p> Customize</p> <p>Make Calculinux your own</p> <p> Customization</p> </li> <li> <p> Contribute</p> <p>Join the development effort</p> <p> Contributing</p> </li> </ul>"},{"location":"developer/releases/","title":"Release Process","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for release procedures.</p>"},{"location":"developer/releases/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Building Calculinux - How to build images</li> <li>Contributing - How to contribute</li> </ul>"},{"location":"developer/releases/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Release schedule</li> <li>Version numbering</li> <li>Testing procedures</li> <li>Release checklist</li> <li>Image distribution</li> <li>Update bundles</li> <li>Release notes</li> </ul> <p>Content planned for future release</p>"},{"location":"developer/yocto-setup/","title":"Yocto Setup","text":"<p>Setting up the Yocto build environment for Calculinux development.</p>"},{"location":"developer/yocto-setup/#prerequisites","title":"Prerequisites","text":"<p>System requirements and dependencies.</p>"},{"location":"developer/yocto-setup/#environment-setup","title":"Environment Setup","text":"<p>Step-by-step Yocto environment configuration.</p>"},{"location":"developer/yocto-setup/#initial-configuration","title":"Initial Configuration","text":"<p>First-time setup instructions.</p>"},{"location":"developer/yocto-setup/#troubleshooting-setup-issues","title":"Troubleshooting Setup Issues","text":"<p>Common setup problems and solutions.</p> <p>This page is under development and will be populated with detailed Yocto setup instructions.</p>"},{"location":"getting-started/first-boot/","title":"First Boot","text":"<p>Guide for the first boot and initial configuration of Calculinux.</p>"},{"location":"getting-started/first-boot/#booting-for-the-first-time","title":"Booting for the First Time","text":"<p>After flashing your SD card and installing hardware:</p> <ol> <li>Insert SD card into Luckfox Lyra</li> <li>Connect USB-C power (5V/2A minimum)</li> <li>Wait for boot (30-60 seconds first time)</li> </ol>"},{"location":"getting-started/first-boot/#what-to-expect","title":"What to Expect","text":"<p>Boot Process: - Power LED lights up - Boot messages appear on display - System initialization - Login prompt appears</p> <p>First Boot Timing: - First boot: 30-60 seconds - Subsequent boots: 15-30 seconds</p>"},{"location":"getting-started/first-boot/#initial-login","title":"Initial Login","text":""},{"location":"getting-started/first-boot/#default-credentials","title":"Default Credentials","text":"<pre><code>Username: root\nPassword: root\n</code></pre> <p>Change Password Immediately</p> <p>The first thing you should do after logging in is change the root password: <pre><code>passwd\n</code></pre></p>"},{"location":"getting-started/first-boot/#initial-configuration","title":"Initial Configuration","text":""},{"location":"getting-started/first-boot/#1-change-root-password","title":"1. Change Root Password","text":"<pre><code>passwd\n# Enter new password twice\n</code></pre>"},{"location":"getting-started/first-boot/#2-set-system-time","title":"2. Set System Time","text":"<pre><code># Set current date/time\ndate -s \"2025-10-06 14:30:00\"\n\n# Or use NTP if network connected\nntpd -q -p pool.ntp.org\n</code></pre>"},{"location":"getting-started/first-boot/#3-check-system-status","title":"3. Check System Status","text":"<pre><code># Check system info\nuname -a\n\n# Check memory\nfree -h\n\n# Check disk space\ndf -h\n\n# Check running services\nsystemctl status\n</code></pre>"},{"location":"getting-started/first-boot/#4-filesystem-expansion-automatic","title":"4. Filesystem Expansion (Automatic)","text":"<p>Automatic Expansion</p> <p>The overlayfs partition is automatically expanded during the pre-init process on first boot. The system uses <code>growpart</code> to expand the overlay partition to fill available disk space, leaving 10% free. No manual intervention is required.</p>"},{"location":"getting-started/first-boot/#5-update-package-database","title":"5. Update Package Database","text":"<pre><code>opkg update\n</code></pre>"},{"location":"getting-started/first-boot/#basic-system-check","title":"Basic System Check","text":""},{"location":"getting-started/first-boot/#verify-hardware","title":"Verify Hardware","text":"<pre><code># Check display\nls -l /dev/fb0\ncat /dev/urandom &gt; /dev/fb0  # Should show random colors\n\n# Check keyboard\ncat /proc/bus/input/devices\n\n# Check CPU\ncat /proc/cpuinfo\n\n# Check USB WiFi adapter (if connected)\nlsusb\nip link show\n</code></pre>"},{"location":"getting-started/first-boot/#supported-peripherals","title":"Supported Peripherals","text":"<p>Hardware Expansion</p> <p>The PicoCalc and Luckfox Lyra do not include WiFi or many peripherals by default. Hardware can be added via USB, I2C, SPI, and GPIO headers.</p> <p>Currently Tested: - Display (built-in LCD drivers) - Keyboard (built-in keyboard drivers) - USB WiFi adapters (see WiFi chipsets above)</p> <p>Planned/Future Support: - I2C RTC modules (e.g., Adafruit DS3231) - LoRa radio modules (e.g., Waveshare Core1262-868M for Meshtastic) - Additional I2C/SPI peripherals</p> <p>Peripheral Testing</p> <p>Most peripheral support beyond WiFi, display, and keyboard has not been thoroughly tested yet. Community contributions for additional hardware support are welcome!</p>"},{"location":"getting-started/first-boot/#check-logs","title":"Check Logs","text":"<pre><code># Boot messages\ndmesg | less\n\n# System journal\njournalctl -b\n</code></pre>"},{"location":"getting-started/first-boot/#network-configuration","title":"Network Configuration","text":""},{"location":"getting-started/first-boot/#wifi-setup-usb-adapter-required","title":"WiFi Setup (USB Adapter Required)","text":"<p>WiFi Hardware Required</p> <p>Neither the PicoCalc nor Luckfox Lyra include built-in WiFi. You need a USB WiFi adapter operating at 3.3V connected to the Lyra's USB header.</p> <p>For a complete list of supported WiFi chipsets, see Hardware Specifications - WiFi Chipsets.</p>"},{"location":"getting-started/first-boot/#connecting-to-wifi-with-iwctl","title":"Connecting to WiFi with iwctl","text":"<p>Calculinux uses <code>iwd</code> (iNet Wireless Daemon) for WiFi management. Use <code>iwctl</code> to configure wireless connections:</p> <pre><code># Start iwctl interactive mode\niwctl\n\n# Inside iwctl:\n[iwd]# device list                          # List wireless devices\n[iwd]# station wlan0 scan                   # Scan for networks\n[iwd]# station wlan0 get-networks           # Show available networks\n[iwd]# station wlan0 connect \"SSID\"         # Connect to network\n# Enter passphrase when prompted\n[iwd]# exit\n\n# Or use iwctl non-interactively:\niwctl station wlan0 scan\niwctl station wlan0 get-networks\niwctl station wlan0 connect \"YourSSID\"\n</code></pre> <p>Verify Connection:</p> <pre><code># Check connection status\niwctl station wlan0 show\n\n# Check IP address\nip addr show wlan0\n\n# Test connectivity\nping -c 3 8.8.8.8\n</code></pre> <p>Disconnect:</p> <pre><code>iwctl station wlan0 disconnect\n</code></pre>"},{"location":"getting-started/first-boot/#next-steps","title":"Next Steps","text":"<p>After initial setup:</p> <ul> <li>Follow Quick Start Guide</li> <li>Learn Basic Usage</li> <li>Install Applications</li> </ul>"},{"location":"getting-started/first-boot/#troubleshooting-first-boot","title":"Troubleshooting First Boot","text":""},{"location":"getting-started/first-boot/#no-display","title":"No Display","text":"<ul> <li>Wait 2-3 minutes</li> <li>Check power supply</li> <li>Verify SD card inserted correctly</li> <li>See Boot Problems</li> </ul>"},{"location":"getting-started/first-boot/#boot-hangs","title":"Boot Hangs","text":"<ul> <li>SPI NAND not erased (most common)</li> <li>Corrupt SD card</li> <li>Insufficient power</li> <li>See Troubleshooting</li> </ul>"},{"location":"getting-started/first-boot/#cannot-login","title":"Cannot Login","text":"<ul> <li>Verify correct username: <code>root</code></li> <li>Verify correct password: <code>calculinux</code></li> <li>Try different keyboard</li> <li>Check keyboard driver in logs</li> </ul>"},{"location":"getting-started/first-boot/#getting-help","title":"Getting Help","text":"<ul> <li>Check Troubleshooting</li> <li>Visit Community Forum</li> <li>Open GitHub Issue</li> </ul>"},{"location":"getting-started/hardware-requirements/","title":"Hardware Requirements","text":"<p>This page outlines what hardware you need to purchase and prepare to run Calculinux.</p> <p>Technical Specifications</p> <p>For detailed technical specifications of all hardware components, see the Hardware Specifications page.</p>"},{"location":"getting-started/hardware-requirements/#required-hardware","title":"Required Hardware","text":""},{"location":"getting-started/hardware-requirements/#essential-components","title":"Essential Components","text":"Component Requirement Where to Get PicoCalc Device Base model ClockworkPi Store Luckfox Lyra SBC 128MB RAM, RK3506G2-based Luckfox Store MicroSD Card 8GB minimum (16GB+ recommended) Any retailer - Class 10 or better USB-C Cable Data-capable Any retailer <p>Luckfox Lyra Configuration</p> <ul> <li>RAM: Get the 128MB model - this is the only tested and supported configuration</li> <li>Storage: Models with or without SPI NAND both work (NAND must be erased first)</li> <li>Other variants: 64MB and 256MB RAM models have different footprints and pinouts and would require custom adapter boards</li> </ul>"},{"location":"getting-started/hardware-requirements/#recommended-configurations","title":"Recommended Configurations","text":""},{"location":"getting-started/hardware-requirements/#budget-configuration","title":"Budget Configuration","text":"<ul> <li>Luckfox Lyra 128MB (basic model, no SPI NAND)</li> <li>16GB Class 10 SD card</li> <li>Best for: Console use, scripting, learning Linux</li> </ul>"},{"location":"getting-started/hardware-requirements/#standard-configuration","title":"Standard Configuration","text":"<ul> <li>Luckfox Lyra 128MB</li> <li>32GB UHS-I SD card</li> <li>Best for: General use with more storage for applications</li> </ul>"},{"location":"getting-started/hardware-requirements/#advanced-configuration","title":"Advanced Configuration","text":"<ul> <li>Luckfox Lyra 128MB</li> <li>64GB UHS-I SD card</li> <li>Powered USB hub (for 5V peripherals)</li> <li>Second USB-C cable (for serial console)</li> <li>Best for: Development, experimentation, debugging</li> </ul> <p>Serial Console for Development</p> <p>A second USB-C cable connected to the PicoCalc's USB-C port (not the Lyra's port) provides serial console access at 1500000 baud. This is invaluable for:</p> <ul> <li>Watching boot messages and kernel output</li> <li>Debugging firmware and kernel driver modifications</li> <li>Troubleshooting hardware issues</li> <li>Development work requiring low-level system access</li> </ul> <p>See Hardware Specifications for details on the two different USB-C ports.</p>"},{"location":"getting-started/hardware-requirements/#whats-included-vs-what-to-buy","title":"What's Included vs What to Buy","text":""},{"location":"getting-started/hardware-requirements/#comes-with-picocalc","title":"Comes with PicoCalc","text":"<ul> <li>Display and keyboard</li> <li>Internal battery</li> <li>PicoCalc USB-C port (for charging and serial console)</li> <li>PicoCalc SD card slot (for expansion storage)</li> <li>Original RP2040 board (you'll replace this)</li> </ul>"},{"location":"getting-started/hardware-requirements/#you-need-to-purchase","title":"You Need to Purchase","text":"<ul> <li>Luckfox Lyra SBC (replaces RP2040)</li> <li>MicroSD card for Lyra (system boot disk)</li> <li>USB-C cable</li> </ul>"},{"location":"getting-started/hardware-requirements/#optional-purchases","title":"Optional Purchases","text":"<ul> <li>WiFi adapter (3.3V or via powered hub)</li> <li>Additional SD card for PicoCalc slot</li> <li>Powered USB hub (for 5V devices)</li> <li>Second USB-C cable (for serial console)</li> </ul>"},{"location":"getting-started/hardware-requirements/#before-you-order","title":"Before You Order","text":""},{"location":"getting-started/hardware-requirements/#important-considerations","title":"Important Considerations","text":"<p>Graphical Desktop Experimentation</p> <p>Calculinux is console-only by default. While you can experiment with lightweight graphical environments, the 128MB RAM is a significant limiting factor for desktop use. Set expectations accordingly!</p> <p>SPI NAND Models</p> <p>If you purchase a Luckfox Lyra with SPI NAND storage, you must erase the NAND flash before Calculinux will boot from SD card. See the SPI NAND Erase Guide for instructions.</p> <p>PicoCalc Availability</p> <p>Check ClockworkPi's website for current PicoCalc availability and shipping information.</p>"},{"location":"getting-started/hardware-requirements/#next-steps","title":"Next Steps","text":"<p>Once you have your hardware:</p> <ol> <li>Check compatibility: Review the Hardware Compatibility Matrix</li> <li>Learn about the hardware: See Hardware Specifications for technical details</li> <li>Prepare for installation: Continue to the Installation Guide</li> </ol>"},{"location":"getting-started/hardware-requirements/#additional-resources","title":"Additional Resources","text":"<ul> <li>PicoCalc Overview - Learn about the PicoCalc device</li> <li>Luckfox Lyra Details - SDK, purchasing, and software info</li> <li>Hardware Specifications - Complete technical specs</li> <li>Hardware Compatibility - Detailed compatibility information</li> </ul>"},{"location":"getting-started/hardware-requirements/#optional-hardware","title":"Optional Hardware","text":""},{"location":"getting-started/hardware-requirements/#network-connectivity","title":"Network Connectivity","text":"<p>No Built-in WiFi</p> <p>Neither the PicoCalc nor Luckfox Lyra include built-in WiFi. You will need a USB WiFi adapter.</p> <p>Critical: 3.3V Requirement</p> <p>The Lyra's USB port provides only 3.3V power. Standard 5V USB adapters will NOT work and may damage the board.</p> <p>Options: - Use a 3.3V-compatible USB WiFi adapter - Use an externally powered USB hub for 5V devices</p> <p>Tested: USB WiFi adapters with RTL8192CU, R8712U, R8188EU chipsets at 3.3V</p> <p>Untested but supported: Additional chipsets listed in Hardware Specifications - WiFi</p>"},{"location":"getting-started/hardware-requirements/#storage-expansion","title":"Storage Expansion","text":"Option Status Notes PicoCalc SD Card Slot \u2705 Tested External SD card via PicoCalc's built-in slot (SPI, slower but great for storage) USB Storage \u2753 Untested Via Lyra USB-OTG port (requires 3.3V or powered hub)"},{"location":"getting-started/hardware-requirements/#other-peripherals","title":"Other Peripherals","text":"<p>The following have NOT been tested with Calculinux and likely require an externally powered USB hub:</p> <ul> <li>USB keyboard</li> <li>USB ethernet adapter  </li> <li>USB storage devices</li> <li>Other USB peripherals</li> </ul> <p>Luckfox Lyra Plus (Ethernet Model)</p> <p>The Luckfox Lyra Plus includes built-in Ethernet, but it has not been tested with Calculinux and would require a custom backplate to access the port within the PicoCalc enclosure.</p>"},{"location":"getting-started/hardware-requirements/#compatibility","title":"Compatibility","text":"<p>See Compatibility Matrix for detailed hardware compatibility information.</p>"},{"location":"getting-started/hardware-requirements/#next-steps_1","title":"Next Steps","text":"<ul> <li>Review Luckfox Lyra details</li> <li>Check Installation Guide</li> <li>Learn about Hardware Modifications</li> </ul>"},{"location":"getting-started/installation/","title":"Installation Guide","text":"<p>This guide covers how to install Calculinux on your PicoCalc with Luckfox Lyra SBC.</p>"},{"location":"getting-started/installation/#overview","title":"Overview","text":"<p>The installation process involves:</p> <ol> <li>Obtaining the Calculinux image</li> <li>Flashing it to a microSD card</li> <li>Installing the Luckfox Lyra in your PicoCalc (if not already done)</li> <li>Booting the system</li> </ol>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Before starting, ensure you have:</p> <ul> <li>\u2705 Luckfox Lyra SBC (installed in PicoCalc)</li> <li>\u2705 MicroSD card (8GB minimum, 16GB+ recommended)</li> <li>\u2705 SD card reader</li> <li>\u2705 Computer (Linux, macOS, or Windows)</li> <li>\u2705 Stable internet connection</li> <li>\u2705 1-2 GB free disk space for image download</li> </ul>"},{"location":"getting-started/installation/#step-1-download-calculinux-image","title":"Step 1: Download Calculinux Image","text":""},{"location":"getting-started/installation/#official-releases","title":"Official Releases","text":"<p>Download the latest Calculinux image from:</p> <p>GitHub Releases: https://github.com/Calculinux/meta-calculinux/releases</p> <p>Download the Calculinux image file:</p> Image Name Description <code>calculinux-image-luckfox-lyra.rootfs.wic.gz</code> Complete Calculinux system image <p>Additional files you may find:</p> File Name Description <code>calculinux-bundle-luckfox-lyra.raucb</code> RAUC update bundle (for updating existing installations) <code>*.manifest</code> Build manifest with package list <p>Single Image Design</p> <p>Calculinux provides a single console-based image suitable for all RAM configurations (64MB, 128MB, 256MB). Additional software can be installed via the package manager as needed.</p>"},{"location":"getting-started/installation/#verify-download","title":"Verify Download","text":"<p>After downloading, verify the image integrity:</p> <pre><code># On Linux/macOS\nsha256sum calculinux-*.wic.gz\n\n# On Windows (PowerShell)\nGet-FileHash calculinux-*.wic.gz -Algorithm SHA256\n</code></pre> <p>Compare with the SHA256 hash on the release page.</p>"},{"location":"getting-started/installation/#extract-image","title":"Extract Image","text":"<p>If the image is compressed (<code>.xz</code>, <code>.gz</code>, <code>.zip</code>):</p> <pre><code># Linux/macOS with xz\nunxz calculinux-*.wic.gz\n\n# Or using 7-Zip on any platform\n7z x calculinux-*.wic.gz\n</code></pre>"},{"location":"getting-started/installation/#step-2-flash-sd-card","title":"Step 2: Flash SD Card","text":"<p>Data Loss Warning</p> <p>Flashing will erase all data on the SD card. Make sure you've selected the correct device!</p>"},{"location":"getting-started/installation/#option-a-using-balena-etcher-recommended-for-beginners","title":"Option A: Using Balena Etcher (Recommended for Beginners)","text":"<ol> <li>Download Balena Etcher: https://www.balena.io/etcher/</li> <li>Install and launch Etcher</li> <li>Insert SD card into card reader</li> <li>In Etcher:</li> <li>Click \"Flash from file\" and select Calculinux image</li> <li>Click \"Select target\" and choose your SD card</li> <li>Click \"Flash!\"</li> <li>Wait for completion and verification</li> </ol>"},{"location":"getting-started/installation/#option-b-using-dd-linuxmacos","title":"Option B: Using dd (Linux/macOS)","text":"<p>Dangerous Command</p> <p>Double-check the device name! Using the wrong device will destroy your data.</p> <pre><code># 1. Insert SD card and identify device\nlsblk\n# Look for your SD card (usually /dev/sdX or /dev/mmcblkN)\n\n# 2. Unmount the device if mounted\nsudo umount /dev/sdX*\n\n# 3. Flash the image\nsudo dd if=calculinux-*.wic of=/dev/sdX bs=4M status=progress conv=fsync\n\n# 4. Sync to ensure all data is written\nsync\n</code></pre>"},{"location":"getting-started/installation/#option-c-using-rufus-windows","title":"Option C: Using Rufus (Windows)","text":"<ol> <li>Download Rufus: https://rufus.ie/</li> <li>Launch Rufus (may require admin rights)</li> <li>Insert SD card</li> <li>In Rufus:</li> <li>Device: Select your SD card</li> <li>Boot selection: Click \"SELECT\" and choose image</li> <li>Partition scheme: MBR</li> <li>File system: FAT32 (will be overwritten)</li> <li>Click \"START\" and confirm</li> </ol>"},{"location":"getting-started/installation/#option-d-using-win32diskimager-windows","title":"Option D: Using Win32DiskImager (Windows)","text":"<ol> <li>Download: Win32 Disk Imager</li> <li>Install and launch as administrator</li> <li>Insert SD card</li> <li>In Win32DiskImager:</li> <li>Select image file</li> <li>Choose correct device</li> <li>Click \"Write\"</li> <li>Wait for completion</li> </ol>"},{"location":"getting-started/installation/#verify-flashing","title":"Verify Flashing","text":"<p>After flashing:</p> <pre><code># Linux/macOS - verify partition table\nsudo fdisk -l /dev/sdX\n\n# Should show multiple partitions:\n# - Boot partition (FAT32)\n# - Root filesystem (ext4)\n</code></pre>"},{"location":"getting-started/installation/#hardware-installation","title":"Step 3: Hardware Installation","text":"<p>If you haven't already installed the Luckfox Lyra in your PicoCalc, follow the Hardware Modifications guide.</p> <p>If your Luckfox Lyra has SPI NAND, you must erase it:</p> <pre><code># See Hardware Modifications guide for detailed instructions\n# Or Boot Problems troubleshooting page\n</code></pre> <p>Quick checklist:</p> <ul> <li>[ ] Luckfox Lyra installed in PicoCalc</li> <li>[ ] Connector properly seated</li> <li>[ ] SPI NAND erased (if present)</li> <li>[ ] Case reassembled</li> <li>[ ] SD card inserted in Luckfox Lyra</li> </ul>"},{"location":"getting-started/installation/#step-4-first-boot","title":"Step 4: First Boot","text":"<ol> <li>Insert the flashed SD card into the Luckfox Lyra</li> <li>Connect USB-C power (5V/2A minimum)</li> <li>Power on the device</li> </ol>"},{"location":"getting-started/installation/#what-to-expect","title":"What to Expect","text":"<p>Initial boot timing: - First boot: 30-60 seconds - Subsequent boots: 15-30 seconds</p> <p>Visual indicators: - Power LED should light up - Display may show boot messages - Initial splash screen - Login prompt (console-only, no GUI)</p>"},{"location":"getting-started/installation/#boot-messages","title":"Boot Messages","text":"<p>You should see:</p> <pre><code>[    0.000000] Booting Linux on physical CPU 0x0\n[    0.000000] Linux version 5.10.x-calculinux\n...\n[    5.234567] PicoCalc display initialized\n[    5.345678] PicoCalc keyboard initialized\n...\n\nCalculinux GNU/Linux 1.0 picocalc ttyS0\n\npicocalc login: _\n</code></pre> <p>Success!</p> <p>If you see a login prompt, congratulations! Calculinux is running.</p>"},{"location":"getting-started/installation/#troubleshooting-boot-issues","title":"Troubleshooting Boot Issues","text":"<p>If the system doesn't boot:</p> <p>No display activity: - Check power supply (try different cable/adapter) - Verify SD card is inserted correctly - See Boot Problems</p> <p>Boots but hangs: - Wait 2-3 minutes (first boot may take longer) - Check SD card integrity - Try reflashing the image</p> <p>Display shows errors: - Note the error messages - Check Troubleshooting - Search forum for similar issues</p>"},{"location":"getting-started/installation/#step-5-initial-login","title":"Step 5: Initial Login","text":"<p>After successful boot, you'll see a login prompt.</p> <p>Login Credentials</p> <p>For default usernames and passwords, see the First Boot guide.</p> <p>Change Passwords</p> <p>Immediately change all default passwords after first login. See First Boot - Initial Configuration.</p>"},{"location":"getting-started/installation/#post-installation","title":"Post-Installation","text":"<p>After successful login, follow the First Boot guide for:</p> <ol> <li>Changing default passwords</li> <li>Setting system time</li> <li>Checking system status</li> <li>Configuring network (if needed)</li> <li>Updating package database</li> </ol>"},{"location":"getting-started/installation/#filesystem-expansion-automatic","title":"Filesystem Expansion (Automatic)","text":"<p>No Action Required</p> <p>The overlayfs partition is automatically expanded during first boot to use all available space on your SD card (leaving 10% free). No manual intervention is needed.</p>"},{"location":"getting-started/installation/#multiple-sd-cards","title":"Multiple SD Cards","text":"<p>You can create multiple SD cards for different purposes:</p> <ul> <li>Development: Full tools, larger packages</li> <li>Production: Minimal, stable release</li> <li>Testing: Experimental features</li> <li>Backup: Stable known-good configuration</li> </ul> <p>Just flash different images or clone a working card:</p> <pre><code># Clone a working SD card\nsudo dd if=/dev/sdX of=backup.img bs=4M status=progress\n\n# Later, restore it\nsudo dd if=backup.img of=/dev/sdX bs=4M status=progress\n</code></pre>"},{"location":"getting-started/installation/#pre-installed-software","title":"Pre-Installed Software","text":"<p>Calculinux comes with a console-based environment including:</p>"},{"location":"getting-started/installation/#system-utilities","title":"System Utilities","text":"<ul> <li>Shell: bash, busybox</li> <li>Editors: vi, nano (via opkg)</li> <li>Development: gcc, g++, make, autoconf, git, gdb</li> <li>Package Management: opkg with online repositories</li> </ul>"},{"location":"getting-started/installation/#network-tools","title":"Network Tools","text":"<ul> <li>WiFi: iwd (iwctl command)</li> <li>Utilities: curl, wget, links (text browser), openssh</li> <li>Debugging: iw, htop, systemd-analyze</li> </ul>"},{"location":"getting-started/installation/#system-management","title":"System Management","text":"<ul> <li>Update System: RAUC (A/B partition updates)</li> <li>Storage: e2fsprogs, mtd-utils, cloud-utils-growpart</li> <li>Hardware: i2c-tools, usbutils, android-tools</li> </ul>"},{"location":"getting-started/installation/#additional-features","title":"Additional Features","text":"<ul> <li>Filesystem: Overlayfs for read-only root with persistent overlay</li> <li>Console Font: Terminus font for better readability</li> <li>Keyboard: Full keyboard mapping support</li> </ul> <p>No GUI/Desktop</p> <p>Calculinux is currently console-only with no graphical desktop environment. All interaction is via text terminal. GUI support may be added in future releases.</p> <ul> <li>File manager</li> <li>Basic applications</li> </ul>"},{"location":"getting-started/installation/#customization","title":"Customization","text":"<p>After installation, you can customize your system:</p> <ul> <li>Install additional packages: See Package Management</li> <li>Set up development: See Developer Guide</li> <li>Add applications: See Applications</li> </ul>"},{"location":"getting-started/installation/#building-your-own-image","title":"Building Your Own Image","text":"<p>Instead of using pre-built images, you can build your own:</p> <ol> <li>Follow Yocto Setup</li> <li>Customize configuration</li> <li>Build image: Building Calculinux</li> <li>Flash your custom image</li> </ol>"},{"location":"getting-started/installation/#updating-calculinux","title":"Updating Calculinux","text":"<p>To update an existing installation:</p> <pre><code># Update package database\nopkg update\n\n# Upgrade all packages\nopkg upgrade\n\n# Or see Updates guide\n</code></pre> <p>See Updates for detailed information.</p>"},{"location":"getting-started/installation/#backup-strategies","title":"Backup Strategies","text":"<p>Protect your work:</p>"},{"location":"getting-started/installation/#full-sd-card-backup","title":"Full SD Card Backup","text":"<pre><code># Backup entire SD card\nsudo dd if=/dev/sdX of=calculinux-backup.img bs=4M status=progress\n\n# Compress to save space\ngzip calculinux-backup.wic\n</code></pre>"},{"location":"getting-started/installation/#filesystem-backup","title":"Filesystem Backup","text":"<pre><code># Backup home directory\ntar czf home-backup.tar.gz /home\n\n# Backup configuration\ntar czf etc-backup.tar.gz /etc\n</code></pre>"},{"location":"getting-started/installation/#common-installation-issues","title":"Common Installation Issues","text":""},{"location":"getting-started/installation/#sd-card-not-recognized","title":"SD Card Not Recognized","text":"<ul> <li>Try different card reader</li> <li>Test SD card on another device</li> <li>Format card first: <code>sudo mkfs.fat -F 32 /dev/sdX</code></li> </ul>"},{"location":"getting-started/installation/#image-wont-flash","title":"Image Won't Flash","text":"<ul> <li>Verify image integrity (checksum)</li> <li>Try different flashing tool</li> <li>Check SD card isn't write-protected</li> </ul>"},{"location":"getting-started/installation/#boot-loops","title":"Boot Loops","text":"<ul> <li>SPI NAND not erased (most common)</li> <li>Corrupted image</li> <li>Faulty SD card</li> <li>Insufficient power</li> </ul> <p>See Troubleshooting for solutions.</p>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<p>Now that Calculinux is installed:</p> <ul> <li>Continue to First Boot guide</li> <li>Learn Quick Start basics</li> <li>Explore User Guide</li> </ul>"},{"location":"getting-started/installation/#getting-help","title":"Getting Help","text":"<p>If you encounter problems:</p> <ol> <li>Check Troubleshooting</li> <li>Search Forum</li> <li>Ask in community chat</li> <li>Open GitHub issue</li> </ol> <p>Include in your help request: - Image variant and version - SD card brand/size - Luckfox Lyra version (RAM, NAND) - Exact error messages - What you've already tried</p>"},{"location":"getting-started/overview/","title":"Getting Started with Calculinux","text":"<p>Welcome to Calculinux! This guide will help you get started with your PicoCalc running Linux.</p>"},{"location":"getting-started/overview/#overview","title":"Overview","text":"<p>Calculinux is a Linux distribution built specifically for the PicoCalc handheld computer with Luckfox Lyra SBC. This getting started guide will walk you through everything you need to know to set up and use Calculinux.</p>"},{"location":"getting-started/overview/#what-youll-need","title":"What You'll Need","text":"<p>Before you begin, make sure you have:</p> <ul> <li>\u2705 PicoCalc device</li> <li>\u2705 Luckfox Lyra SBC (128MB RAM model)</li> <li>\u2705 MicroSD card (8GB minimum, 16GB+ recommended)</li> <li>\u2705 SD card reader for your computer</li> <li>\u2705 USB-C cable for power/connectivity</li> <li>\u2705 Computer (for flashing the SD card)</li> </ul> <p>Optional but helpful: - Second USB-C cable (for serial console monitoring at 1500000 baud) - USB WiFi adapter (3.3V compatible, see Hardware Requirements)</p> <p>Detailed Hardware Info</p> <p>For complete hardware specifications and purchasing guidance, see Hardware Requirements and Hardware Specifications.</p>"},{"location":"getting-started/overview/#quick-start-process","title":"Quick Start Process","text":"<p>Here's the high-level process to get Calculinux running:</p> <ol> <li>Check Hardware Requirements - Verify you have everything needed</li> <li>Erase SPI NAND (if equipped) - Required for Lyra models with onboard NAND</li> <li>Install Lyra in PicoCalc (if needed) - Physical installation</li> <li>Flash SD Card - Write Calculinux image to SD card</li> <li>First Boot - Power on and complete initial setup</li> <li>Quick Start Guide - Learn basic operations</li> </ol>"},{"location":"getting-started/overview/#time-requirements","title":"Time Requirements","text":"<ul> <li>Hardware Installation: 5-10 minutes</li> <li>Image Flashing: 5-15 minutes (depends on SD card)</li> <li>First Boot: 2-3 minutes</li> <li>Initial Configuration: 10-30 minutes</li> </ul>"},{"location":"getting-started/overview/#skill-level","title":"Skill Level","text":"<p>This guide is written for users with basic to intermediate technical knowledge:</p> <ul> <li>Basic: You can follow written instructions and use a computer</li> <li>Intermediate: Comfortable with command-line interfaces</li> <li>Advanced: Hardware modifications and development</li> </ul> <p>Don't worry!</p> <p>Even if you're new to Linux or embedded systems, the guide provides detailed step-by-step instructions. Take your time and ask for help in the community if needed.</p>"},{"location":"getting-started/overview/#support-channels","title":"Support Channels","text":"<p>If you need help:</p> <ul> <li>\ud83d\udcd6 Check this documentation first</li> <li>\ud83d\udcac ClockworkPi Forum - Active community</li> <li>\ud83d\udc1b GitHub Issues - Bug reports</li> <li>\ud83d\udce7 Community Discord/Matrix (links in Resources)</li> </ul>"},{"location":"getting-started/overview/#what-to-expect","title":"What to Expect","text":""},{"location":"getting-started/overview/#after-installation","title":"After Installation","text":"<p>Once Calculinux is running, you'll have:</p> <ul> <li>Full Linux operating system (console-based)</li> <li>Command-line terminal access via built-in display and keyboard</li> <li>Package manager (opkg) for installing software</li> <li>Development tools (gcc, g++, make, git, gdb, etc.)</li> <li>Network connectivity via WiFi or Ethernet (USB adapters required)</li> <li>Access to thousands of open-source command-line applications</li> </ul>"},{"location":"getting-started/overview/#limitations","title":"Limitations","text":"<p>Be aware of these limitations:</p> <ul> <li>Console Only: No graphical desktop environment (text-based interface)</li> <li>Small Display: 320\u00d7320 pixels (53\u00d740 text), optimized for terminal use</li> <li>RAM: 128MB means careful resource management</li> <li>Storage: SD card speed affects performance</li> <li>No Built-in Network: Requires 3.3V USB WiFi adapter or powered hub</li> <li>Battery Life: Running Linux uses more power than stock firmware</li> </ul> <p>More Details</p> <p>See Hardware Specifications for complete technical details about display, performance, and capabilities.</p>"},{"location":"getting-started/overview/#learning-path","title":"Learning Path","text":""},{"location":"getting-started/overview/#beginners","title":"Beginners","text":"<ol> <li>Start with Installation</li> <li>Follow First Boot guide</li> <li>Learn Quick Start Guide</li> <li>Explore Basic Usage</li> </ol>"},{"location":"getting-started/overview/#intermediate-users","title":"Intermediate Users","text":"<ol> <li>Review Hardware Requirements</li> <li>Perform Installation</li> <li>Configure Networking</li> <li>Install Applications</li> </ol>"},{"location":"getting-started/overview/#advanced-usersdevelopers","title":"Advanced Users/Developers","text":"<ol> <li>Check Installation for base system</li> <li>Review Developer Guide</li> <li>Set up Yocto Build System</li> <li>Start Contributing</li> </ol>"},{"location":"getting-started/overview/#documentation-structure","title":"Documentation Structure","text":"<p>This documentation is organized into sections:</p>"},{"location":"getting-started/overview/#getting-started-you-are-here","title":"Getting Started (You Are Here)","text":"<p>Everything needed to get Calculinux running</p>"},{"location":"getting-started/overview/#hardware","title":"Hardware","text":"<p>Physical device information, modifications, technical specs</p>"},{"location":"getting-started/overview/#user-guide","title":"User Guide","text":"<p>Day-to-day usage, applications, configuration</p>"},{"location":"getting-started/overview/#developer-guide","title":"Developer Guide","text":"<p>Building, customizing, contributing to Calculinux</p>"},{"location":"getting-started/overview/#troubleshooting","title":"Troubleshooting","text":"<p>Solutions to common problems and FAQ</p>"},{"location":"getting-started/overview/#resources","title":"Resources","text":"<p>External links, tools, community information</p>"},{"location":"getting-started/overview/#before-you-begin","title":"Before You Begin","text":""},{"location":"getting-started/overview/#important-warnings","title":"Important Warnings","text":"<p>Warranty</p> <p>Installing Luckfox Lyra requires opening your PicoCalc, possibly several times. You may want to secure your screen to the case with tape so it does not shift during assembly and break!</p> <p>Data Loss</p> <p>If you're replacing an existing PicoCalc Linux installation, back up any data first, or use a different SD card. The installation process will erase the SD card.</p> <p>SPI NAND Flash</p> <p>If your Luckfox Lyra has SPI NAND flash, you must erase it first or the SD card will be ignored during boot. See the SPI NAND Erase Guide for complete instructions.</p>"},{"location":"getting-started/overview/#make-a-backup-plan","title":"Make a Backup Plan","text":"<p>If this is your first time:</p> <ul> <li>Keep the original Raspberry Pi Pico board in case you want to revert</li> <li>Use a spare SD card for testing</li> <li>Join the community forum before starting</li> <li>Read through all documentation first</li> </ul>"},{"location":"getting-started/overview/#next-steps","title":"Next Steps","text":"<p>Ready to proceed? Here's where to go next:</p> <ul> <li> <p> Hardware Requirements</p> <p>Verify you have compatible hardware</p> <p> Check Requirements</p> </li> <li> <p> Installation Guide</p> <p>Flash Calculinux to your SD card</p> <p> Install Now</p> </li> <li> <p> First Boot</p> <p>Power on and configure your system</p> <p> Boot Up</p> </li> <li> <p> Quick Start</p> <p>Learn the basics quickly</p> <p> Quick Start</p> </li> </ul>"},{"location":"getting-started/overview/#feedback","title":"Feedback","text":"<p>This documentation is continuously improving! If you find:</p> <ul> <li>Unclear instructions</li> <li>Missing information</li> <li>Errors or outdated content</li> <li>Suggestions for improvement</li> </ul> <p>Please open an issue or submit a pull request!</p> <p>Let's get started! Head to Hardware Requirements to begin.</p>"},{"location":"getting-started/quick-start/","title":"Quick Start Guide","text":"<p>Get up and running quickly with Calculinux basics.</p>"},{"location":"getting-started/quick-start/#essential-commands","title":"Essential Commands","text":""},{"location":"getting-started/quick-start/#system-information","title":"System Information","text":"<pre><code># System version\ncat /etc/os-release\n\n# Kernel version\nuname -a\n\n# Hardware info\ncat /proc/cpuinfo\ncat /proc/meminfo\n\n# Disk usage\ndf -h\n\n# Memory usage\nfree -h\n</code></pre>"},{"location":"getting-started/quick-start/#package-management","title":"Package Management","text":"<pre><code># Update package list\nopkg update\n\n# Search for package\nopkg find &lt;name&gt;\n\n# Install package\nopkg install &lt;package&gt;\n\n# Remove package\nopkg remove &lt;package&gt;\n\n# List installed\nopkg list-installed\n</code></pre>"},{"location":"getting-started/quick-start/#file-management","title":"File Management","text":"<pre><code># Navigate directories\ncd /path/to/directory\npwd  # Show current directory\nls -la  # List files\n\n# Create/remove\nmkdir dirname\nrm filename\nrm -r dirname\n\n# Copy/move\ncp source dest\nmv source dest\n\n# View files\ncat filename\nless filename\nnano filename  # Edit\n</code></pre>"},{"location":"getting-started/quick-start/#system-management","title":"System Management","text":"<pre><code># Reboot\nreboot\n\n# Shutdown\npoweroff\n\n# Check services\nsystemctl status\nsystemctl start &lt;service&gt;\nsystemctl stop &lt;service&gt;\n\n# View logs\njournalctl -f  # Follow logs\ndmesg  # Kernel messages\n</code></pre>"},{"location":"getting-started/quick-start/#common-tasks","title":"Common Tasks","text":""},{"location":"getting-started/quick-start/#connect-to-network","title":"Connect to Network","text":"<pre><code># Ethernet (DHCP)\nudhcpc -i eth0\n\n# Check connection\nping 8.8.8.8\n</code></pre>"},{"location":"getting-started/quick-start/#install-software","title":"Install Software","text":"<pre><code># Example: Install Python\nopkg update\nopkg install python3\n\n# Example: Install text editor\nopkg install vim\n</code></pre>"},{"location":"getting-started/quick-start/#manage-files","title":"Manage Files","text":"<pre><code># Create a file\necho \"Hello World\" &gt; test.txt\n\n# Edit a file\nnano test.txt\n\n# View a file\ncat test.txt\n</code></pre>"},{"location":"getting-started/quick-start/#monitor-system","title":"Monitor System","text":"<pre><code># Real-time process monitor\nhtop  # or top\n\n# Disk usage by directory\ndu -h /home | sort -h\n\n# Running processes\nps aux\n</code></pre>"},{"location":"getting-started/quick-start/#development","title":"Development","text":""},{"location":"getting-started/quick-start/#python-example","title":"Python Example","text":"<pre><code># Create Python script\nnano hello.py\n</code></pre> <pre><code>#!/usr/bin/env python3\nprint(\"Hello from Calculinux!\")\n</code></pre> <pre><code># Make executable\nchmod +x hello.py\n\n# Run\n./hello.py\n</code></pre>"},{"location":"getting-started/quick-start/#c-example","title":"C Example","text":"<pre><code># Create C program\nnano hello.c\n</code></pre> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    printf(\"Hello from Calculinux!\\n\");\n    return 0;\n}\n</code></pre> <pre><code># Compile\ngcc hello.c -o hello\n\n# Run\n./hello\n</code></pre>"},{"location":"getting-started/quick-start/#tips-tricks","title":"Tips &amp; Tricks","text":""},{"location":"getting-started/quick-start/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<ul> <li>Ctrl+C: Stop current command</li> <li>Ctrl+Z: Suspend current command</li> <li>Ctrl+D: Exit/logout</li> <li>Tab: Auto-complete</li> </ul>"},{"location":"getting-started/quick-start/#command-history","title":"Command History","text":"<pre><code># View history\nhistory\n\n# Search history\nCtrl+R  # Then type search term\n\n# Rerun last command\n!!\n\n# Rerun command from history\n!123  # Run command #123\n</code></pre>"},{"location":"getting-started/quick-start/#useful-aliases","title":"Useful Aliases","text":"<p>Add to <code>~/.bashrc</code>:</p> <pre><code>alias ll='ls -la'\nalias update='opkg update'\nalias install='opkg install'\n</code></pre>"},{"location":"getting-started/quick-start/#learning-more","title":"Learning More","text":""},{"location":"getting-started/quick-start/#built-in-help","title":"Built-in Help","text":"<pre><code># Command manual\nman &lt;command&gt;\n\n# Command help\n&lt;command&gt; --help\n\n# Installed documentation\nls /usr/share/doc\n</code></pre>"},{"location":"getting-started/quick-start/#further-reading","title":"Further Reading","text":"<ul> <li>User Guide</li> <li>Package Management</li> <li>System Configuration</li> <li>Applications</li> </ul>"},{"location":"getting-started/quick-start/#getting-help","title":"Getting Help","text":"<ul> <li>Check Troubleshooting</li> <li>Visit Community</li> <li>Read External Docs</li> </ul>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<p>Now that you know the basics:</p> <ul> <li>Explore Basic Usage for detailed guides</li> <li>Install your favorite Applications</li> <li>Try Development if interested in coding</li> <li>Join the Community!</li> </ul>"},{"location":"hardware/compatibility/","title":"Hardware Compatibility Matrix","text":"<p>This page provides a comprehensive compatibility matrix for different hardware combinations with Calculinux.</p>"},{"location":"hardware/compatibility/#sbc-compatibility","title":"SBC Compatibility","text":"SBC Model Status RAM Options Notes Luckfox Lyra \u2705 Fully Supported 128 MB Primary platform Luckfox Lyra (SPI NAND) \u2705 Supported 128 MB Requires NAND erase Luckfox Lyra Plus \u2753 Unknown 128 MB RK3506-based with Ethernet (untested) Milk-V Duo \ud83d\udea7 Planned 64 MB Future support Milk-V Duo256 \ud83d\udea7 Planned 256 MB Future support Raspberry Pi Zero \u274c Not Compatible N/A Form factor mismatch Custom Boards \u2753 Unknown Varies Community experiments <p>Legend: - \u2705 Fully Supported - Works out of box with official images - \ud83d\udea7 Planned - Under development or planned for future - \u2753 Unknown - Not tested, may work with modifications - \u274c Not Compatible - Known not to work</p>"},{"location":"hardware/compatibility/#luckfox-lyra-variants","title":"Luckfox Lyra Variants","text":""},{"location":"hardware/compatibility/#supported-variants","title":"Supported Variants","text":"<p>Calculinux currently supports the Luckfox Lyra board with 128 MB RAM:</p> RAM Storage Status Notes 128 MB SD Card Only \u2705 Recommended Simplest setup 128 MB SPI NAND + SD \u2705 Supported Requires NAND erase first <p>Other Lyra Models</p> <ul> <li>Luckfox Lyra Plus: RK3506-based with Ethernet (untested with Calculinux)</li> <li>256 MB Lyra variants: Would require custom adapter boards due to different pinouts; community members are experimenting with this</li> </ul>"},{"location":"hardware/compatibility/#by-storage-type","title":"By Storage Type","text":"Storage Boot Priority Calculinux Support SD Card Only Primary \u2705 Recommended - simplest setup SPI NAND + SD NAND first \u2705 Supported after NAND erase"},{"location":"hardware/compatibility/#by-network-capability","title":"By Network Capability","text":"<p>Limited Network Options</p> <p>The basic Luckfox Lyra has no built-in networking. The Luckfox Lyra Plus with Ethernet would require a custom 3D-printed backplate to access the port and has not been tested with Calculinux. USB WiFi adapters are the only tested networking option.</p> Connectivity Hardware Required Status Notes Luckfox Lyra Plus (Ethernet) Custom backplate \u2753 Untested Plus model has Ethernet but not tested USB WiFi USB WiFi adapter (3.3V or powered hub) \u2705 Supported Only tested networking option"},{"location":"hardware/compatibility/#storage-compatibility","title":"Storage Compatibility","text":""},{"location":"hardware/compatibility/#microsd-cards","title":"MicroSD Cards","text":"Brand/Type Speed Class Size Status Notes SanDisk Ultra Class 10 8-32 GB \u2705 Recommended Good reliability Samsung EVO Class 10 8-32 GB \u2705 Recommended Good value Generic/No-Name Varies Any \u26a0\ufe0f Use Caution May be unreliable <p>Recommendations: - Minimum: 8 GB Class 10 - Recommended: 16-32 GB from reputable brand</p> <p>SD Card Performance</p> <p>Given the hardware speeds, different SD card classes are unlikely to have significant impact on performance.</p>"},{"location":"hardware/compatibility/#picocalc-external-sd-card-slot","title":"PicoCalc External SD Card Slot","text":"Type Status Notes Internal Lyra Storage \u2705 Fully Supported Main SD card and optional SPI NAND PicoCalc SD Card Slot \u2705 Supported Accessible external SD card slot on PicoCalc for additional storage External USB Storage (OTG) \ud83e\uddea Experimental Via Lyra's USB-C port with 3.3V devices or powered hub <p>USB-C OTG Support</p> <p>The Lyra's USB-C port supports USB On-The-Go functionality, enabling connection of external USB storage devices. However, this requires 3.3V compatible devices or an externally powered USB hub. This feature is currently experimental and may require additional configuration.</p>"},{"location":"hardware/compatibility/#display-compatibility","title":"Display Compatibility","text":""},{"location":"hardware/compatibility/#integrated-display","title":"Integrated Display","text":"PicoCalc Model Display Type Status PicoCalc ILI9488 LCD \u2705 Fully Supported"},{"location":"hardware/compatibility/#replacement-display-options","title":"Replacement Display Options","text":"Display Type Connector Size Requirement Status MIPI DSI (Higher Resolution) 22-pin (CM4 compatible) 3.95\" diagonal, square \ud83d\udea7 Possible Original ILI9488 SPI 320\u00d7320 \u2705 Standard <p>MIPI DSI Display Upgrade</p> <p>Higher resolution MIPI DSI displays are possible if they use the same 22-pin connector found on Raspberry Pi Compute Module IO boards. The display must be square format and exactly 3.95\" diagonal to fit within the PicoCalc enclosure. This would require hardware modification and custom driver configuration.</p>"},{"location":"hardware/compatibility/#input-device-compatibility","title":"Input Device Compatibility","text":""},{"location":"hardware/compatibility/#integrated-keyboard","title":"Integrated Keyboard","text":"PicoCalc Model Keyboard Status All Models Matrix Keyboard \u2705 Fully Supported"},{"location":"hardware/compatibility/#external-input","title":"External Input","text":"Device Type Connection Status Notes USB Input Devices USB-C OTG \ud83e\uddea Experimental Requires 3.3V devices or powered hub Keyboard/Mouse USB-C OTG \ud83e\uddea Experimental May work with compatible devices <p>USB OTG Input Support</p> <p>While the integrated matrix keyboard is the primary input method, external USB input devices may be possible via the USB-C OTG port. This requires 3.3V compatible devices or an externally powered USB hub and is currently untested.</p>"},{"location":"hardware/compatibility/#network-hardware","title":"Network Hardware","text":""},{"location":"hardware/compatibility/#built-in-network","title":"Built-in Network","text":"Model Interface Speed Status Lyra Plus Ethernet (10/100) 100 Mbps \u2753 Untested - Requires custom backplate Lyra None N/A N/A - USB WiFi adapters supported <p>Network Options</p> <ul> <li>Luckfox Lyra: No built-in networking. USB WiFi adapters (3.3V or via powered hub) are the only networking option.</li> <li>Luckfox Lyra Plus: Has built-in Ethernet but has not been tested with Calculinux and would require a custom 3D-printed backplate to access the Ethernet port within the PicoCalc enclosure.</li> </ul>"},{"location":"hardware/compatibility/#power-supply-compatibility","title":"Power Supply Compatibility","text":""},{"location":"hardware/compatibility/#internal-battery-power","title":"Internal Battery Power","text":"Power Source Status Notes PicoCalc Internal Battery \u2705 Fully Supported Rechargeable lithium-ion PicoCalc USB-C Port \u2705 Supported Battery charging + serial console to Lyra Lyra USB-C Port \u2705 Supported USB-OTG data only (does NOT charge PicoCalc) <p>Two USB-C Ports</p> <p>The PicoCalc has TWO USB-C ports with different functions:</p> <ul> <li>PicoCalc USB-C Port: Used for charging the internal battery and provides a USB serial console connection to the Lyra (at 1500000 baud)</li> <li>Lyra USB-C Port: Provides USB On-The-Go (OTG) functionality for external devices but does NOT charge the PicoCalc batteries. External devices must be 3.3V compatible or use an externally powered hub.</li> </ul>"},{"location":"hardware/compatibility/#peripheral-compatibility","title":"Peripheral Compatibility","text":""},{"location":"hardware/compatibility/#internal-peripherals","title":"Internal Peripherals","text":"Device Type Status Notes Display \u2705 Fully Supported Integrated LCD Keyboard \u2705 Fully Supported Matrix keyboard Lyra Storage \u2705 Fully Supported Lyra's SD card, optional NAND PicoCalc SD Card Slot \u2705 Fully Supported External SD card accessible on PicoCalc"},{"location":"hardware/compatibility/#expansion-interfaces","title":"Expansion Interfaces","text":"<p>Internal Expansion Options</p> <p>While the Luckfox Lyra is enclosed within the PicoCalc, it provides several expansion interfaces accessible for hardware modifications and custom projects. For detailed pinout information, see the official Luckfox Lyra pinout documentation.</p> Interface Voltage Status Notes GPIO 3.3V \u2705 Available External GPIO pins are free (display/keyboard do not use them) USB 3.3V \u2705 Available Internal USB host/device I2C 3.3V \u2705 Available I2C bus for sensors/peripherals I2S 3.3V \u2753 Untested Audio interface available but untested SPI 3.3V \u2705 Available SPI interface (shared with display) UART 3.3V \u2705 Available Serial communication <p>3.3V Logic Level Requirement</p> <p>CRITICAL: All interfaces operate at 3.3V logic levels only. Using 5V devices or signals will damage the hardware. The PicoCalc is designed for tinkering and experimentation, but proper voltage levels must be maintained.</p>"},{"location":"hardware/compatibility/#expansion-peripheral-compatibility","title":"Expansion Peripheral Compatibility","text":"Peripheral Type Interface Status Notes Sensors I2C/SPI \u2705 Compatible Temperature, accelerometer, etc. External Storage USB 3.3V \u2705 Compatible Flash drives, custom storage Network Modules USB/SPI \ud83d\udea7 Possible WiFi/cellular modules (3.3V) Audio Devices (I2S) I2S \u2753 Untested External audio codecs via I2S interface Audio Devices (PWM) GPIO (PWM) \u26a0\ufe0f Limited See PWM audio note below Replacement Displays MIPI DSI \ud83d\udea7 Possible 22-pin connector, 3.95\" square Additional SPI Displays SPI \u26a0\ufe0f Conflicts Would conflict with main display Input Devices GPIO/I2C \ud83d\udea7 Possible Additional buttons, encoders Communication UART/USB \u2705 Compatible Serial devices, modems <p>PWM Audio Details</p> <p>The PicoCalc has built-in audio support using PWM (Pulse Width Modulation) on GPIO pins. However, there are significant limitations:</p> <ul> <li>The Lyra's PWM is not available on the correct pins without hardware modification</li> <li>Software PWM must be used instead on pins with only 1.2V tolerance</li> <li>This results in low volume audio and high CPU usage</li> </ul> <p>For proper audio, hardware modifications are needed to access the correct PWM pins or use the I2S interface. See the Hardware Modifications guide for details on enabling full-volume audio (documentation stub - refer to the ClockworkPi forum for community solutions).</p> <p>Custom Hardware Projects</p> <p>These expansion options enable custom hardware projects and modifications for advanced users comfortable with electronics work.</p>"},{"location":"hardware/compatibility/#software-compatibility","title":"Software Compatibility","text":"<p>Console-Only System</p> <p>Calculinux is currently a console-only system with no graphical desktop environment. All interaction is via text terminal. This is by design to maximize performance on limited hardware (128 MB RAM).</p>"},{"location":"hardware/compatibility/#console-applications","title":"Console Applications","text":"<p>All console applications work well with the 128 MB RAM configuration:</p> Application Type Status Notes Terminal Apps \u2705 Fully Supported All work well Text Editor (vim/nano) \u2705 Fully Supported All work well Scripting (Python/Bash) \u2705 Fully Supported All work well Development Tools \u2705 Fully Supported All work well Command-line Tools \u2705 Fully Supported All work well"},{"location":"hardware/compatibility/#gaming-and-entertainment-community-tested","title":"Gaming and Entertainment (Community Tested)","text":"<p>Community Testing Results</p> <p>These applications have been tested by community members but may not be included in official Calculinux images.</p> Application Status Notes Pico-8 \u2705 Working Runs smoothly, audio requires hardware mod Doom (prboom) \u2705 Working Good performance, tested extensively RetroArch \u26a0\ufe0f Issues Has configuration problems tmux \u2705 Working Terminal multiplexer works well Framebuffer apps \u2705 Working FBV image viewer confirmed working <p>Gaming Performance</p> <p>Gaming applications work but are limited by SPI display bandwidth. Not all emulators perform well due to hardware constraints.</p>"},{"location":"hardware/compatibility/#testing-status","title":"Testing Status","text":""},{"location":"hardware/compatibility/#tested-configurations","title":"Tested Configurations","text":"Configuration Test Date Status Lyra 128MB + 64GB SD Mar 2025 \u2705 Working"},{"location":"hardware/compatibility/#known-issues","title":"Known Issues","text":"Issue Affected Hardware Status Workaround SPI NAND Boot Lyra with NAND \u2705 Documented Erase NAND first Slow SD Cards External SD card \u26a0\ufe0f Known Use internal storage for demanding tasks"},{"location":"hardware/compatibility/#community-testing","title":"Community Testing","text":"<p>We need community help testing various hardware combinations!</p>"},{"location":"hardware/compatibility/#untested-configurations","title":"Untested Configurations","text":"<p>Help us test these combinations:</p> <ul> <li>[ ] Different SD card brands (though performance differences are likely minimal)</li> <li>[ ] Various applications (request inclusion!)</li> <li>[ ] Luckfox Lyra Plus (Ethernet model) with custom backplate</li> </ul>"},{"location":"hardware/compatibility/#how-to-report","title":"How to Report","text":"<p>If you test a configuration:</p> <ol> <li>Open an issue on GitHub</li> <li>Include:</li> <li>Hardware model and version</li> <li>SD card brand and size</li> <li>Any peripherals connected</li> <li>What works / doesn't work</li> <li>Use the \"Hardware Compatibility Report\" template</li> </ol>"},{"location":"hardware/compatibility/#future-hardware-support","title":"Future Hardware Support","text":""},{"location":"hardware/compatibility/#planned","title":"Planned","text":"<ul> <li>Milk-V Duo: Similar form factor, RISC-V processor</li> <li>Custom Carrier Boards: Community-designed alternatives</li> </ul>"},{"location":"hardware/compatibility/#under-consideration","title":"Under Consideration","text":"<ul> <li>Pine64 Ox64: RISC-V option</li> <li>Raspberry Pi alternatives: If form factor matches</li> </ul>"},{"location":"hardware/compatibility/#next-steps","title":"Next Steps","text":"<ul> <li>Review Hardware Requirements</li> <li>Check Luckfox Lyra details</li> <li>See Hardware Modifications guide</li> </ul>"},{"location":"hardware/display-input/","title":"Display &amp; Input Technical Details","text":"<p>This page provides technical implementation details about the PicoCalc display and keyboard drivers and device tree configuration.</p> <p>Hardware Specifications</p> <p>For high-level hardware specifications (display resolution, keyboard type, etc.), see the Hardware Specifications page. This page focuses on driver implementation and device tree configuration.</p>"},{"location":"hardware/display-input/#display-system","title":"Display System","text":""},{"location":"hardware/display-input/#lcd-panel-specifications","title":"LCD Panel Specifications","text":"Specification Details Interface SPI (Serial Peripheral Interface) Controller ILI9488 (or similar) Resolution 320\u00d7320 pixels Text Mode 53 columns \u00d7 40 rows (6\u00d78 font) Color Depth 16-bit RGB565 Refresh Rate ~60Hz <p>Panel Variations</p> <p>The PicoCalc uses a 320\u00d7320 pixel display with an ILI9488 controller. The small text area (53\u00d740 characters) means that many applications will wrap text lines, but this is usually manageable with proper terminal configuration.</p>"},{"location":"hardware/display-input/#spi-configuration","title":"SPI Configuration","text":"<p>The display connects via SPI with the following characteristics:</p> <pre><code>SPI Bus: spi0\nMode: 0 (CPOL=0, CPHA=0)\nBits per word: 8\nMax Speed: 80 MHz (overclocked for better performance)\nStandard Speed: 40 MHz\n</code></pre> <p>SPI Overclocking</p> <p>Community testing shows the display SPI can be safely overclocked to 80MHz for improved performance, though this may be limited by SPI bandwidth for full framerate applications.</p>"},{"location":"hardware/display-input/#framerate-limitations","title":"Framerate Limitations","text":"Usage Type Expected Performance Text/Console Full speed Graphics Applications &lt;60fps due to SPI bandwidth Gaming Varies by complexity"},{"location":"hardware/display-input/#text-display-considerations","title":"Text Display Considerations","text":"<p>The 320\u00d7320 pixel display with 6\u00d78 font provides a text area of 53 columns \u00d7 40 rows. This is smaller than most software expects:</p> <ul> <li>Standard terminal: 80\u00d724 or larger</li> <li>Many applications assume at least 80 columns</li> <li>Text lines will often wrap, requiring horizontal scrolling</li> <li>Some TUI applications may have layout issues</li> </ul> <p>Workarounds: - Use applications designed for small terminals - Configure <code>COLUMNS=53</code> and <code>LINES=40</code> environment variables - Use terminal pagers with line wrapping (<code>less -S</code> for side-scrolling) - Choose compact display options when available in applications</p>"},{"location":"hardware/display-input/#backlight-control","title":"Backlight Control","text":"<p>The backlight is controlled by the STM32 MCU, not directly by the Linux system:</p> <p>Current Implementation: Limited display sleep functionality Interface: Via MFD drivers (experimental) MCU Control: Brightness managed by keyboard MCU firmware</p> <p>Backlight Limitations</p> <p>Current display sleep functionality does not yet control the backlight directly. Full backlight control is intended to be implemented through the experimental MFD drivers that communicate with the keyboard MCU.</p> <p>Display Sleep (without backlight control): <pre><code># Turn off display (framebuffer only)\necho 0 &gt; /sys/class/backlight/picocalc/bl_power\n\n# Turn on display\necho 1 &gt; /sys/class/backlight/picocalc/bl_power\n</code></pre></p>"},{"location":"hardware/display-input/#display-driver","title":"Display Driver","text":"<p>Calculinux uses a custom ILI9488 framebuffer driver:</p> <p>Driver Name: <code>ili9488</code> Compatible: <code>ilitek,ili9488</code></p> <p>Features: - Direct framebuffer access (<code>/dev/fb0</code>) - 320\u00d7320 pixel resolution - 30 FPS target frame rate - SPI interface at up to 80MHz - Hardware-specific optimizations</p> <p>Driver Location: Available in the picocalc-drivers repository</p>"},{"location":"hardware/display-input/#device-tree-configuration","title":"Device Tree Configuration","text":"<p>Actual device tree configuration from <code>rk3506-luckfox-lyra.dtsi</code>:</p> <pre><code>&amp;spi0 {\n    status = \"okay\";\n    pinctrl-names = \"default\";\n    pinctrl-0 = &lt;&amp;rm_io7_spi0_clk &amp;rm_io6_spi0_mosi &amp;rm_io5_spi0_miso&gt;;\n\n    ili9488: ili9488@0 {\n        status = \"okay\";\n        compatible = \"ilitek,ili9488\";\n        spi-max-frequency = &lt;80000000&gt;;\n        reg = &lt;0&gt;;\n        pinctrl-names = \"default\";\n        pinctrl-0 = &lt;&amp;ili9488_pins&gt;;\n        fps = &lt;30&gt;;\n        width = &lt;320&gt;;\n        height = &lt;320&gt;;\n        cs = &lt;&amp;gpio0 RK_PA4 GPIO_ACTIVE_HIGH&gt;;\n        dc = &lt;&amp;gpio0 RK_PA3 GPIO_ACTIVE_HIGH&gt;;\n        rst = &lt;&amp;gpio0 RK_PA2 GPIO_ACTIVE_HIGH&gt;;\n    };\n};\n</code></pre> <p>GPIO Pin Configuration: <pre><code>ili9488 {\n    ili9488_pins: ili9488-pins {\n        rockchip,pins =\n            &lt;0 RK_PA4 RK_FUNC_GPIO &amp;pcfg_pull_none&gt;,  /* CS */\n            &lt;0 RK_PA3 RK_FUNC_GPIO &amp;pcfg_pull_none&gt;,  /* DC */\n            &lt;0 RK_PA2 RK_FUNC_GPIO &amp;pcfg_pull_none&gt;;  /* RST */\n    };\n};\n</code></pre></p>"},{"location":"hardware/display-input/#performance-considerations","title":"Performance Considerations","text":"<p>Bandwidth Calculation: <pre><code>320 \u00d7 320 pixels \u00d7 2 bytes \u00d7 60 fps = 12.3 MB/s\nAt 80 MHz SPI: ~10 MB/s theoretical maximum\n</code></pre></p> <p>The driver implements: - Frame skipping if needed - Partial updates for efficiency - Double buffering to reduce tearing</p>"},{"location":"hardware/display-input/#backlight-control_1","title":"Backlight Control","text":"<p>The backlight is controlled via PWM:</p> <p>Interface: <code>/sys/class/backlight/picocalc/</code></p> <p>Control: <pre><code># Set brightness (0-255)\necho 200 &gt; /sys/class/backlight/picocalc/brightness\n\n# Get current brightness\ncat /sys/class/backlight/picocalc/brightness\n\n# Get maximum brightness\ncat /sys/class/backlight/picocalc/max_brightness\n</code></pre></p>"},{"location":"hardware/display-input/#keyboard-system","title":"Keyboard System","text":""},{"location":"hardware/display-input/#keyboard-architecture","title":"Keyboard Architecture","text":"<p>The PicoCalc keyboard uses a sophisticated architecture with a dedicated microcontroller:</p> <p>MCU: STM32F103R8T6 \"southbridge\" chip running Arduino code Interface: I2C communication to the Luckfox Lyra Matrix: Physical matrix keyboard handled internally by the MCU</p> <p>MCU Southbridge Design</p> <p>The keyboard MCU handles matrix scanning internally and presents a clean I2C interface to the main SBC. This design offloads keyboard processing and enables additional functionality like power management and brightness control.</p>"},{"location":"hardware/display-input/#mcu-functions","title":"MCU Functions","text":"<p>The STM32F103R8T6 microcontroller provides multiple functions:</p> Function Status Notes Keyboard Matrix Scanning \u2705 Active Internal matrix handling I2C Communication \u2705 Active Interface to Luckfox Lyra Battery Monitoring \ud83e\uddea Experimental Via MFD drivers Brightness Control \ud83e\uddea Experimental Screen and keyboard backlight Power Button Support \ud83e\uddea Experimental System shutdown control RTC (Alternate Firmware) \ud83d\udea7 Future Custom firmware feature"},{"location":"hardware/display-input/#firmware-options","title":"Firmware Options","text":""},{"location":"hardware/display-input/#default-firmware","title":"Default Firmware","text":"<p>Source: clockworkpi/PicoCalc Platform: Arduino code for STM32F103R8T6 Features: Basic keyboard and I2C communication</p>"},{"location":"hardware/display-input/#custom-bios-firmware","title":"Custom BIOS Firmware","text":"<p>Source: Custom PicoCalc BIOS Forum Discussion: Custom PicoCalc BIOS Thread Additional Features: - Real-Time Clock (RTC) support - Enhanced power management - Extended I2C functionality</p> <p>Firmware Development</p> <p>The keyboard MCU firmware is user-upgradeable, enabling community development of enhanced features and functionality.</p>"},{"location":"hardware/display-input/#i2c-communication","title":"I2C Communication","text":"<p>I2C Address: (Device-specific, check firmware documentation) Bus Speed: Standard mode (100 kHz) or Fast mode (400 kHz) Protocol: Custom protocol defined by firmware</p>"},{"location":"hardware/display-input/#linux-driver-integration","title":"Linux Driver Integration","text":""},{"location":"hardware/display-input/#mfd-multi-function-device-drivers","title":"MFD (Multi-Function Device) Drivers","text":"<p>Status: \ud83e\uddea Experimental - under development Purpose: Unified driver for all MCU functions</p> <p>Driver Components: - Keyboard input device - Battery monitoring - Brightness control - Power management - RTC support (custom firmware)</p> <p>Driver Development Status</p> <p>The MFD drivers are experimental and not yet complete. They show promise but may not be fully functional in current releases.</p>"},{"location":"hardware/display-input/#keyboard-driver","title":"Keyboard Driver","text":"<p>Driver Type: MFD (Multi-Function Device) with I2C communication Driver Name: <code>picocalc_mfd</code> (experimental)</p> <p>Features: - I2C communication with STM32 MCU - Standard Linux input device interface - Integration with MCU power management - Battery monitoring support - Brightness control interface</p> <p>Driver Location: <code>drivers/mfd/picocalc_mfd.c</code> (experimental)</p> <p>Legacy vs MFD Drivers</p> <p>Current stable releases may use simpler keyboard-only drivers, while experimental MFD drivers provide full MCU integration. Check your kernel configuration for which driver is active.</p>"},{"location":"hardware/display-input/#device-tree-configuration_1","title":"Device Tree Configuration","text":"<p>Actual device tree configuration for I2C keyboard MCU from <code>rk3506-luckfox-lyra.dtsi</code>:</p> <pre><code>&amp;i2c2 {\n    status = \"okay\";\n    pinctrl-names = \"default\";\n    pinctrl-0 = &lt;&amp;rm_io10_i2c2_scl &amp;rm_io11_i2c2_sda&gt;;\n    max-frequency = &lt;400000&gt;;\n\n    picocalc_kbd: picocalc_kbd@1f {\n        status = \"okay\";\n        compatible = \"picocalc_kbd\";\n        reg = &lt;0x1F&gt;;\n    };\n};\n</code></pre> <p>I2C Pin Configuration: <pre><code>&amp;pinctrl {\n    rm_io11 {\n        rm_io11_i2c2_sda: rm-io11-i2c2-sda {\n            rockchip,pins = &lt;0 RK_PB3 35 &amp;pcfg_pull_none&gt;;\n        };\n    };\n\n    rm_io10 {\n        rm_io10_i2c2_scl: rm-io10-i2c2-scl {\n            rockchip,pins = &lt;0 RK_PB2 34 &amp;pcfg_pull_none&gt;;\n        };\n    };\n};\n</code></pre></p> <p>I2C Configuration</p> <p>The keyboard MCU is connected to I2C bus 2 at address 0x1F, running at 400kHz (fast mode).</p>"},{"location":"hardware/display-input/#input-device-interface","title":"Input Device Interface","text":"<p>The keyboard appears as a standard Linux input device:</p> <p>Device Path: <code>/dev/input/event0</code></p> <p>Testing Input: <pre><code># List input devices\ncat /proc/bus/input/devices\n\n# Monitor keyboard events\nevtest /dev/input/event0\n</code></pre></p>"},{"location":"hardware/display-input/#custom-key-bindings","title":"Custom Key Bindings","text":"<p>Users can remap keys using standard Linux tools:</p> <p>Using udev/hwdb: <pre><code># /etc/udev/hwdb.d/90-picocalc-keyboard.hwdb\nevdev:input:b0003v*p*\n KEYBOARD_KEY_1e=leftshift\n</code></pre></p>"},{"location":"hardware/display-input/#display-output","title":"Display Output","text":""},{"location":"hardware/display-input/#console-text-mode","title":"Console (Text Mode)","text":"<p>Console Driver: <code>fbcon</code> (framebuffer console) Default Font: 6\u00d78 pixels Text Area: 53 columns \u00d7 40 rows (at 320\u00d7320 with 6\u00d78 font)</p> <p>Configuration: <pre><code># /etc/default/console-setup\nACTIVE_CONSOLES=\"/dev/tty[1-6]\"\nFONTFACE=\"Terminus\"\nFONTSIZE=\"6x8\"\n</code></pre></p> <p>Font Rendering: - Character size: 6\u00d78 pixels - Text area: 53\u00d740 characters - VGA text mode emulation - UTF-8 support</p>"},{"location":"hardware/display-input/#graphical-display","title":"Graphical Display","text":"<p>The display is graphics-capable but no graphical environment is installed by default:</p> <p>Current State: Console-only by default Experimentation Encouraged: Community testing of graphical environments</p> <p>Potential Display Servers: - X11: Would require <code>xf86-video-fbdev</code> driver installation - Wayland: Would require compositor with fbdev backend - Direct Rendering: Via <code>/dev/fb0</code> for custom applications</p> <p>Graphics Capability</p> <p>While Calculinux ships as console-only, the hardware supports graphics applications. Community experimentation with X11, Wayland, or direct framebuffer graphics is encouraged.</p>"},{"location":"hardware/display-input/#power-management","title":"Power Management","text":""},{"location":"hardware/display-input/#display-sleep","title":"Display Sleep","text":"<p>The display can be put to sleep to save power:</p> <pre><code># Turn off display\necho 0 &gt; /sys/class/backlight/picocalc/bl_power\n\n# Turn on display\necho 1 &gt; /sys/class/backlight/picocalc/bl_power\n</code></pre>"},{"location":"hardware/display-input/#automatic-dimming","title":"Automatic Dimming","text":"<p>Configure automatic dimming:</p> <pre><code># Using systemd-logind\n# /etc/systemd/logind.conf\nIdleAction=ignore\nIdleActionSec=5min\n</code></pre>"},{"location":"hardware/display-input/#troubleshooting","title":"Troubleshooting","text":""},{"location":"hardware/display-input/#display-issues","title":"Display Issues","text":"<p>Symptom: No display output</p> <p>Check: <pre><code># Verify framebuffer device exists\nls -l /dev/fb0\n\n# Check ILI9488 driver loaded\nlsmod | grep ili9488\n\n# View kernel logs\ndmesg | grep -i ili9488\n</code></pre></p> <p>Symptom: Display corruption or tearing</p> <p>Solutions: - Check display cable is fully inserted - Reduce SPI clock speed in device tree - Enable double buffering - Verify power supply stability</p>"},{"location":"hardware/display-input/#keyboard-issues","title":"Keyboard Issues","text":"<p>Symptom: Keys not responding</p> <p>Check via Serial Console: 1. Connect to PicoCalc USB-C port at 1500000 baud 2. Log in to the system 3. Check which keyboard driver is loaded:</p> <pre><code># Check for picocalc_kbd driver\nlsmod | grep picocalc_kbd\n\n# Check for MFD keyboard driver  \nlsmod | grep picocalc_mfd_kbd\n\n# Try loading the alternative driver if needed\nmodprobe picocalc_mfd_kbd\n# or\nmodprobe picocalc_kbd\n</code></pre> <p>Additional Checks: <pre><code># Verify input device exists\nls -l /dev/input/event*\n\n# Check I2C communication\ni2cdetect -y 2  # MCU is on I2C bus 2\n\n# Test raw input\nevtest /dev/input/event0\n</code></pre></p> <p>If Problems Persist: File a bug report with: - Which drivers you tested - Serial console output - Kernel log messages (<code>dmesg | grep -i picocalc</code>)</p> <p>Symptom: Intermittent key responses</p> <p>Check: <pre><code># Check I2C bus errors\ndmesg | grep -i i2c\n\n# Monitor MCU communication\n# (requires debug firmware or driver)\n</code></pre></p> <p>Symptom: Key repeat too fast/slow</p> <p>Adjust: <pre><code># Set repeat rate (delay, rate)\nkbdrate -d 250 -r 30\n</code></pre></p>"},{"location":"hardware/display-input/#development-debugging","title":"Development &amp; Debugging","text":""},{"location":"hardware/display-input/#graphics-programming","title":"Graphics Programming","text":"<p>For graphics applications, we recommend using SDL rather than direct framebuffer access:</p> <p>SDL (Simple DirectMedia Layer): - Cross-platform graphics library - Handles framebuffer abstraction - Better compatibility and portability - Hardware acceleration where available</p> <p>SDL Documentation: SDL2 Documentation</p> <p>Basic SDL Setup: <pre><code>#include &lt;SDL2/SDL.h&gt;\n\nint main() {\n    SDL_Init(SDL_INIT_VIDEO);\n    SDL_Window* window = SDL_CreateWindow(\"PicoCalc App\", \n        SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, \n        320, 320, SDL_WINDOW_SHOWN);\n    SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, 0);\n\n    // Your graphics code here\n\n    SDL_DestroyRenderer(renderer);\n    SDL_DestroyWindow(window);\n    SDL_Quit();\n    return 0;\n}\n</code></pre></p>"},{"location":"hardware/display-input/#reading-keyboard-events","title":"Reading Keyboard Events","text":"<p>Example Python code:</p> <pre><code>from evdev import InputDevice, categorize, ecodes\n\ndev = InputDevice('/dev/input/event0')\n\nfor event in dev.read_loop():\n    if event.type == ecodes.EV_KEY:\n        print(categorize(event))\n</code></pre>"},{"location":"hardware/display-input/#driver-source-code","title":"Driver Source Code","text":"<p>The complete driver source code is available in the Calculinux picocalc-drivers repository:</p> <ul> <li>Display Driver (ILI9488): picocalc-drivers repository</li> <li>MFD Keyboard Driver: picocalc-drivers repository</li> <li>Hisptoot Keyboard Driver: picocalc-drivers repository</li> <li>Device Tree: meta-calculinux repository</li> </ul>"},{"location":"hardware/display-input/#mcu-firmware-source-code","title":"MCU Firmware Source Code","text":"<ul> <li>Default Firmware: clockworkpi/PicoCalc</li> <li>Custom BIOS: jackcartersmith/picocalc_BIOS</li> </ul> <p>Driver Repository</p> <p>Hardware-specific drivers are maintained in the picocalc-drivers repository, while the meta-calculinux repository contains the build system and device tree configurations.</p>"},{"location":"hardware/display-input/#contributing","title":"Contributing","text":"<p>Improvements to the display and keyboard drivers are welcome! See Contributing for guidelines.</p>"},{"location":"hardware/display-input/#next-steps","title":"Next Steps","text":"<ul> <li>Learn about Power Management</li> <li>Review Hardware Modifications</li> <li>Explore Kernel Development</li> </ul>"},{"location":"hardware/luckfox-lyra/","title":"Luckfox Lyra","text":"<p>The Luckfox Lyra is a compact single-board computer based on the Rockchip RK3506G2 SoC, making it an ideal replacement for the PicoCalc's stock module.</p>"},{"location":"hardware/luckfox-lyra/#overview","title":"Overview","text":"<p>The Luckfox Lyra provides significant computing power in a small form factor, perfect for pocket-sized Linux applications.</p> <p>Complete Technical Specifications</p> <p>For detailed processor, memory, interface, and power specifications, see the Hardware Specifications page.</p>"},{"location":"hardware/luckfox-lyra/#luckfox-lyra-versions","title":"Luckfox Lyra Versions","text":"Model RAM Flash Ethernet Status Luckfox Lyra 128MB None No \u2705 Recommended Luckfox Lyra B (SPI NAND) 128MB 256MB SPI NAND No \u2705 Supported (NAND must be erased) Luckfox Lyra Plus 128MB 256 MB SPI NAND Yes (10/100) \u2753 Untested (Requires a custom printed backplate) <p>Recommended Version</p> <p>The standard 128MB model with SPI NAND is recommended for better compatibility with future features.</p> <p>SPI NAND Must Be Erased</p> <p>If your board has SPI NAND, you must erase it before Calculinux will boot from SD card. The boot ROM always tries NAND first. See the comprehensive SPI NAND Erase Guide for detailed step-by-step instructions.</p> <p>Other Lyra Models</p> <p>Other Luckfox Lyra models exist (64MB, 256MB RAM) but have different pinouts and would require custom adapter boards for PicoCalc compatibility.</p>"},{"location":"hardware/luckfox-lyra/#why-luckfox-lyra-for-picocalc","title":"Why Luckfox Lyra for PicoCalc?","text":"<p>The Luckfox Lyra is particularly well-suited for PicoCalc:</p> <ol> <li>Size: Compact form factor fits inside PicoCalc</li> <li>Power: Efficient enough for battery operation</li> <li>Performance: Sufficient for Linux console applications and development</li> <li>Interfaces: SPI and GPIO interfaces match PicoCalc requirements</li> <li>Community: Active development and support</li> <li>Cost: Affordable pricing</li> </ol>"},{"location":"hardware/luckfox-lyra/#driver-support-in-calculinux","title":"Driver Support in Calculinux","text":"<p>Calculinux includes custom kernel drivers developed specifically for the Luckfox Lyra + PicoCalc combination. For technical details about the drivers and device tree configuration, see Display &amp; Input Technical Details.</p>"},{"location":"hardware/luckfox-lyra/#included-drivers","title":"Included Drivers","text":"<ul> <li>LCD Driver: ILI9488 framebuffer driver for 320\u00d7320 display</li> <li>Keyboard Driver: I2C-based keyboard with STM32 MCU integration  </li> <li>WiFi Drivers: Support for multiple Realtek and other chipsets (see WiFi Chipsets)</li> <li>Device Tree: Custom configuration for PicoCalc hardware connections</li> </ul>"},{"location":"hardware/luckfox-lyra/#luckfox-sdk-vs-calculinux","title":"Luckfox SDK vs Calculinux","text":""},{"location":"hardware/luckfox-lyra/#official-luckfox-sdk","title":"Official Luckfox SDK","text":"<p>The Luckfox Lyra uses the Luckfox Lyra SDK:</p> <ul> <li>Documentation: Available in SDK repository</li> <li>Build System: Buildroot-based</li> <li>Community Usage: Most community images use this SDK</li> </ul>"},{"location":"hardware/luckfox-lyra/#calculinux-architecture","title":"Calculinux Architecture","text":"<p>Calculinux is independently developed with a different approach:</p> <ul> <li>Build System: Upstream Yocto (not Buildroot)</li> <li>Developer: 0xd61 (personal repository continuation)</li> <li>Relationship to SDK: Limited - only uses kernel and u-boot sources</li> <li>Kernel: Hosted externally to the SDK</li> <li>U-Boot: Hosted externally with custom patches</li> <li>Everything Else: Independent implementation with upstream compilers</li> </ul> <p>Independent Development</p> <p>While most community images are built with the Luckfox SDK and Buildroot, Calculinux is developed independently using upstream Yocto and only borrows the kernel and bootloader sources. Our goal is to foster innovation and promote sharing and pooling our resources to the benefit of all picocalc based Linux distros</p>"},{"location":"hardware/luckfox-lyra/#other-major-community-images","title":"Other Major Community Images","text":"<p>For completeness, other distributions available for Luckfox Lyra include:</p> <ul> <li>hisptoot's Buildroot images - Original community port using Luckfox SDK</li> <li>markbirss's Ubuntu images - Ubuntu 22.04/24.04 based distributions</li> <li>Community Buildroot variants - Various SDK-based images with different features</li> </ul> <p>See the ClockworkPi forum thread for links to these alternative distributions.</p>"},{"location":"hardware/luckfox-lyra/#hardware-considerations","title":"Hardware Considerations","text":""},{"location":"hardware/luckfox-lyra/#boot-media-priority","title":"Boot Media Priority","text":"<p>The RK3506G2 boot ROM follows this priority:</p> <ol> <li>SPI NAND (if present and programmed)</li> <li>SD Card (if SPI NAND is erased or absent)</li> <li>USB Boot (for recovery/programming)</li> </ol> <p>NAND Boot Priority</p> <p>If your Luckfox Lyra has SPI NAND, the boot ROM will always try NAND first. You must erase the NAND or it will ignore the SD card completely. See the SPI NAND Erase Guide for complete instructions.</p>"},{"location":"hardware/luckfox-lyra/#power-supply-thermal-management","title":"Power Supply &amp; Thermal Management","text":"<p>For power requirements and thermal considerations, see Hardware Specifications.</p>"},{"location":"hardware/luckfox-lyra/#purchasing","title":"Purchasing","text":"<p>Luckfox Lyra boards are available from:</p> <ul> <li>Luckfox Official Store: https://www.luckfox.com/Luckfox-Lyra</li> <li>AliExpress: Search for \"Luckfox Lyra\"</li> <li>Other Distributors: Check Luckfox website for authorized sellers</li> </ul> <p>Official Source</p> <p>The official Luckfox website is the authoritative source for current specifications and available variants.</p>"},{"location":"hardware/luckfox-lyra/#resources","title":"Resources","text":""},{"location":"hardware/luckfox-lyra/#official-documentation","title":"Official Documentation","text":"<ul> <li>Luckfox Website: https://www.luckfox.com/</li> <li>SDK: Luckfox Lyra SDK</li> <li>Wiki: Luckfox Wiki</li> </ul>"},{"location":"hardware/luckfox-lyra/#community-resources","title":"Community Resources","text":"<ul> <li>Forum Thread: Luckfox Lyra on PicoCalc</li> <li>Original Port: hisptoot's Google Drive with initial images and drivers</li> <li>Discord Server: Calculinux Discord</li> </ul>"},{"location":"hardware/luckfox-lyra/#next-steps","title":"Next Steps","text":"<ul> <li>Learn about the PicoCalc hardware</li> <li>Review Hardware Specifications for complete technical details</li> <li>Check Display &amp; Input for driver implementation details</li> <li>See Hardware Compatibility for compatibility matrices</li> <li>Follow Hardware Modifications for installation guide</li> </ul>"},{"location":"hardware/modifications/","title":"Hardware Modifications","text":"<p>This guide covers the physical modifications required to install a Luckfox Lyra (or similar SBC) into your PicoCalc.</p>"},{"location":"hardware/modifications/#prerequisites","title":"Prerequisites","text":""},{"location":"hardware/modifications/#tools-required","title":"Tools Required","text":"<ul> <li>The allen wrench that came with the picocalc</li> <li>Good lighting and magnification (optional)</li> <li>A soft cloth to work or pad on</li> </ul>"},{"location":"hardware/modifications/#parts-needed","title":"Parts Needed","text":"<ul> <li>Luckfox Lyra SBC (see compatible versions)</li> <li>MicroSD card (8GB minimum, 64GB+ recommended)</li> </ul>"},{"location":"hardware/modifications/#disassembly","title":"Disassembly","text":""},{"location":"hardware/modifications/#step-1-power-off-and-disconnect","title":"Step 1: Power Off and Disconnect","text":"<ol> <li>Power off the PicoCalc completely</li> <li>remove the batteries</li> </ol>"},{"location":"hardware/modifications/#step-2-open-the-case","title":"Step 2: Open the Case","text":"<ol> <li>Remove all screws, open the case.</li> <li>disconnect the LCD</li> </ol>"},{"location":"hardware/modifications/#step-3-remove-original-board","title":"Step 3: Remove Original Board","text":"<ol> <li>Locate the existing RP2040/Pico board</li> <li>Unplug the RP2040 from its socket.</li> </ol>"},{"location":"hardware/modifications/#installation","title":"Installation","text":""},{"location":"hardware/modifications/#step-4-prepare-luckfox-lyra","title":"Step 4: Prepare Luckfox Lyra","text":"<p>Before installation:</p> <ol> <li>Erase SPI NAND (if your board has it) - see SPI NAND Erasing</li> <li>Flash Calculinux to your microSD card - see Installation Guide</li> <li>Insert the prepared microSD card into the Luckfox Lyra</li> </ol>"},{"location":"hardware/modifications/#step-5-install-luckfox-lyra","title":"Step 5: Install Luckfox Lyra","text":"<ol> <li>Position the Luckfox Lyra in the same orientation as the original RP2030</li> <li>Gently but firmly press the Lyra in to the socket</li> </ol>"},{"location":"hardware/modifications/#step-6-reassembly","title":"Step 6: Reassembly","text":"<ol> <li>Take care to ensure the board is properly aligned with all screw holes</li> <li>Ensure the kayboard rubber is in place</li> <li>Ensure the display is properly aligned with the case</li> <li>Align the case halves</li> <li>Replace all screws</li> <li>Verify nothing is binding or misaligned</li> </ol> <p>Risk to your Display!</p> <p>If the display is misaligned when installed, it can crack when you tighten the screws. make sure it is perfectly aligned with the front case!</p> <p>Keeping the screen aligned</p> <p>You may want to tape the screen in place using kapton tape or similar. this will prevent it from moving around as you open and close the picocalc in the future.</p>"},{"location":"hardware/modifications/#erasing-spi-nand","title":"Erasing SPI NAND","text":"<p>If your Luckfox Lyra has SPI NAND flash, you must erase it for the board to boot from SD card.</p>"},{"location":"hardware/modifications/#method-1-using-luckfox-tools","title":"Method 1: Using Luckfox Tools","text":"<ol> <li>Download Luckfox SDK and tools from GitHub</li> <li>Connect Luckfox Lyra via USB while holding boot button</li> <li>Use <code>upgrade_tool</code> to erase NAND:    <pre><code>upgrade_tool ef\n</code></pre></li> <li>Wait for confirmation message</li> <li>Disconnect and reconnect power</li> </ol>"},{"location":"hardware/modifications/#method-2-using-u-boot","title":"Method 2: Using U-Boot","text":"<p>If you can boot to U-Boot prompt:</p> <pre><code># Erase entire NAND\nnand erase.chip\n\n# Or erase specific partition\nsf probe 0\nsf erase 0 0x1000000\n</code></pre>"},{"location":"hardware/modifications/#method-3-from-running-system","title":"Method 3: From Running System","text":"<p>If you have a working Linux system on the board:</p> <pre><code># Identify NAND device\ncat /proc/mtd\n\n# Erase NAND (assuming mtd0)\nflash_erase /dev/mtd0 0 0\n</code></pre> <p>One-Time Operation</p> <p>You only need to erase the NAND once. After erasing, the board will always boot from SD card (unless you reprogram the NAND).</p>"},{"location":"hardware/modifications/#pin-mapping","title":"Pin Mapping","text":"<p>TODO: insert information about pin mapping</p> <p>GPIO Voltage Levels</p> <ul> <li>RMIO pins: 3.3V operation</li> <li>GPIO4_B3/GPIO4_B2: 1.8V operation (not RMIO-capable)</li> <li>Always verify voltage levels before hardware modifications</li> </ul> <p>Hardware PWM Limitation</p> <p>Some GPIO pins (like GPIO4_B3 and GPIO4_B2) cannot output hardware PWM as they are not RMIO-capable. For audio modifications, use RMIO pins that support hardware PWM.  A future page needs to be written detailing this.</p>"},{"location":"hardware/modifications/#power","title":"Power","text":"<ul> <li>5V In: From USB-C connector via PicoCalc board (to charge the batteries)</li> <li>3.3V Regulation: On Luckfox Lyra board</li> <li>Current Draw: TODO</li> </ul>"},{"location":"hardware/modifications/#verification","title":"Verification","text":"<p>After installation:</p> <ol> <li>Visual Check: Ensure board is seated properly</li> <li>Power On: Connect USB-C power</li> <li>Boot Check: Look for display activity</li> <li>LED Indicators: Observe any status LEDs on Luckfox board</li> </ol> <p>If the system doesn't boot, see Boot Problems.</p>"},{"location":"hardware/modifications/#common-issues","title":"Common Issues","text":""},{"location":"hardware/modifications/#board-wont-boot","title":"Board Won't Boot","text":"<ul> <li>SPI NAND not erased: Most common issue with NAND versions</li> <li>SD card not flashed correctly: Verify image integrity</li> <li>Power insufficient: Try different USB cable/adapter or replace the batteries</li> </ul>"},{"location":"hardware/modifications/#display-not-working","title":"Display Not Working","text":"<ul> <li>Driver not loaded: Check kernel logs via the serial terminal on the picocalc USB-C connector</li> <li>Connection issue: Reseat display cable</li> <li>Wrong device tree: Verify correct DTB is loaded</li> </ul>"},{"location":"hardware/modifications/#keyboard-not-responsive","title":"Keyboard Not Responsive","text":"<ul> <li>Driver not loaded: Check kernel logs</li> <li>GPIO mapping wrong: Verify device tree configuration</li> </ul>"},{"location":"hardware/modifications/#safety-considerations","title":"Safety Considerations","text":""},{"location":"hardware/modifications/#electrical-safety","title":"Electrical Safety","text":"<ul> <li>Work on ESD-safe surface</li> <li>Avoid static discharge to components</li> <li>Never work on powered device</li> <li>Check for shorts before powering on</li> </ul>"},{"location":"hardware/modifications/#mechanical-safety","title":"Mechanical Safety","text":"<ul> <li>Don't force connectors</li> <li>Handle PCBs by edges</li> <li>Watch for sharp edges</li> </ul>"},{"location":"hardware/modifications/#reverting-to-original","title":"Reverting to Original","text":"<p>To restore the original RP2040 board:</p> <ol> <li>Follow disassembly steps above</li> <li>Remove Luckfox Lyra</li> <li>Reinstall original board in reverse order</li> <li>Reflash original firmware if needed</li> </ol> <p>Keep Original Board</p> <p>Store the original RP2040 board safely in case you want to revert or use it elsewhere.</p>"},{"location":"hardware/modifications/#advanced-modifications","title":"Advanced Modifications","text":""},{"location":"hardware/modifications/#optional-enhancements","title":"Optional Enhancements","text":"<p>(TODO: add articles detailing these modifications)</p> <ul> <li>Hardware PWM Mod</li> <li>Add a WiFi Module</li> <li>Flash customized firmware to the STM32 southbridge chip</li> </ul>"},{"location":"hardware/modifications/#future-compatibility","title":"Future Compatibility","text":"<p>The modification process should be similar for other SBCs:</p> <ul> <li>Milk-V Duo (future support)</li> <li>Custom carrier boards</li> </ul>"},{"location":"hardware/modifications/#resources","title":"Resources","text":"<ul> <li>Video Guide: YouTube - Luckfox Lyra on PicoCalc</li> <li>Forum Discussion: ClockworkPi Forum Thread</li> <li>Image Files: Check forum thread for community-shared modifications</li> </ul>"},{"location":"hardware/modifications/#next-steps","title":"Next Steps","text":"<p>After successful installation:</p> <ul> <li>Follow First Boot guide</li> <li>Configure system per Configuration Guide</li> <li>Explore User Guide</li> </ul>"},{"location":"hardware/picocalc/","title":"PicoCalc Overview","text":"<p>The PicoCalc is a pocket-sized handheld computing device created by ClockworkPi that features a modular design allowing for different computing modules.</p>"},{"location":"hardware/picocalc/#what-is-picocalc","title":"What is PicoCalc?","text":"<p>PicoCalc is a unique handheld device that combines:</p> <ul> <li>A physical keyboard layout</li> <li>A built-in display</li> <li>A modular SBC (Single Board Computer) slot</li> <li>USB-C connectivity</li> <li>Battery power capability</li> </ul> <p>About the Name</p> <p>The \"PicoCalc\" name suggests its intended purpose for calculation and computation work, though it's primarily a clever branding choice rather than a literal description. The device is roughly the size of a large calculator but is designed as a general-purpose pocket computing platform.</p>"},{"location":"hardware/picocalc/#original-hardware","title":"Original Hardware","text":"<p>The PicoCalc originally ships with a Raspberry Pi Pico or RP2040-based microcontroller running PicoMite MMBasic. While functional for programming tasks and computation, replacing this with a more powerful SBC unlocks the device's full potential as a pocket Linux computer.</p>"},{"location":"hardware/picocalc/#why-replace-the-sbc","title":"Why Replace the SBC?","text":"<p>Upgrading from the stock microcontroller to an SBC like the Luckfox Lyra provides:</p> <ul> <li>Full Linux OS instead of PicoMite MMBasic</li> <li>Significantly more processing power</li> <li>More RAM (128MB vs. 264KB)</li> <li>Network connectivity options</li> <li>Storage expansion via multiple SD cards</li> <li>Rich software ecosystem</li> </ul>"},{"location":"hardware/picocalc/#physical-specifications","title":"Physical Specifications","text":"<p>For detailed technical specifications including display, keyboard, power, and interface details, see the Hardware Specifications page.</p> <p>Quick Overview: - Pocket-sized handheld computer form factor - 320\u00d7320 pixel LCD display with ILI9488 controller - Full physical keyboard with compact layout - Two USB-C ports (PicoCalc port and Lyra port with different functions) - Internal rechargeable battery - Modular SBC design</p> <p>Hardware Modification Required</p> <p>Installing a Luckfox Lyra or similar SBC requires opening the PicoCalc case and replacing the original board. This process involves careful handling of the internal connector and components. See Hardware Modifications for detailed instructions.</p> <p>Screen Damage Risk</p> <p>Some people have broken their screens while disassembling and reassembling the PicoCalc. Taping the screen in place from behind when placing it in the front bezel is recommended!</p>"},{"location":"hardware/picocalc/#technical-details","title":"Technical Details","text":"<p>For complete technical specifications including: - Display system (ILI9488 controller, SPI interface, refresh rates) - Keyboard system (STM32 MCU, I2C communication) - USB-C ports (two ports with different functions) - Power system (battery specs, consumption data) - Storage options (internal and expansion SD cards)</p> <p>See the Hardware Specifications page.</p>"},{"location":"hardware/picocalc/#compatibility","title":"Compatibility","text":"<p>The PicoCalc's modular design potentially supports various SBCs with the right adapters and modifications:</p> <ul> <li>\u2705 Luckfox Lyra - Fully supported by Calculinux</li> <li>\ud83d\udea7 Milk-V Duo - Future support planned</li> <li>\u2753 Other SBCs - Community experimentation ongoing</li> </ul> <p>See the Compatibility Matrix for detailed information.</p>"},{"location":"hardware/picocalc/#resources","title":"Resources","text":"<ul> <li>Official Product Page: ClockworkPi PicoCalc</li> <li>Community Forum: PicoCalc Category</li> <li>Hardware Discussion: Forum Thread</li> </ul>"},{"location":"hardware/picocalc/#next-steps","title":"Next Steps","text":"<ul> <li>Review Hardware Specifications for complete technical details</li> <li>Learn about the Luckfox Lyra SBC</li> <li>Check Hardware Modifications installation guide</li> <li>See Display &amp; Input for driver implementation details</li> <li>Review Hardware Compatibility for supported hardware</li> </ul>"},{"location":"hardware/power/","title":"Power Management","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for power management information.</p>"},{"location":"hardware/power/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Hardware Specifications - Power specifications</li> <li>PicoCalc Overview - Hardware overview</li> </ul>"},{"location":"hardware/power/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Power consumption specifications</li> <li>Battery management</li> <li>Power states</li> <li>Charging behavior</li> <li>Power optimization</li> <li>Troubleshooting power issues</li> </ul> <p>Content planned for future release</p>"},{"location":"hardware/specifications/","title":"Hardware Specifications","text":"<p>This page provides comprehensive technical specifications for all hardware components supported by Calculinux.</p>"},{"location":"hardware/specifications/#picocalc-hardware","title":"PicoCalc Hardware","text":""},{"location":"hardware/specifications/#physical-specifications","title":"Physical Specifications","text":"Specification Details Form Factor Pocket-sized handheld computer Display Built-in 320\u00d7320 LCD screen Input Full physical keyboard with compact layout Power USB-C port for charging, internal rechargeable battery Module Interface Custom connector for SBC modules"},{"location":"hardware/specifications/#display-system","title":"Display System","text":"Specification Details Interface SPI (Serial Peripheral Interface) Controller ILI9488 Resolution 320\u00d7320 pixels Text Mode 53 columns \u00d7 40 rows (6\u00d78 font) Color Depth 16-bit RGB565 Refresh Rate ~30 FPS target (60Hz capable) SPI Speed 80 MHz (overclocked from 40 MHz standard) Backlight Controlled by STM32 MCU"},{"location":"hardware/specifications/#keyboard-system","title":"Keyboard System","text":"Specification Details Type Physical matrix keyboard MCU STM32F103R8T6 (keyboard controller/southbridge) Interface I2C to main SBC I2C Address 0x1F I2C Bus i2c2 at 400kHz Layout Compact layout with function keys Features Mouse mode (dual shift), MCU-based matrix scanning"},{"location":"hardware/specifications/#usb-c-ports","title":"USB-C Ports","text":"<p>The PicoCalc has TWO USB-C ports with different functions:</p> Port Function Notes PicoCalc USB-C Port Battery charging + Serial console Console at 1500000 baud, connects to Lyra UART Lyra USB-C Port USB-OTG data only Does NOT charge PicoCalc, requires 3.3V devices <p>Two Distinct USB-C Ports</p> <ul> <li>PicoCalc port: Accessible externally, charges battery, provides serial console access for debugging</li> <li>Lyra port: Internal (requires case opening), USB host/device functionality, 3.3V only</li> </ul>"},{"location":"hardware/specifications/#power-system","title":"Power System","text":"Specification Details Battery Internal rechargeable lithium-ion Charging Via PicoCalc USB-C port Input Voltage 5V Power Consumption (Idle) ~0.5-0.52W Power Consumption (Active) ~0.59-0.60W Power Consumption (WiFi) ~0.63-1.1W Battery Life 2-4 hours typical (varies by usage)"},{"location":"hardware/specifications/#storage","title":"Storage","text":"Type Location Notes Primary Storage MicroSD in Luckfox Lyra Main system storage Expansion Storage MicroSD in PicoCalc slot Additional storage via SPI (slower)"},{"location":"hardware/specifications/#luckfox-lyra-specifications","title":"Luckfox Lyra Specifications","text":""},{"location":"hardware/specifications/#processor","title":"Processor","text":"Component Specification SoC Rockchip RK3506G2 CPU Triple-core ARM Cortex-A7 @ 1.2GHz + ARM Cortex-M0 Architecture ARMv7-A (32-bit) NPU 0.5 TOPS AI accelerator"},{"location":"hardware/specifications/#memory-storage","title":"Memory &amp; Storage","text":"Component Supported Configurations RAM 128MB DDR2 (only tested configuration) Flash Storage Optional SPI NAND (128MB-1GB, must be erased for SD boot) External Storage MicroSD card slot (primary boot device) <p>RAM Configuration</p> <p>Only the 128MB RAM configuration has been tested with Calculinux. Other RAM variants (64MB, 256MB) exist but have different pinouts and would require custom adapter boards.</p>"},{"location":"hardware/specifications/#network-interfaces","title":"Network Interfaces","text":"Interface Availability Notes WiFi External USB adapter required See supported chipsets below Ethernet Lyra Plus model only 10/100 Mbps, untested with Calculinux Bluetooth Not supported No Bluetooth hardware"},{"location":"hardware/specifications/#expansion-interfaces","title":"Expansion Interfaces","text":"<p>All interfaces operate at 3.3V logic levels:</p> Interface Status Notes GPIO \u2705 Available External GPIO free (display/keyboard don't use) USB \u2705 Available Internal USB host/device, 3.3V only I2C \u2705 Available Multiple I2C buses I2S \u2753 Untested Audio interface available SPI \u2705 Available Shared with display UART \u2705 Available Serial communication MIPI DSI \ud83d\udea7 Possible For alternate displays (22-pin CM4 connector) <p>Critical: 3.3V Logic Levels</p> <p>ALL interfaces operate at 3.3V ONLY. Using 5V devices or signals will damage the hardware. Always verify voltage compatibility before connecting peripherals.</p>"},{"location":"hardware/specifications/#display-interface-details","title":"Display Interface Details","text":"Parameter Value SPI Bus spi0 SPI Mode 0 (CPOL=0, CPHA=0) Max Speed 80 MHz Chip Select GPIO0 RK_PA4 Data/Command GPIO0 RK_PA3 Reset GPIO0 RK_PA2"},{"location":"hardware/specifications/#keyboard-interface-details","title":"Keyboard Interface Details","text":"Parameter Value Interface I2C Bus i2c2 Address 0x1F Speed 400 kHz (Fast Mode) SCL Pin GPIO0 RK_PB2 SDA Pin GPIO0 RK_PB3"},{"location":"hardware/specifications/#supported-wifi-chipsets","title":"Supported WiFi Chipsets","text":"<p>The following USB WiFi adapters are supported (must operate at 3.3V):</p>"},{"location":"hardware/specifications/#enabled-in-current-kernel","title":"Enabled in Current Kernel","text":"<ul> <li>RTL8192CU - Realtek single-band USB adapter</li> <li>R8712U - Realtek single-band USB adapter</li> <li>R8188EU - Realtek single-band USB adapter</li> <li>RTL8723BS - Realtek dual-band (SDIO/USB)</li> </ul>"},{"location":"hardware/specifications/#requiring-kernel-configuration","title":"Requiring Kernel Configuration","text":"<p>The following chipsets have drivers available but are not currently enabled:</p> <ul> <li>RTL8723DU</li> <li>RTL8812AU</li> <li>RTL8814AU</li> <li>RTL8821CU</li> <li>RTL88X2BU</li> <li>RTL8188FU</li> <li>RTL8188FTV</li> <li>RT2800 series</li> <li>MT7612U</li> <li>MT7610U</li> <li>RT5370</li> </ul> <p>3.3V Requirement for WiFi</p> <p>USB WiFi adapters must operate at 3.3V as the Lyra's USB provides only 3.3V power. Standard 5V USB adapters will not work and may damage the board. Use an externally powered USB hub for 5V devices.</p>"},{"location":"hardware/specifications/#boot-priority","title":"Boot Priority","text":"<p>The RK3506G2 boot ROM follows this priority:</p> <ol> <li>SPI NAND (if present and programmed)</li> <li>SD Card (if SPI NAND is erased or absent)</li> <li>USB Boot (for recovery/programming)</li> </ol> <p>SPI NAND Boot Priority</p> <p>If your Luckfox Lyra has SPI NAND flash, you must erase it or the boot ROM will ignore the SD card. See the SPI NAND Erase Guide for detailed instructions.</p>"},{"location":"hardware/specifications/#luckfox-lyra-variants","title":"Luckfox Lyra Variants","text":"Model RAM Storage Ethernet Status with Calculinux Luckfox Lyra 128MB SD only No \u2705 Fully Supported Luckfox Lyra (SPI NAND) 128MB SPI NAND + SD No \u2705 Supported (NAND must be erased) Luckfox Lyra Plus 128MB SPI NAND + SD Yes (10/100) \u2753 Untested <p>Other Lyra Models</p> <p>Other Luckfox Lyra variants exist (64MB, 256MB RAM, different SoC models) but have different pinouts and are not compatible without custom adapter boards.</p>"},{"location":"hardware/specifications/#thermal-considerations","title":"Thermal Considerations","text":"Condition Details Normal Operation No heatsink required for typical console use Heavy Load Monitor temperatures during intensive tasks Enclosed Design PicoCalc case limits airflow, consider heat dissipation"},{"location":"hardware/specifications/#power-supply-requirements","title":"Power Supply Requirements","text":"Component Requirement Input Voltage 5V DC Minimum Current 2A Recommended 5V 2A or higher USB power supply Cable USB-C data-capable cable <p>Power Supply Recommendations</p> <ul> <li>Use a quality USB-C cable (not just charging cables)</li> <li>Ensure power supply can deliver stable 2A</li> <li>Under-voltage can cause system instability and boot failures</li> <li>Quality power supplies reduce risk of data corruption</li> </ul>"},{"location":"hardware/specifications/#console-display-specifications","title":"Console Display Specifications","text":"Parameter Value Physical Resolution 320\u00d7320 pixels Console Font 6\u00d78 pixels per character Text Area 53 columns \u00d7 40 rows Color Support 16-bit color (RGB565) Frame Rate 30 FPS target <p>Small Text Console</p> <p>The 53\u00d740 text area is smaller than standard terminals (typically 80\u00d724 or larger). Many applications may require:</p> <ul> <li>Horizontal scrolling for wide output</li> <li>Setting <code>COLUMNS=53 LINES=40</code> environment variables</li> <li>Using compact display modes when available</li> </ul>"},{"location":"hardware/specifications/#related-documentation","title":"Related Documentation","text":"<ul> <li>PicoCalc Overview - Device overview and design</li> <li>Luckfox Lyra - SDK, purchasing, software details</li> <li>Display &amp; Input - Driver implementation details</li> <li>Hardware Compatibility - Compatibility matrices</li> <li>Hardware Modifications - Installation and modification guides</li> </ul> <p>Note: This page is the canonical reference for all hardware specifications. Other pages should link here rather than duplicating these details.</p>"},{"location":"hardware/serial/console-access/","title":"Serial Console Access","text":"<p>A hardware serial console is the most reliable way to debug early boot issues or recover a system when network access is unavailable. The Picocalc exposes a USB-to-UART bridge that enumerates as <code>/dev/ttyUSB0</code> on most Linux hosts. The console runs at 1,500,000 baud, 8 data bits, no parity, and 1 stop bit (\"1500000 8N1\").</p>"},{"location":"hardware/serial/console-access/#prerequisites","title":"Prerequisites","text":"<ul> <li>Linux host with <code>python3-serial</code> (for <code>miniterm.py</code>) or <code>minicom</code>   installed.</li> <li>Access to <code>/dev/ttyUSB0</code>. If you are not root, add yourself to the   <code>dialout</code> (or distribution-specific) group and re-login:</li> </ul> <p>Info</p> <p>If you prefeer a GUI tool to access the serial port but don't know what to choose, options on Linux desktops include CuteCom, and PuTTY among  others; they provide point-and-click interfaces for selecting ports and baud rates. The only setting you will need to change is the 1,500,000 baud setting. </p> <pre><code>sudo usermod -a -G dialout \"$USER\"\n</code></pre> <ul> <li>USB-C cable connecting the host to the Picocalc usb-c port.</li> </ul>"},{"location":"hardware/serial/console-access/#verifying-the-device-node","title":"Verifying the device node","text":"<p>After connecting the board, confirm the kernel created the serial device:</p> <pre><code>ls /dev/ttyUSB*\n</code></pre> <p>You should see <code>/dev/ttyUSB0</code>. If the device is missing, check <code>dmesg</code> for driver errors or verify cabling. If you already have other serial  devices, it may have received a different number.</p>"},{"location":"hardware/serial/console-access/#using-minitermpy","title":"Using <code>miniterm.py</code>","text":"<p><code>miniterm.py</code> ships with the <code>pyserial</code> package and provides a simple serial terminal.</p> <ol> <li>Launch the terminal with the required baud rate:</li> </ol> <pre><code>python3 -m serial.tools.miniterm /dev/ttyUSB0 1500000\n</code></pre> <ol> <li>Interact with the console directly in the terminal window.</li> <li>Use <code>Ctrl+]</code> to open the miniterm command menu. From there you can    toggle local echo (<code>e</code>), change settings, or quit (<code>q</code>).</li> <li>Exit with <code>Ctrl+]</code> followed by <code>q</code>.</li> </ol> <p>Optional flags:</p> <ul> <li><code>--raw</code> disables line ending translations.</li> <li><code>--write-log session.log</code> records all serial traffic to a file.</li> </ul>"},{"location":"hardware/serial/console-access/#using-minicom","title":"Using <code>minicom</code>","text":"<p><code>minicom</code> is a curses-based serial terminal that can persist configuration between sessions.</p> <ol> <li>Run the setup menu once to create a default profile:</li> </ol> <pre><code>sudo minicom -s\n</code></pre> <ol> <li>In Serial port setup:</li> <li>Set Serial device to <code>/dev/ttyUSB0</code>.</li> <li>Set Bps/Par/Bits to <code>1500000 8N1</code>.</li> <li> <p>Disable both hardware (<code>RTS/CTS</code>) and software (<code>XON/XOFF</code>) flow      control unless your setup requires them.</p> </li> <li> <p>Choose Save setup as dfl so future invocations reuse these    settings, then Exit the configuration menu.</p> </li> <li> <p>Start minicom normally:</p> </li> </ol> <pre><code>minicom\n</code></pre> <p>Key shortcuts while running:</p> <ul> <li><code>Ctrl+A</code> then <code>Z</code>: help and command summary.</li> <li><code>Ctrl+A</code> then <code>O</code>: reopen the setup menu.</li> <li><code>Ctrl+A</code> then <code>W</code>: toggle logging to the file defined in the   configuration.</li> <li><code>Ctrl+A</code> then <code>X</code>: exit minicom.</li> </ul>"},{"location":"hardware/serial/console-access/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Permission denied: ensure your user is in the correct group or run   minicom with <code>sudo</code>. Avoid running graphical terminals as root for   security reasons.</li> <li>Garbled output: double-check the baud rate (must be 1,500,000) and   make sure only one terminal program is connected to the port.</li> <li>No output: confirm the board is powered and the USB-to-UART bridge   is enumerated by the host (<code>dmesg | tail</code>).</li> </ul> <p>With the correct baud rate and settings, the serial console provides boot logs, kernel messages, and a root shell even before networking is available.</p> <p>Because this uses a hardware serial port, it will work even if no picocalc specific drivers are loaded.</p>"},{"location":"resources/community/","title":"Community &amp; Support","text":"<p>Connect with the Calculinux community and get support.</p>"},{"location":"resources/community/#official-channels","title":"Official Channels","text":""},{"location":"resources/community/#discord-community","title":"Discord Community","text":"<p>Join our active Discord community for real-time chat and support:</p> <p>Calculinux Discord Server - URL: discord.gg/7quBbSPxcP - Purpose: Real-time community discussion, help, and project sharing - Channels: General discussion, help &amp; support, development, hardware, showcase - Active community with quick responses from developers and users</p>"},{"location":"resources/community/#forum","title":"Forum","text":"<p>The primary discussion platform for Calculinux and PicoCalc modifications:</p> <p>ClockworkPi Forum - Luckfox Lyra Thread - URL: forum.clockworkpi.com/t/luckfox-lyra-on-picocalc/16280 - Purpose: General discussion, questions, showcase projects - Activity: Active community, quick responses - Original port discussion and ongoing development</p>"},{"location":"resources/community/#github","title":"GitHub","text":"<p>Source Code &amp; Issues - Repository: github.com/Calculinux/meta-calculinux - Issues: Bug reports and feature requests - Pull Requests: Code contributions - Discussions: Development planning</p> <p>Documentation - Repository: github.com/Calculinux/docs - Issues: Documentation improvements - Website: calculinux.github.io/docs</p>"},{"location":"resources/community/#community-guidelines","title":"Community Guidelines","text":""},{"location":"resources/community/#be-respectful","title":"Be Respectful","text":"<ul> <li>Treat all community members with respect</li> <li>Be patient with beginners</li> <li>Provide constructive feedback</li> <li>Help others when you can</li> </ul>"},{"location":"resources/community/#stay-on-topic","title":"Stay On Topic","text":"<ul> <li>Keep discussions relevant to Calculinux/PicoCalc</li> <li>Use appropriate channels for different topics</li> <li>Search before posting duplicates</li> </ul>"},{"location":"resources/community/#share-knowledge","title":"Share Knowledge","text":"<ul> <li>Document your solutions</li> <li>Share your projects</li> <li>Contribute improvements</li> <li>Help maintain documentation</li> </ul>"},{"location":"resources/community/#getting-help","title":"Getting Help","text":""},{"location":"resources/community/#before-asking","title":"Before Asking","text":"<ol> <li>Check Documentation: Read relevant sections</li> <li>Search Forum: Someone may have had the same issue</li> <li>Check Issues: Look for existing GitHub issues</li> <li>Try Troubleshooting: Follow troubleshooting guides</li> </ol>"},{"location":"resources/community/#how-to-ask","title":"How to Ask","text":"<p>Good Question Format:</p> <pre><code>Subject: Clear, specific title\n\nHardware:\n- Luckfox Lyra 128MB (no NAND)\n- SanDisk 16GB SD card\n- 5V/2A USB-C power\n\nSoftware:\n- Calculinux base image v1.0\n\nProblem:\n[Clear description of issue]\n\nWhat I've Tried:\n1. Step one\n2. Step two\n\nError Messages:\n[Paste relevant error messages]\n\nLogs:\n[Relevant portions of dmesg or journalctl]\n</code></pre>"},{"location":"resources/community/#what-to-include","title":"What to Include","text":"<ul> <li>Hardware specifications</li> <li>Software version</li> <li>Exact error messages</li> <li>Steps to reproduce</li> <li>What you've already tried</li> <li>Relevant log excerpts</li> </ul>"},{"location":"resources/community/#contributing","title":"Contributing","text":""},{"location":"resources/community/#ways-to-contribute","title":"Ways to Contribute","text":"<p>Code Contributions - Bug fixes - New features - Driver improvements - See Contributing Guide</p> <p>Documentation - Fix typos and errors - Add missing information - Create tutorials - Translate to other languages</p> <p>Testing - Test on different hardware - Report compatibility - Verify bug fixes - Test new features</p> <p>Community Support - Answer questions on forum - Help troubleshoot issues - Share your projects - Write blog posts/tutorials</p>"},{"location":"resources/community/#project-maintainers","title":"Project Maintainers","text":""},{"location":"resources/community/#core-team","title":"Core Team","text":"<ul> <li>hisptoot - Original port and driver development</li> <li>Community contributors - Various improvements</li> </ul> <p>Want to become a maintainer? Contribute regularly and show your commitment!</p>"},{"location":"resources/community/#related-communities","title":"Related Communities","text":""},{"location":"resources/community/#clockworkpi","title":"ClockworkPi","text":"<ul> <li>Main Forum: forum.clockworkpi.com</li> <li>Other Projects: GameShell, DevTerm, uConsole</li> <li>General Hardware: Discussions about ClockworkPi devices</li> </ul>"},{"location":"resources/community/#luckfox","title":"Luckfox","text":"<ul> <li>Official Site: luckfox.com</li> <li>GitHub: github.com/LuckfoxTECH</li> <li>Community: Luckfox user communities</li> </ul>"},{"location":"resources/community/#embedded-linux","title":"Embedded Linux","text":"<ul> <li>eLinux.org: elinux.org</li> <li>Yocto Community: yoctoproject.org/community</li> <li>Reddit /r/embedded: reddit.com/r/embedded</li> </ul>"},{"location":"resources/community/#events-meetings","title":"Events &amp; Meetings","text":""},{"location":"resources/community/#community-calls","title":"Community Calls","text":"<p>(To be organized as community grows)</p> <ul> <li>Monthly developer calls</li> <li>Release planning meetings</li> <li>Community showcases</li> </ul>"},{"location":"resources/community/#conferences","title":"Conferences","text":"<p>Relevant conferences where Calculinux might be presented:</p> <ul> <li>Embedded Linux Conference</li> <li>FOSDEM</li> <li>Maker Faires</li> <li>Local Linux User Groups</li> </ul>"},{"location":"resources/community/#social-media","title":"Social Media","text":"<p>Stay updated on Calculinux development:</p> <ul> <li>Check forum for announcements</li> <li>Watch GitHub repository</li> <li>Follow related projects</li> </ul>"},{"location":"resources/community/#recognition","title":"Recognition","text":""},{"location":"resources/community/#hall-of-fame","title":"Hall of Fame","text":"<p>Recognition for significant contributors:</p> <ul> <li>hisptoot - Original Luckfox Lyra port, LCD driver, keyboard driver</li> <li>Contributors welcome! Your name could be here.</li> </ul>"},{"location":"resources/community/#showcase","title":"Showcase","text":"<p>Share your Calculinux projects:</p> <ul> <li>Post in forum with \"Showcase\" tag</li> <li>Include photos/videos</li> <li>Describe your use case</li> <li>Share your code if open source</li> </ul>"},{"location":"resources/community/#resources-for-contributors","title":"Resources for Contributors","text":""},{"location":"resources/community/#development-resources","title":"Development Resources","text":"<ul> <li>Developer Guide</li> <li>Contributing Guidelines</li> <li>Yocto Documentation</li> </ul>"},{"location":"resources/community/#communication-resources","title":"Communication Resources","text":"<ul> <li>Forum etiquette</li> <li>GitHub pull request guidelines</li> <li>Code of conduct (in development)</li> </ul>"},{"location":"resources/community/#contact","title":"Contact","text":""},{"location":"resources/community/#public-contact","title":"Public Contact","text":"<ul> <li>Forum: Best for general questions</li> <li>GitHub Issues: For bugs and features</li> <li>GitHub Discussions: For development topics</li> </ul>"},{"location":"resources/community/#private-contact","title":"Private Contact","text":"<p>For sensitive issues (security vulnerabilities, etc.):</p> <ul> <li>Open a security issue on GitHub</li> <li>Contact maintainers directly (info in GitHub profiles)</li> </ul>"},{"location":"resources/community/#license-legal","title":"License &amp; Legal","text":"<ul> <li>Code: Various open source licenses (see individual repositories)</li> <li>Documentation: CC BY 4.0</li> <li>Trademarks: Respect all trademarks</li> </ul>"},{"location":"resources/community/#code-of-conduct","title":"Code of Conduct","text":""},{"location":"resources/community/#summary","title":"Summary","text":"<ul> <li>Be kind and courteous</li> <li>Respect different viewpoints</li> <li>Accept constructive criticism</li> <li>Focus on what's best for the community</li> <li>Show empathy toward other members</li> </ul> <p>Full code of conduct: (To be added)</p>"},{"location":"resources/community/#supporting-the-project","title":"Supporting the Project","text":""},{"location":"resources/community/#non-code-contributions","title":"Non-Code Contributions","text":"<ul> <li>Write documentation</li> <li>Create tutorials</li> <li>Test and report bugs</li> <li>Help others in forum</li> <li>Spread the word</li> </ul>"},{"location":"resources/community/#sponsorship","title":"Sponsorship","text":"<p>(To be determined as project matures)</p> <ul> <li>Infrastructure costs</li> <li>Development hardware</li> <li>Community initiatives</li> </ul>"},{"location":"resources/community/#stay-connected","title":"Stay Connected","text":"<p>Don't be a stranger! The Calculinux community is friendly and welcoming.</p> <ul> <li>\ud83d\udcac Discord: Join our Discord community</li> <li>\ud83d\udcac Forum: Join the forum discussion</li> <li>\u2b50 GitHub: Star the GitHub repository  </li> <li>\ud83d\udce2 Projects: Share your projects</li> <li>\ud83e\udd1d Help: Help fellow users</li> <li>\ud83d\udcbb Contribute: Contribute code or documentation</li> </ul> <p>Welcome to the Calculinux community! \ud83c\udf89</p>"},{"location":"resources/external-docs/","title":"External Documentation &amp; Resources","text":"<p>This page provides links to external documentation, resources, and references that are helpful for working with Calculinux, the PicoCalc, and related technologies.</p>"},{"location":"resources/external-docs/#official-project-resources","title":"Official Project Resources","text":""},{"location":"resources/external-docs/#calculinux","title":"Calculinux","text":"Resource URL Description Main Repository github.com/Calculinux/meta-calculinux Yocto layer and build system Documentation github.com/Calculinux/docs This documentation source Meta Layer github.com/Calculinux/meta-calculinux Main Yocto meta-layer"},{"location":"resources/external-docs/#clockworkpi-picocalc","title":"ClockworkPi / PicoCalc","text":"Resource URL Description Official Website clockworkpi.com Manufacturer website PicoCalc Forum forum.clockworkpi.com/c/picocalc/31 Official forum category Luckfox Thread forum thread Original port discussion"},{"location":"resources/external-docs/#luckfox","title":"Luckfox","text":"Resource URL Description Official Website luckfox.com Manufacturer website Pico SDK github.com/LuckfoxTECH/luckfox-pico Official SDK (Buildroot) Wiki wiki.luckfox.com Documentation"},{"location":"resources/external-docs/#build-system-documentation","title":"Build System Documentation","text":""},{"location":"resources/external-docs/#yocto-project","title":"Yocto Project","text":"Resource URL Description Main Website yoctoproject.org Official Yocto site Documentation docs.yoctoproject.org Complete documentation Quick Start Quick Build Guide Getting started Mega-Manual Mega-Manual All-in-one reference Dev Manual Developer Manual Development guide Kernel Manual Kernel Dev Manual Kernel development Board Support BSP Guide BSP creation"},{"location":"resources/external-docs/#openembedded","title":"OpenEmbedded","text":"Resource URL Description Main Website openembedded.org Project homepage Layer Index layers.openembedded.org Find layers/recipes User Manual OE User Manual Usage guide"},{"location":"resources/external-docs/#bitbake","title":"BitBake","text":"Resource URL Description Documentation BitBake Manual Build engine docs Syntax Reference Syntax Guide Recipe syntax"},{"location":"resources/external-docs/#hardware-documentation","title":"Hardware Documentation","text":""},{"location":"resources/external-docs/#rockchip-rv1106","title":"Rockchip RV1106","text":"Resource URL Description SDK github.com/rockchip-linux Rockchip Linux repos Kernel Rockchip Kernel Kernel source Documentation Rockchip Wiki Chip documentation (when available)"},{"location":"resources/external-docs/#arm-cortex-a7","title":"ARM Cortex-A7","text":"Resource URL Description ARM Developer developer.arm.com Processor documentation Technical Manual ARM Documentation TRM"},{"location":"resources/external-docs/#linux-kernel-resources","title":"Linux Kernel Resources","text":""},{"location":"resources/external-docs/#general-linux-development","title":"General Linux Development","text":"Resource URL Description Kernel.org kernel.org Official kernel source Documentation kernel.org/doc Kernel documentation Device Tree devicetree.org DT specification Linux Driver Project ldp.net Driver development"},{"location":"resources/external-docs/#arm-linux","title":"ARM Linux","text":"Resource URL Description ARM Linux arm.linux.org.uk ARM-specific info Device Tree Guide DT for ARM ARM DT bindings"},{"location":"resources/external-docs/#display-input","title":"Display &amp; Input","text":""},{"location":"resources/external-docs/#spi-lcd-st7789","title":"SPI LCD (ST7789)","text":"Resource URL Description Datasheet ST7789V Datasheet Display controller specs Linux Driver fbtft Framebuffer drivers Documentation Kernel fbdev Framebuffer docs"},{"location":"resources/external-docs/#input-subsystem","title":"Input Subsystem","text":"Resource URL Description Input Docs Kernel Input Input subsystem Event Codes input-event-codes.h Key definitions"},{"location":"resources/external-docs/#development-tools","title":"Development Tools","text":""},{"location":"resources/external-docs/#cross-compilation","title":"Cross-Compilation","text":"Resource URL Description Crosstool-NG crosstool-ng.github.io Toolchain builder ARM Toolchains ARM GNU Official toolchains"},{"location":"resources/external-docs/#debugging","title":"Debugging","text":"Resource URL Description GDB gnu.org/software/gdb GNU debugger OpenOCD openocd.org On-chip debugging JTAG Info Various Hardware debugging"},{"location":"resources/external-docs/#version-control","title":"Version Control","text":"Resource URL Description Git git-scm.com Version control Git Book Git Pro Book Comprehensive guide"},{"location":"resources/external-docs/#linux-distribution-resources","title":"Linux Distribution Resources","text":""},{"location":"resources/external-docs/#package-management","title":"Package Management","text":"Resource URL Description opkg opkg docs Package manager Package Feeds Configured in Calculinux Software repositories"},{"location":"resources/external-docs/#system-management","title":"System Management","text":"Resource URL Description systemd systemd.io Init system systemd Docs freedesktop.org Complete manual"},{"location":"resources/external-docs/#desktop-environments","title":"Desktop Environments","text":"<p>Future Feature</p> <p>Desktop environments are not currently implemented in Calculinux. These resources are provided for future reference if GUI support is added.</p>"},{"location":"resources/external-docs/#lightweight-options","title":"Lightweight Options","text":"Resource URL Description LXDE lxde.org Lightweight desktop XFCE xfce.org Feature-rich lightweight i3 i3wm.org Tiling window manager Openbox openbox.org Minimal WM"},{"location":"resources/external-docs/#display-servers","title":"Display Servers","text":"Resource URL Description X.Org x.org X11 server Wayland wayland.freedesktop.org Modern display protocol"},{"location":"resources/external-docs/#programming-languages","title":"Programming Languages","text":""},{"location":"resources/external-docs/#cc","title":"C/C++","text":"Resource URL Description GCC gcc.gnu.org GNU compiler C++ Reference cppreference.com Language reference"},{"location":"resources/external-docs/#python","title":"Python","text":"Resource URL Description Python.org python.org Official Python PyPI pypi.org Package index"},{"location":"resources/external-docs/#shell-scripting","title":"Shell Scripting","text":"Resource URL Description Bash Guide gnu.org/software/bash Bash manual ShellCheck shellcheck.net Script analysis"},{"location":"resources/external-docs/#community-learning","title":"Community &amp; Learning","text":""},{"location":"resources/external-docs/#forums-discussion","title":"Forums &amp; Discussion","text":"Resource URL Description ClockworkPi Forum forum.clockworkpi.com Official forums Yocto Mailing Lists yoctoproject.org/community Yocto community Stack Overflow stackoverflow.com Q&amp;A site Reddit /r/embedded reddit.com/r/embedded Embedded Linux"},{"location":"resources/external-docs/#learning-resources","title":"Learning Resources","text":"Resource URL Description Linux From Scratch linuxfromscratch.org Build Linux from source Embedded Linux Wiki elinux.org Embedded Linux info Free Electrons bootlin.com Training materials"},{"location":"resources/external-docs/#video-tutorials","title":"Video Tutorials","text":"Resource URL Description YouTube Search \"Yocto Project Tutorial\" Video tutorials YouTube Search \"Embedded Linux\" General embedded info Original Video Luckfox on PicoCalc Hardware demo"},{"location":"resources/external-docs/#datasheets-specifications","title":"Datasheets &amp; Specifications","text":""},{"location":"resources/external-docs/#obtaining-datasheets","title":"Obtaining Datasheets","text":"<p>Many datasheets require registration or NDA:</p> <ul> <li>Rockchip: Contact for RV1106 documentation</li> <li>LCD Controllers: Search by part number</li> <li>Component Vendors: Check manufacturer websites</li> </ul>"},{"location":"resources/external-docs/#useful-specifications","title":"Useful Specifications","text":"Specification Description SPI Serial Peripheral Interface standard I2C Inter-Integrated Circuit bus USB 2.0 USB specification MIPI CSI Camera Serial Interface"},{"location":"resources/external-docs/#related-projects","title":"Related Projects","text":""},{"location":"resources/external-docs/#similar-devices","title":"Similar Devices","text":"Project URL Description PocketCHIP Archived Similar pocket computer GameShell ClockworkPi Gaming handheld DevTerm ClockworkPi Portable terminal"},{"location":"resources/external-docs/#embedded-linux-distributions","title":"Embedded Linux Distributions","text":"Distribution URL Focus Buildroot buildroot.org Lightweight builds OpenWrt openwrt.org Router focus Raspberry Pi OS raspberrypi.com RPi optimized"},{"location":"resources/external-docs/#books","title":"Books","text":""},{"location":"resources/external-docs/#recommended-reading","title":"Recommended Reading","text":"<p>Embedded Linux: - \"Mastering Embedded Linux Programming\" - Chris Simmonds - \"Embedded Linux Primer\" - Christopher Hallinan - \"Building Embedded Linux Systems\" - Karim Yaghmour</p> <p>Yocto/OpenEmbedded: - \"Embedded Linux Development Using Yocto Project\" - Otavio Salvador - \"Yocto for Raspberry Pi\" - Pierre-Jean Texier</p> <p>Kernel Development: - \"Linux Device Drivers\" - Corbet, Rubini, Kroah-Hartman - \"Linux Kernel Development\" - Robert Love</p> <p>General Linux: - \"The Linux Command Line\" - William Shotts - \"How Linux Works\" - Brian Ward</p>"},{"location":"resources/external-docs/#online-courses","title":"Online Courses","text":""},{"location":"resources/external-docs/#free-courses","title":"Free Courses","text":"<ul> <li>Yocto Project Training (bootlin.com)</li> <li>Embedded Linux Courses (various MOOCs)</li> <li>ARM University Program (free materials)</li> </ul>"},{"location":"resources/external-docs/#paid-courses","title":"Paid Courses","text":"<ul> <li>Linux Foundation courses</li> <li>Udemy embedded Linux courses</li> <li>Professional training companies</li> </ul>"},{"location":"resources/external-docs/#tools-utilities","title":"Tools &amp; Utilities","text":""},{"location":"resources/external-docs/#online-tools","title":"Online Tools","text":"Tool URL Purpose Device Tree Compiler devicetree.org DT compilation Regex Tester regex101.com Pattern testing Color Picker Various GUI development"},{"location":"resources/external-docs/#software-tools","title":"Software Tools","text":"<ul> <li>Etcher: balena.io/etcher - Image flashing</li> <li>PuTTY: putty.org - Serial terminal</li> <li>VS Code: code.visualstudio.com - Editor</li> </ul>"},{"location":"resources/external-docs/#standards-specifications","title":"Standards &amp; Specifications","text":"Standard Organization Relevance POSIX IEEE Unix standards FHS Linux Foundation Filesystem hierarchy LSB Linux Foundation Linux standards"},{"location":"resources/external-docs/#contributing-resources","title":"Contributing Resources","text":"<p>See Contributing Guide for Calculinux-specific guidelines.</p>"},{"location":"resources/external-docs/#general-open-source","title":"General Open Source","text":"Resource URL Description Open Source Guide opensource.guide Contributing basics How to Contribute GitHub guides PR workflow Code of Conduct Various Community standards"},{"location":"resources/external-docs/#stay-updated","title":"Stay Updated","text":""},{"location":"resources/external-docs/#news-sources","title":"News Sources","text":"<ul> <li>Phoronix - Linux hardware news</li> <li>LWN.net - Linux Weekly News  </li> <li>Hacker News - Tech discussions</li> <li>r/linux - Linux subreddit</li> </ul>"},{"location":"resources/external-docs/#blogs","title":"Blogs","text":"<ul> <li>Yocto Project Blog</li> <li>ClockworkPi Blog</li> <li>Embedded Linux blogs (various)</li> </ul>"},{"location":"resources/external-docs/#need-more-help","title":"Need More Help?","text":"<p>Can't find what you're looking for?</p> <ol> <li>Check our Troubleshooting section</li> <li>Search the Forum</li> <li>Ask in Community Chat</li> <li>Open a Documentation Issue</li> </ol>"},{"location":"resources/external-docs/#contributing-to-this-list","title":"Contributing to This List","text":"<p>Found a useful resource not listed here?</p> <ul> <li>Submit a pull request to add it</li> <li>Open an issue with the suggestion</li> <li>Post in the forum</li> </ul> <p>Last updated: October 2025</p>"},{"location":"troubleshooting/boot-problems/","title":"Boot Problems","text":"<p>Detailed troubleshooting for boot-related issues.</p>"},{"location":"troubleshooting/boot-problems/#system-wont-boot","title":"System Won't Boot","text":"<p>This section will be populated with detailed boot troubleshooting steps.</p>"},{"location":"troubleshooting/boot-problems/#spi-nand-interference","title":"SPI NAND Interference","text":"<p>Some Luckfox Lyra boards include SPI NAND flash memory. The RK3506G2 boot ROM always tries NAND first, so if your board has NAND with any firmware on it, the boot ROM will ignore your SD card completely.</p> <p>Quick Check: - Lyra models with \"SPI NAND\" or \"Lyra B\" or \"Lyra Plus\" have NAND - Check your purchase specifications - If unsure, try booting - if SD card is ignored, you likely have NAND</p> <p>Solution: You must erase the SPI NAND flash. See the comprehensive SPI NAND Erase Guide for detailed step-by-step instructions covering:</p> <ul> <li>Windows method (RKDevTool)</li> <li>Linux method (upgrade_tool)</li> <li>MaskRom mode recovery</li> <li>Troubleshooting failed erases</li> </ul> <p>Critical: Data Loss</p> <p>Erasing SPI NAND will permanently delete all data on the NAND flash. This cannot be undone. Ensure you understand the implications before proceeding.</p> <p>More Information</p> <ul> <li>Complete Erase Guide: SPI NAND Erase Guide</li> <li>Boot Priority Details: Hardware Specifications - Boot Priority</li> <li>Luckfox Official Docs: wiki.luckfox.com/Luckfox-Lyra/Image-flashing</li> </ul>"},{"location":"troubleshooting/boot-problems/#hardware-issues","title":"Hardware Issues","text":"<p>Hardware-related boot problems and solutions.</p>"},{"location":"troubleshooting/boot-problems/#sd-card-issues","title":"SD Card Issues","text":"<p>SD card related boot problems.</p> <p>This page is under development and will be populated with detailed troubleshooting information.</p>"},{"location":"troubleshooting/common-issues/","title":"Common Issues","text":"<p>General troubleshooting for common Calculinux problems.</p>"},{"location":"troubleshooting/common-issues/#general-system-issues","title":"General System Issues","text":"<p>Common system problems and their solutions.</p>"},{"location":"troubleshooting/common-issues/#performance-issues","title":"Performance Issues","text":"<p>System performance troubleshooting.</p>"},{"location":"troubleshooting/common-issues/#storage-issues","title":"Storage Issues","text":"<p>Storage-related problems and solutions.</p>"},{"location":"troubleshooting/common-issues/#package-management-issues","title":"Package Management Issues","text":"<p>opkg and package-related troubleshooting.</p> <p>This page is under development and will be populated with detailed troubleshooting information for common issues.</p>"},{"location":"troubleshooting/display/","title":"Display Issues","text":"<p>Troubleshooting display-related problems.</p>"},{"location":"troubleshooting/display/#display-not-working","title":"Display Not Working","text":"<p>Detailed troubleshooting for display issues.</p>"},{"location":"troubleshooting/display/#display-corruption","title":"Display Corruption","text":"<p>Solutions for display corruption problems.</p>"},{"location":"troubleshooting/display/#backlight-issues","title":"Backlight Issues","text":"<p>Backlight troubleshooting information.</p>"},{"location":"troubleshooting/display/#spi-display-problems","title":"SPI Display Problems","text":"<p>SPI-specific display troubleshooting.</p> <p>This page is under development and will be populated with detailed display troubleshooting information.</p>"},{"location":"troubleshooting/erase-nand/","title":"Erasing SPI NAND Flash","text":"<p>This guide explains how to erase the SPI NAND flash memory on Luckfox Lyra boards that include onboard flash storage.</p> <p>Critical Warning: Data Loss</p> <p>Erasing SPI NAND will permanently delete ALL data stored on the NAND flash. This action cannot be undone. Ensure you have backups of any important data before proceeding.</p>"},{"location":"troubleshooting/erase-nand/#why-erase-spi-nand","title":"Why Erase SPI NAND?","text":"<p>The Luckfox Lyra boot process prioritizes SPI NAND flash over SD cards. If your board has SPI NAND with existing firmware:</p> <ul> <li>The board will boot from NAND instead of your Calculinux SD card</li> <li>Your SD card will be ignored even if properly flashed</li> <li>You must erase the NAND to enable SD card booting</li> </ul>"},{"location":"troubleshooting/erase-nand/#which-boards-have-spi-nand","title":"Which Boards Have SPI NAND?","text":"Board Model SPI NAND Notes Luckfox Lyra (Base) \u274c No SD card only Luckfox Lyra B \u2705 Yes 256MB SPI NAND Luckfox Lyra Plus \u2705 Yes 256MB SPI NAND Luckfox Lyra Ultra/Ultra W N/A Uses eMMC, not NAND Luckfox Lyra Zero W Varies Check your specific model Luckfox Lyra Pi Varies Check your specific model"},{"location":"troubleshooting/erase-nand/#checking-if-you-have-spi-nand","title":"Checking If You Have SPI NAND","text":"<p>Visual Inspection: - Look for an additional chip on the board labeled \"SPI NAND\" or similar - Check your purchase order/product specifications</p> <p>Check Product Documentation: - Refer to the Luckfox Lyra documentation for your specific model</p>"},{"location":"troubleshooting/erase-nand/#erasure-methods","title":"Erasure Methods","text":""},{"location":"troubleshooting/erase-nand/#method-1-windows-rkdevtool-recommended","title":"Method 1: Windows - RKDevTool (Recommended)","text":"<p>This is the easiest and most reliable method for most users.</p>"},{"location":"troubleshooting/erase-nand/#prerequisites","title":"Prerequisites","text":"<ul> <li>Windows PC</li> <li>USB Type-A to Type-C cable (data-capable)</li> <li>Luckfox Lyra board with SPI NAND</li> </ul>"},{"location":"troubleshooting/erase-nand/#step-1-download-required-tools","title":"Step 1: Download Required Tools","text":"<ol> <li>RK Driver Assistant: Download v5.13</li> <li>RKDevTool: Download v3.31</li> <li>Luckfox Firmware (any official image): Download from Luckfox</li> </ol>"},{"location":"troubleshooting/erase-nand/#step-2-install-drivers","title":"Step 2: Install Drivers","text":"<ol> <li>Extract the RK Driver Assistant ZIP file</li> <li>Run <code>DriverInstall.exe</code></li> <li>Click \"Install Driver\"</li> <li>Restart your computer after installation completes</li> </ol>"},{"location":"troubleshooting/erase-nand/#step-3-enter-loader-mode","title":"Step 3: Enter Loader Mode","text":"<ol> <li>Extract and open RKDevTool</li> <li>Method A - Using BOOT button:</li> <li>Disconnect the Luckfox Lyra from USB</li> <li>Hold down the BOOT button on the board</li> <li>While holding BOOT, connect the USB cable to your PC</li> <li> <p>Wait 2-3 seconds, then release the BOOT button</p> </li> <li> <p>Method B - Using RESET button:</p> </li> <li>With the board connected via USB</li> <li>Hold down RESET button</li> <li>While holding RESET, press and hold BOOT button</li> <li>Release RESET, wait 2 seconds</li> <li> <p>Release BOOT</p> </li> <li> <p>RKDevTool should display: <code>Found One LOADER Device</code></p> </li> </ol> <p></p> <p>Troubleshooting Device Detection</p> <p>If the device is not detected, check Windows Device Manager:</p> <ul> <li>Correct (Loader Mode): Should show \"Rockusb Device\" under \"Universal Serial Bus controllers\"</li> <li>Wrong: Shows as \"ADB Interface\" or other device</li> </ul> <p>If not detected properly, try a different USB cable or USB port.</p>"},{"location":"troubleshooting/erase-nand/#step-4-erase-the-nand-flash","title":"Step 4: Erase the NAND Flash","text":"<ol> <li>In RKDevTool, click the \"Advanced Function\" tab (\u9ad8\u7ea7\u529f\u80fd)</li> <li>Click \"Erase Flash\" button</li> <li>Wait for the process to complete</li> <li>Tool will display: \"Erase Flash Success\"</li> </ol> <p>Alternatively, you can erase by flashing a minimal firmware:</p> <ol> <li>Click the \"Firmware\" tab</li> <li>Click the folder icon and select the downloaded firmware <code>update.img</code></li> <li>Click \"Upgrade\" button</li> <li>Wait for completion: \"Download Successful\"</li> </ol> <p></p>"},{"location":"troubleshooting/erase-nand/#step-5-verify-erasure","title":"Step 5: Verify Erasure","text":"<ol> <li>Disconnect the USB cable</li> <li>Insert your Calculinux SD card</li> <li>Power on the device</li> <li>The device should now boot from the SD card</li> </ol>"},{"location":"troubleshooting/erase-nand/#method-2-linux-x86_64-platform","title":"Method 2: Linux (x86_64 Platform)","text":"<p>This method uses command-line tools on Linux.</p>"},{"location":"troubleshooting/erase-nand/#prerequisites_1","title":"Prerequisites","text":"<ul> <li>Linux PC (tested on Ubuntu 22.04)</li> <li>Luckfox SDK or upgrade_tool</li> <li>USB Type-A to Type-C cable</li> </ul>"},{"location":"troubleshooting/erase-nand/#step-1-download-tools","title":"Step 1: Download Tools","text":"<p>Download the Luckfox SDK which includes the flashing tools: - Luckfox SDK Setup Guide</p> <p>Or download standalone upgrade_tool: - Available in the SDK under <code>tools/linux/Linux_Upgrade_Tool/</code></p>"},{"location":"troubleshooting/erase-nand/#step-2-enter-loader-mode","title":"Step 2: Enter Loader Mode","text":"<ol> <li>Hold the BOOT button while connecting the board to your PC</li> <li>Verify detection with <code>lsusb</code>:</li> </ol> <pre><code>lsusb | grep Rockchip\n</code></pre> <p>You should see output indicating Loader mode: <pre><code>Bus 001 Device 007: ID 2207:350f Fuzhou Rockchip Electronics Company\n</code></pre></p>"},{"location":"troubleshooting/erase-nand/#step-3-erase-using-rkflashsh","title":"Step 3: Erase Using rkflash.sh","text":"<p>If you have the full SDK:</p> <pre><code>cd /path/to/luckfox-sdk\nsudo ./rkflash.sh erase\n</code></pre>"},{"location":"troubleshooting/erase-nand/#step-4-verify","title":"Step 4: Verify","text":"<pre><code># Check the flash is erased\nsudo ./rkflash.sh query\n</code></pre>"},{"location":"troubleshooting/erase-nand/#method-3-maskrom-mode-advancedrecovery","title":"Method 3: MaskRom Mode (Advanced/Recovery)","text":"<p>Use this method only if Loader Mode fails or the device is in an unrecoverable state.</p> <p>Advanced Users Only</p> <p>MaskRom mode requires physical hardware manipulation and should only be used when Loader mode fails.</p>"},{"location":"troubleshooting/erase-nand/#entering-maskrom-mode","title":"Entering MaskRom Mode","text":"<ol> <li>Locate the Flash Chip: Find the SPI NAND flash chip on your board</li> <li>Identify GND Pin: Locate a ground pin near the flash chip</li> <li>Short Circuit Method:</li> <li>Disconnect power from the board</li> <li>Use tweezers or a wire to short <code>FSPI_CLK</code> pin to <code>GND</code></li> <li>While keeping the short, connect USB cable</li> <li>RKDevTool should display: <code>Found One MASKROM Device</code></li> <li>Remove the short circuit once detected</li> </ol> <ol> <li>Erase in MaskRom:</li> <li>Use RKDevTool \"Erase Flash\" function</li> <li>Or flash a minimal firmware image</li> </ol>"},{"location":"troubleshooting/erase-nand/#method-4-linux-on-the-device-not-yet-documented","title":"Method 4: Linux on the Device (Not Yet Documented)","text":"<p>Method Not Available</p> <p>Methods for erasing SPI NAND directly from Linux running on the Luckfox Lyra (without external flashing tools) are not yet documented or tested. </p> <p>This would theoretically be possible using <code>mtd-utils</code> and <code>/dev/mtdX</code> devices, but specific procedures for Calculinux have not been established.</p>"},{"location":"troubleshooting/erase-nand/#after-erasing","title":"After Erasing","text":"<p>Once the SPI NAND is erased:</p> <ol> <li>Insert SD Card: Insert your Calculinux SD card</li> <li>Power On: Connect power or USB</li> <li>Boot: The device should now boot from the SD card</li> <li>Verify: Check that Calculinux boots successfully</li> </ol>"},{"location":"troubleshooting/erase-nand/#common-issues","title":"Common Issues","text":""},{"location":"troubleshooting/erase-nand/#issue-board-still-boots-from-nand","title":"Issue: Board Still Boots from NAND","text":"<p>Symptoms: SD card is ignored, old firmware still runs</p> <p>Solutions: - Verify the erase completed successfully - Try the erase process again - Try MaskRom mode instead of Loader mode - Check that your SD card is properly flashed</p>"},{"location":"troubleshooting/erase-nand/#issue-cannot-enter-loader-mode","title":"Issue: Cannot Enter Loader Mode","text":"<p>Symptoms: RKDevTool doesn't detect device</p> <p>Solutions: - Try different USB cable (must be data-capable) - Try different USB port - Check Device Manager for driver issues - Reinstall RK Driver Assistant - Try MaskRom mode</p>"},{"location":"troubleshooting/erase-nand/#issue-erase-fails-midway","title":"Issue: Erase Fails Midway","text":"<p>Symptoms: Erase process errors or hangs</p> <p>Solutions: - Disconnect and retry - Try using MaskRom mode - Ensure stable USB connection - Check power supply is adequate</p>"},{"location":"troubleshooting/erase-nand/#issue-device-wont-boot-after-erase","title":"Issue: Device Won't Boot After Erase","text":"<p>Symptoms: No boot after erasing NAND</p> <p>This is expected behavior! With NAND erased and no SD card: - Insert your Calculinux SD card - Power on the device - It should boot from SD card</p>"},{"location":"troubleshooting/erase-nand/#recovery-options","title":"Recovery Options","text":"<p>If you need to restore the original Luckfox firmware to NAND:</p> <ol> <li>Download the official Luckfox firmware for your board model</li> <li>Follow the official flashing guide</li> <li>Flash the firmware to SPI NAND using RKDevTool</li> </ol>"},{"location":"troubleshooting/erase-nand/#additional-resources","title":"Additional Resources","text":"<ul> <li>Official Luckfox Flashing Guide: wiki.luckfox.com/Luckfox-Lyra/Image-flashing</li> <li>Luckfox Forum: forums.luckfox.com</li> <li>RK Driver Downloads: Luckfox Tools</li> </ul>"},{"location":"troubleshooting/erase-nand/#questions","title":"Questions?","text":"<p>If you encounter issues not covered here:</p> <ol> <li>Check the Boot Problems troubleshooting guide</li> <li>Ask in the Calculinux Forum</li> <li>Refer to Luckfox Official Documentation</li> <li>Open a GitHub Issue</li> </ol> <p>Remember: Erasing SPI NAND is a one-way operation. Make sure you understand the implications before proceeding.</p>"},{"location":"troubleshooting/faq/","title":"Troubleshooting &amp; FAQ","text":"<p>Common issues and frequently asked questions about Calculinux.</p>"},{"location":"troubleshooting/faq/#quick-diagnostics","title":"Quick Diagnostics","text":"<p>Before diving into specific issues, run these basic checks:</p> <pre><code># Check system info\nuname -a\ncat /proc/cpuinfo | grep -i \"model name\"\nfree -h\n\n# Check disk space\ndf -h\n\n# Check boot messages\ndmesg | less\n\n# Check system logs\njournalctl -b\n</code></pre>"},{"location":"troubleshooting/faq/#most-common-issues","title":"Most Common Issues","text":""},{"location":"troubleshooting/faq/#issue-system-wont-boot","title":"Issue: System Won't Boot","text":"<p>Symptoms: No display activity, device appears dead</p> <p>Possible Causes: 1. SPI NAND not erased (most common with NAND versions) 2. Corrupt SD card image 3. SD card not inserted properly 4. Insufficient power supply 5. Hardware connection issue</p> <p>Solutions: - See Boot Problems for detailed troubleshooting - Verify SPI NAND was erased: NAND Erasing Guide - Try different power supply (5V/2A minimum) - Reflash SD card - Reseat hardware connections</p>"},{"location":"troubleshooting/faq/#issue-display-not-working","title":"Issue: Display Not Working","text":"<p>Symptoms: System boots but display stays blank</p> <p>Quick Fixes: <pre><code># Check if framebuffer exists\nls -l /dev/fb0\n\n# Test display with color pattern\ncat /dev/urandom &gt; /dev/fb0\n\n# Check display driver\ndmesg | grep -i display\nlsmod | grep fb\n</code></pre></p> <p>See Display Issues for more details.</p>"},{"location":"troubleshooting/faq/#issue-keyboard-not-responding","title":"Issue: Keyboard Not Responding","text":"<p>Symptoms: Cannot type or keys don't register</p> <p>Quick Fixes: <pre><code># Check input devices\ncat /proc/bus/input/devices\n\n# Test keyboard\nevtest /dev/input/event0\n\n# Check driver\ndmesg | grep -i keyboard\n</code></pre></p> <p>See Input Problems for more details.</p>"},{"location":"troubleshooting/faq/#issue-network-not-working","title":"Issue: Network Not Working","text":"<p>Symptoms: Cannot connect to network</p> <p>Quick Check: <pre><code># Check interfaces\nip link\n\n# Check connectivity\nping 8.8.8.8\n\n# Check DNS\ncat /etc/resolv.conf\n</code></pre></p> <p>See Network Issues for solutions.</p>"},{"location":"troubleshooting/faq/#issue-out-of-space","title":"Issue: Out of Space","text":"<p>Symptoms: \"No space left on device\" errors</p> <p>Solution: <pre><code># Check disk usage\ndf -h\n\n# Find large files\ndu -h /home | sort -h | tail -20\n\n# Clean package cache\nopkg clean\n\n# Note: Filesystem expansion is handled automatically by the pre-init script\n# No manual intervention required for SD card expansion\n</code></pre></p>"},{"location":"troubleshooting/faq/#issue-system-running-slow","title":"Issue: System Running Slow","text":"<p>Possible Causes: - Insufficient RAM - Slow SD card - Too many services running - Swap thrashing</p> <p>Solutions: <pre><code># Check memory\nfree -h\n\n# Check swap\nswapon --show\n\n# Check running processes\nhtop  # or top\n\n# Disable unnecessary services\nsystemctl list-unit-files --state=enabled\nsystemctl disable &lt;service-name&gt;\n</code></pre></p>"},{"location":"troubleshooting/faq/#frequently-asked-questions","title":"Frequently Asked Questions","text":""},{"location":"troubleshooting/faq/#general-questions","title":"General Questions","text":"<p>Q: What is Calculinux?</p> <p>A: Calculinux is a Linux distribution built specifically for the PicoCalc handheld computer when equipped with a Luckfox Lyra or compatible SBC. It provides a full Linux environment in a pocket-sized device.</p> <p>Q: Is this the same as the stock PicoCalc firmware?</p> <p>A: No. The stock PicoCalc uses a Raspberry Pi Pico running PicoMite MMBasic firmware. Calculinux requires replacing this with a Luckfox Lyra SBC to run full Linux.</p> <p>Q: Will this void my warranty?</p> <p>A: Yes. Opening the PicoCalc and replacing the internal board voids the warranty. Proceed at your own risk.</p> <p>Q: Can I revert to the original firmware?</p> <p>A: Yes, if you kept the original RP2040 board. Simply reinstall it and reflash the original firmware.</p>"},{"location":"troubleshooting/faq/#hardware-questions","title":"Hardware Questions","text":"<p>Q: Which Luckfox Lyra version should I buy?</p> <p>A: The 128MB version without SPI NAND is recommended for simplicity. The SPI NAND versions work but require an extra NAND erasing step.</p> <p>Q: What size SD card do I need?</p> <p>A: Minimum 8GB, but 16GB or 32GB is recommended for comfortable use.</p> <p>Q: Does it work with other SBCs?</p> <p>A: Currently only Luckfox Lyra is officially supported. Milk-V Duo support is planned. Other boards may work with community modifications.</p> <p>Q: Can I use WiFi?</p> <p>A: Not built-in, but USB WiFi adapters should work (requires testing). USB Ethernet adapters are confirmed working.</p> <p>Q: How long does the battery last?</p> <p>A: Battery life is less than stock firmware due to running full Linux. Expect 4-6 hours depending on usage. External USB battery packs work well, and you can always swap batteries.</p>"},{"location":"troubleshooting/faq/#software-questions","title":"Software Questions","text":"<p>Q: Can I install regular Linux software?</p> <p>A: Yes, using the opkg package manager. Many standard Linux packages are available, though some may not work well on the small display or with limited RAM. We are still building up the software library - if the application you're looking for is not present please request it!</p> <p>Q: Can I run a graphical desktop?</p> <p>A: Yes, lightweight desktop environments like LXDE work on 128MB+ systems. Full desktops like GNOME/KDE are too heavy.</p> <p>Q: Can I run Python/C/other languages?</p> <p>A: Yes, development tools including Python, GCC, and other compilers are available.</p> <p>Q: Can I browse the web?</p> <p>A: Text-mode browsers (lynx, w3m) work well. Graphical browsers require 256MB+ RAM and are slow on the small display.</p> <p>Q: How do I install more software?</p> <p>A: Use the opkg package manager: <pre><code>opkg update\nopkg install &lt;package-name&gt;\n</code></pre></p> <p>See Package Management for details.</p>"},{"location":"troubleshooting/faq/#build-development-questions","title":"Build &amp; Development Questions","text":"<p>Q: How do I build Calculinux from source?</p> <p>A: Follow the Developer Guide, starting with Yocto Setup.</p> <p>Q: How long does a build take?</p> <p>A: First build: ~2 hours depending on your computer. Subsequent builds: much faster (minutes to an hour).</p> <p>Q: Can I contribute to Calculinux?</p> <p>A: Absolutely! See Contributing Guide for how to get involved.</p> <p>Q: Where is the source code?</p> <p>A: GitHub: github.com/Calculinux</p>"},{"location":"troubleshooting/faq/#troubleshooting-questions","title":"Troubleshooting Questions","text":"<p>Q: Why won't my system boot from SD card?</p> <p>A: Most likely SPI NAND interference. If your Luckfox Lyra has SPI NAND, you must erase it first. See Boot Problems.</p> <p>Q: Why is my system so slow?</p> <p>A: Check RAM usage (<code>free -h</code>). With only 128MB, many applications will struggle. If you are trying to use a GUI, you may want to explore other lighter options.</p> <p>Q: Where can I get help?</p> <p>A:  1. Check this documentation 2. Join our Discord Community 3. Search the Forum 4. Open a GitHub issue</p> <p>Q: The display shows garbage/corruption</p> <p>A: Try: - Reducing SPI clock speed in device tree. The default should be stable, however. - Reflashing SD card - Testing with different SD card</p>"},{"location":"troubleshooting/faq/#error-messages","title":"Error Messages","text":""},{"location":"troubleshooting/faq/#common-error-messages-and-solutions","title":"Common Error Messages and Solutions","text":"Error Message Cause Solution \"Kernel panic - not syncing\" Corrupt kernel or bad device tree Reflash SD card, verify image \"No space left on device\" Disk full Clean cache, expand filesystem \"Out of memory\" RAM exhausted Close apps, disable services, upgrade RAM \"Cannot allocate memory\" Memory fragmentation Reboot, reduce memory usage \"Unable to mount root fs\" Bad SD card or partition Check SD card, reflash \"Timeout waiting for device\" Hardware not detected Check connections, verify device tree"},{"location":"troubleshooting/faq/#getting-more-help","title":"Getting More Help","text":"<p>If you can't find a solution here:</p>"},{"location":"troubleshooting/faq/#information-to-include","title":"Information to Include","text":"<p>When asking for help, provide:</p> <ol> <li>Hardware: Luckfox Lyra version (RAM, NAND), SD card brand/size</li> <li>Software: Calculinux version/image variant</li> <li>Error messages: Exact text of errors</li> <li>What you tried: Steps you've already taken</li> <li>Logs: Relevant portions of <code>dmesg</code> or <code>journalctl</code></li> </ol>"},{"location":"troubleshooting/faq/#where-to-ask","title":"Where to Ask","text":"<ul> <li>Documentation: Check specific troubleshooting pages</li> <li>Discord Community: Join our Discord</li> <li>Forum: ClockworkPi Forum Thread</li> <li>GitHub: Issue Tracker</li> <li>Community: Links in Resources</li> </ul>"},{"location":"troubleshooting/faq/#still-stuck","title":"Still Stuck?","text":""},{"location":"troubleshooting/faq/#debug-mode-boot","title":"Debug Mode Boot","text":"<p>Boot with more verbose output:</p> <pre><code># Edit boot command in U-Boot\n# Add to kernel command line:\nloglevel=7 debug\n</code></pre>"},{"location":"troubleshooting/faq/#serial-console","title":"Serial Console","text":"<p>Connect via serial for full boot output:</p> <pre><code># From another computer\nscreen /dev/ttyUSB0 1500000\n</code></pre>"},{"location":"troubleshooting/faq/#safe-mode","title":"Safe Mode","text":"<p>Boot to minimal system:</p> <pre><code># Connect with a serial cable, then reboot.\n# In U-Boot, add to kernel command line:\nsingle\n</code></pre> <p>This boots to single-user mode for recovery.</p>"},{"location":"troubleshooting/faq/#related-pages","title":"Related Pages","text":"<ul> <li>Boot Problems - Detailed boot troubleshooting</li> <li>Display Issues - Display-specific problems</li> <li>Input Problems - Keyboard/input issues</li> <li>Network Issues - Networking problems</li> <li>Common Issues - General issues and solutions</li> </ul> <p>Can't find your issue? Open a documentation issue to request it be added!</p>"},{"location":"troubleshooting/input/","title":"Input Problems","text":"<p>Troubleshooting keyboard and input device issues.</p>"},{"location":"troubleshooting/input/#keyboard-not-responding","title":"Keyboard Not Responding","text":"<p>Detailed keyboard troubleshooting steps.</p>"},{"location":"troubleshooting/input/#key-mapping-issues","title":"Key Mapping Issues","text":"<p>Solutions for incorrect key mappings.</p>"},{"location":"troubleshooting/input/#input-lag","title":"Input Lag","text":"<p>Troubleshooting input lag problems.</p>"},{"location":"troubleshooting/input/#debounce-issues","title":"Debounce Issues","text":"<p>Information about key debounce problems and solutions.</p> <p>This page is under development and will be populated with detailed input troubleshooting information.</p>"},{"location":"troubleshooting/network/","title":"Network Issues","text":"<p>Troubleshooting network connectivity problems.</p>"},{"location":"troubleshooting/network/#wifi-not-working","title":"WiFi Not Working","text":"<p>WiFi troubleshooting steps.</p>"},{"location":"troubleshooting/network/#ethernet-issues","title":"Ethernet Issues","text":"<p>USB Ethernet adapter troubleshooting.</p>"},{"location":"troubleshooting/network/#dns-problems","title":"DNS Problems","text":"<p>DNS resolution issues and solutions.</p>"},{"location":"troubleshooting/network/#connection-timeouts","title":"Connection Timeouts","text":"<p>Network timeout troubleshooting.</p> <p>This page is under development and will be populated with detailed network troubleshooting information.</p>"},{"location":"user-guide/applications/","title":"Applications","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for application guides.</p>"},{"location":"user-guide/applications/#available-applications","title":"Available Applications","text":"<p>For now, please refer to:</p> <ul> <li>Package Management - How to install applications</li> <li>Quick Start Guide - Getting started with the system</li> </ul>"},{"location":"user-guide/applications/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Pre-installed applications</li> <li>Installing new applications</li> <li>Popular application recommendations</li> <li>Application configuration</li> <li>Troubleshooting applications</li> </ul> <p>Content planned for future release</p>"},{"location":"user-guide/basic-usage/","title":"Basic Usage","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for comprehensive usage instructions.</p>"},{"location":"user-guide/basic-usage/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>Quick Start Guide - Essential commands and tips</li> <li>First Boot - Initial setup and configuration</li> <li>Package Management - Installing and managing software</li> </ul>"},{"location":"user-guide/basic-usage/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>Daily usage patterns</li> <li>Command line basics</li> <li>File management</li> <li>System monitoring</li> <li>Common tasks</li> </ul> <p>Content planned for future release</p>"},{"location":"user-guide/configuration/","title":"System Configuration","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for configuration guides.</p>"},{"location":"user-guide/configuration/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>First Boot - Initial configuration</li> <li>Package Management - Managing system packages</li> </ul>"},{"location":"user-guide/configuration/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>System settings</li> <li>User preferences</li> <li>Network configuration</li> <li>Display settings</li> <li>Audio configuration</li> <li>Power management settings</li> </ul> <p>Content planned for future release</p>"},{"location":"user-guide/networking/","title":"Networking","text":"<p>Under Construction</p> <p>This page is currently being developed. Check back soon for networking guides.</p>"},{"location":"user-guide/networking/#getting-started","title":"Getting Started","text":"<p>For now, please refer to:</p> <ul> <li>First Boot - WiFi setup with iwctl</li> <li>Troubleshooting: Network Issues - Network troubleshooting</li> <li>Hardware Specifications - WiFi chipset compatibility</li> </ul>"},{"location":"user-guide/networking/#coming-soon","title":"Coming Soon","text":"<p>This section will cover:</p> <ul> <li>WiFi configuration</li> <li>Ethernet connectivity</li> <li>Network troubleshooting</li> <li>VPN setup</li> <li>Network tools</li> <li>Advanced networking</li> </ul> <p>Content planned for future release</p>"},{"location":"user-guide/package-management/","title":"Package Management","text":"<p>Calculinux uses <code>opkg</code> (Open Package Management) for installing, updating, and removing software packages.</p>"},{"location":"user-guide/package-management/#understanding-package-feeds","title":"Understanding Package Feeds","text":"<p>Calculinux packages are hosted on package feeds at <code>https://opkg.calculinux.org/</code>. Your system is automatically configured to use the appropriate feed based on your installed version. You typically don't need to modify the feed configuration.</p>"},{"location":"user-guide/package-management/#feed-types","title":"Feed Types","text":"<p>Continuous Feed: Rolling release packages with the latest updates - URL format: <code>https://opkg.calculinux.org/ipk/{codename}/continuous/</code> - Updated automatically as changes are made - Best for staying current with development - May include experimental features - Used by main and develop branch builds</p> <p>Release Feed: Stable versioned packages - URL format: <code>https://opkg.calculinux.org/ipk/{codename}/release/</code> - Locked to specific release versions - Thoroughly tested before release - Recommended for production use - Used by tagged releases (e.g., v1.0.0)</p>"},{"location":"user-guide/package-management/#which-feed-am-i-using","title":"Which Feed Am I Using?","text":"<p>Check your current feed configuration:</p> <pre><code>cat /etc/opkg/base-feeds.conf\n</code></pre> <p>Example output for a continuous build: <pre><code>src/gz all https://opkg.calculinux.org/ipk/walnascar/continuous/all\nsrc/gz cortexa7t2hf-neon-vfpv4 https://opkg.calculinux.org/ipk/walnascar/continuous/cortexa7t2hf-neon-vfpv4\nsrc/gz luckfox_lyra https://opkg.calculinux.org/ipk/walnascar/continuous/luckfox_lyra\n</code></pre></p> <p>The feed configuration is set during the image build process and matches the image type: - Images from <code>main</code> branch \u2192 <code>walnascar/continuous</code> feed - Images from <code>develop</code> branch \u2192 <code>develop/continuous</code> feed - Images from tagged releases \u2192 <code>walnascar/release</code> feed</p>"},{"location":"user-guide/package-management/#basic-commands","title":"Basic Commands","text":""},{"location":"user-guide/package-management/#updating-package-lists","title":"Updating Package Lists","text":"<p>Before installing or updating packages, refresh the package list:</p> <pre><code>opkg update\n</code></pre>"},{"location":"user-guide/package-management/#installing-packages","title":"Installing Packages","text":"<p>Install a package:</p> <pre><code>opkg install &lt;package-name&gt;\n</code></pre> <p>Example: <pre><code>opkg install vim\n</code></pre></p>"},{"location":"user-guide/package-management/#removing-packages","title":"Removing Packages","text":"<p>Remove a package:</p> <pre><code>opkg remove &lt;package-name&gt;\n</code></pre> <p>Remove a package and its configuration files:</p> <pre><code>opkg remove --force-removal-of-dependent-packages &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#searching-for-packages","title":"Searching for Packages","text":"<p>Search for available packages:</p> <pre><code>opkg list | grep &lt;search-term&gt;\n</code></pre> <p>Example: <pre><code>opkg list | grep python\n</code></pre></p> <p>Search for installed packages:</p> <pre><code>opkg list-installed | grep &lt;search-term&gt;\n</code></pre>"},{"location":"user-guide/package-management/#viewing-package-information","title":"Viewing Package Information","text":"<p>Get information about a package:</p> <pre><code>opkg info &lt;package-name&gt;\n</code></pre> <p>List files in an installed package:</p> <pre><code>opkg files &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#updating-packages","title":"Updating Packages","text":"<p>Update all installed packages:</p> <pre><code>opkg update\nopkg upgrade\n</code></pre> <p>Update a specific package:</p> <pre><code>opkg update\nopkg upgrade &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#advanced-usage","title":"Advanced Usage","text":""},{"location":"user-guide/package-management/#installing-from-a-file","title":"Installing from a File","text":"<p>Install a <code>.ipk</code> package file directly:</p> <pre><code>opkg install /path/to/package.ipk\n</code></pre>"},{"location":"user-guide/package-management/#listing-available-packages","title":"Listing Available Packages","text":"<p>List all available packages:</p> <pre><code>opkg list\n</code></pre> <p>List all installed packages:</p> <pre><code>opkg list-installed\n</code></pre> <p>List upgradeable packages:</p> <pre><code>opkg list-upgradable\n</code></pre>"},{"location":"user-guide/package-management/#finding-which-package-provides-a-file","title":"Finding Which Package Provides a File","text":"<pre><code>opkg search &lt;filename&gt;\n</code></pre> <p>Example: <pre><code>opkg search /usr/bin/python3\n</code></pre></p>"},{"location":"user-guide/package-management/#package-dependencies","title":"Package Dependencies","text":"<p>View package dependencies:</p> <pre><code>opkg depends &lt;package-name&gt;\n</code></pre> <p>View reverse dependencies (what depends on this package):</p> <pre><code>opkg whatdepends &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#feed-configuration","title":"Feed Configuration","text":"<p>Automatic Configuration</p> <p>Package feeds are automatically configured during image creation. You typically don't need to change feed configuration unless you're testing different package versions or have specific advanced requirements.</p>"},{"location":"user-guide/package-management/#switching-feeds-advanced","title":"Switching Feeds (Advanced)","text":"<p>Advanced Users Only</p> <p>Switching feeds may cause package version conflicts and is only recommended for testing or specific use cases. Most users should use the pre-configured feed that came with their image.</p> <p>To switch from continuous to release feed, edit <code>/etc/opkg/base-feeds.conf</code>:</p> <pre><code># Backup current configuration\ncp /etc/opkg/base-feeds.conf /etc/opkg/base-feeds.conf.backup\n\n# Edit feed URLs\nvi /etc/opkg/base-feeds.conf\n</code></pre> <p>Change <code>continuous</code> to <code>release</code> in all URLs (or vice versa):</p> <pre><code>src/gz all https://opkg.calculinux.org/ipk/walnascar/release/all\nsrc/gz cortexa7t2hf-neon-vfpv4 https://opkg.calculinux.org/ipk/walnascar/release/cortexa7t2hf-neon-vfpv4\nsrc/gz luckfox_lyra https://opkg.calculinux.org/ipk/walnascar/release/luckfox_lyra\n</code></pre> <p>Then update:</p> <pre><code>opkg update\n</code></pre> <p>Persistence</p> <p>Changes to <code>/etc/opkg/base-feeds.conf</code> persist across reboots because Calculinux uses overlayfs - your changes are stored in the upper (writable) layer.</p>"},{"location":"user-guide/package-management/#adding-custom-feeds","title":"Adding Custom Feeds","text":"<p>To add a custom package feed:</p> <pre><code>echo \"src/gz custom-feed https://example.com/ipk/all\" &gt;&gt; /etc/opkg/custom-feeds.conf\nopkg update\n</code></pre>"},{"location":"user-guide/package-management/#development-vs-stable-codenames","title":"Development vs. Stable Codenames","text":"<p>Different Calculinux versions use different distribution codenames in their feed URLs:</p> <ul> <li>walnascar: Stable releases and main branch continuous builds</li> <li>Example: <code>https://opkg.calculinux.org/ipk/walnascar/continuous/</code></li> <li> <p>Example: <code>https://opkg.calculinux.org/ipk/walnascar/release/</code></p> </li> <li> <p>develop: Development branch builds (bleeding-edge features)</p> </li> <li>Example: <code>https://opkg.calculinux.org/ipk/develop/continuous/</code></li> </ul> <p>Codename Compatibility</p> <p>Switching between different codenames (e.g., <code>walnascar</code> \u2194 <code>develop</code>) may cause significant package compatibility issues. This is not recommended except for advanced testing scenarios. If you want bleeding-edge packages, it's better to flash a new develop branch image rather than switching feeds.</p>"},{"location":"user-guide/package-management/#common-tasks","title":"Common Tasks","text":""},{"location":"user-guide/package-management/#installing-development-tools","title":"Installing Development Tools","text":"<pre><code>opkg update\nopkg install gcc g++ make git\n</code></pre>"},{"location":"user-guide/package-management/#installing-python-packages","title":"Installing Python Packages","text":"<pre><code>opkg update\nopkg install python3 python3-pip\n</code></pre>"},{"location":"user-guide/package-management/#installing-networking-tools","title":"Installing Networking Tools","text":"<pre><code>opkg update\nopkg install curl wget netcat iproute2\n</code></pre>"},{"location":"user-guide/package-management/#cleaning-package-cache","title":"Cleaning Package Cache","text":"<p>Free up disk space by removing downloaded package files:</p> <pre><code>rm -rf /var/cache/opkg/*\n</code></pre>"},{"location":"user-guide/package-management/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/package-management/#package-installation-fails","title":"Package Installation Fails","text":"<p>If a package fails to install:</p> <ol> <li> <p>Update package lists:    <pre><code>opkg update\n</code></pre></p> </li> <li> <p>Check available space:    <pre><code>df -h\n</code></pre></p> </li> <li> <p>Check error message for missing dependencies:    <pre><code>opkg install --force-depends &lt;package-name&gt;\n</code></pre></p> </li> </ol>"},{"location":"user-guide/package-management/#repository-connection-issues","title":"Repository Connection Issues","text":"<p>If you can't connect to the package feeds:</p> <ol> <li> <p>Check network connectivity:    <pre><code>ping opkg.calculinux.org\n</code></pre></p> </li> <li> <p>Verify feed URLs:    <pre><code>cat /etc/opkg/base-feeds.conf\n</code></pre></p> </li> <li> <p>Try updating manually:    <pre><code>opkg update --verbosity=3\n</code></pre></p> </li> </ol>"},{"location":"user-guide/package-management/#version-conflicts","title":"Version Conflicts","text":"<p>If you encounter version conflicts:</p> <pre><code># Force reinstallation\nopkg install --force-reinstall &lt;package-name&gt;\n\n# Force downgrade\nopkg install --force-downgrade &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#broken-packages","title":"Broken Packages","text":"<p>To fix broken package installations:</p> <pre><code># Remove partially installed package\nopkg remove --force-remove &lt;package-name&gt;\n\n# Reinstall\nopkg update\nopkg install &lt;package-name&gt;\n</code></pre>"},{"location":"user-guide/package-management/#package-feed-structure","title":"Package Feed Structure","text":"<p>Calculinux package feeds are organized by architecture:</p> <ul> <li>all: Architecture-independent packages</li> <li>cortexa7t2hf-neon-vfpv4: ARM Cortex-A7 optimized packages</li> <li>luckfox_lyra: Board-specific packages for Luckfox Lyra</li> </ul> <p>Your system automatically uses packages from all relevant feeds.</p>"},{"location":"user-guide/package-management/#best-practices","title":"Best Practices","text":"<ol> <li>Always update before installing: Run <code>opkg update</code> before <code>opkg install</code></li> <li>Regular updates: Keep your system updated with <code>opkg update &amp;&amp; opkg upgrade</code></li> <li>Check dependencies: Use <code>opkg info</code> to check dependencies before installing</li> <li>Backup configurations: Keep backups of important config files before major updates</li> <li>Use stable feeds for production: Stick to release feeds for production devices</li> <li>Test on continuous feeds: Use continuous feeds for testing new features</li> </ol>"},{"location":"user-guide/package-management/#comparison-with-other-package-managers","title":"Comparison with Other Package Managers","text":"<p>If you're coming from other Linux distributions:</p> Opkg APT (Debian/Ubuntu) DNF (Fedora) <code>opkg update</code> <code>apt update</code> <code>dnf check-update</code> <code>opkg install</code> <code>apt install</code> <code>dnf install</code> <code>opkg remove</code> <code>apt remove</code> <code>dnf remove</code> <code>opkg list</code> <code>apt list</code> <code>dnf list</code> <code>opkg upgrade</code> <code>apt upgrade</code> <code>dnf upgrade</code>"},{"location":"user-guide/package-management/#see-also","title":"See Also","text":"<ul> <li>System Configuration - Configure your system</li> <li>Updates - System update procedures</li> <li>Building Calculinux - Build configuration and feeds</li> <li>Adding Packages - Create your own packages</li> </ul>"},{"location":"user-guide/updates/","title":"System Updates","text":"<p>Calculinux uses a dual-layer update strategy combining RAUC for system images and OPKG for packages, with automatic reconciliation to keep everything in sync.</p>"},{"location":"user-guide/updates/#overview","title":"Overview","text":"<p>Calculinux employs an A/B slot update system powered by RAUC (Robust Auto-Update Controller). When you install an update, it writes to the inactive slot, leaving your current system untouched. After reboot, the system switches to the new slot, and the old one becomes your rollback option.</p>"},{"location":"user-guide/updates/#update-architecture","title":"Update Architecture","text":"<pre><code>graph TD\n    subgraph base[\"Read-Only Base Image (RAUC Slot)\"]\n        kernel[Kernel]\n        basepkgs[Base System Packages]\n        statusimage[/var/lib/opkg/status.image]\n    end\n\n    subgraph overlay[\"Writable Overlay\"]\n        userpkgs[User-Installed Packages]\n        config[Configuration Files]\n        status[/var/lib/opkg/status]\n    end\n\n    base -.-&gt; overlay\n\n    style base fill:#e1f5ff,stroke:#0288d1,stroke-width:2px\n    style overlay fill:#fff3e0,stroke:#ef6c00,stroke-width:2px</code></pre>"},{"location":"user-guide/updates/#the-calculinux-update-tool-cup","title":"The Calculinux Update Tool (<code>cup</code>)","text":"<p>The <code>calculinux-update</code> package provides the <code>cup</code> command for managing system updates. Two additional internal commands (<code>cup-hook</code> and <code>cup-postreboot</code>) are automatically invoked by the system during the update process\u2014you typically won't need to run these manually.</p>"},{"location":"user-guide/updates/#installing-updates","title":"Installing Updates","text":""},{"location":"user-guide/updates/#interactive-update","title":"Interactive Update","text":"<p>The easiest way to update is interactively:</p> <pre><code>sudo cup install\n</code></pre> <p>This will:</p> <ol> <li>List available channels (if you have multiple enabled)</li> <li>Show available bundles sorted by date (newest first)</li> <li>Let you select which bundle to install</li> <li>Extract bundle metadata (OPKG configuration and package list)</li> <li>Prefetch packages that will be reinstalled after reboot</li> <li>Prompt for confirmation before installing</li> </ol> <p>Each RAUC bundle includes metadata about the new system's package configuration, allowing the update tool to prepare everything needed for a smooth transition.</p>"},{"location":"user-guide/updates/#update-specific-channel","title":"Update Specific Channel","text":"<pre><code>sudo cup install --channel \"Release\"\n</code></pre>"},{"location":"user-guide/updates/#update-with-specific-bundle","title":"Update with Specific Bundle","text":"<p>If you know the bundle name:</p> <pre><code>sudo cup install --bundle calculinux-bundle-walnascar-20251120.raucb\n</code></pre>"},{"location":"user-guide/updates/#non-interactive-update","title":"Non-Interactive Update","text":"<p>For automation or when you're confident:</p> <pre><code>sudo cup install --bundle &lt;name&gt; --yes\n</code></pre>"},{"location":"user-guide/updates/#listing-available-updates","title":"Listing Available Updates","text":""},{"location":"user-guide/updates/#list-all-updates","title":"List All Updates","text":"<pre><code>cup list\n</code></pre>"},{"location":"user-guide/updates/#list-updates-from-specific-channel","title":"List Updates from Specific Channel","text":"<pre><code>cup list --channel \"Continuous\"\n</code></pre>"},{"location":"user-guide/updates/#download-without-installing","title":"Download Without Installing","text":"<p>To download a bundle without installing (useful for offline installation later):</p> <pre><code>cup download --bundle &lt;name&gt;\n</code></pre> <p>By default, bundles are downloaded to <code>/var/cache/calculinux-update/</code>.</p>"},{"location":"user-guide/updates/#package-reconciliation","title":"Package Reconciliation","text":""},{"location":"user-guide/updates/#why-reconciliation-matters","title":"Why Reconciliation Matters","text":"<p>Calculinux uses a dual-layer package system:</p> <ul> <li>Base layer: System packages baked into the read-only RAUC image</li> <li>Overlay layer: User-installed packages stored in writable storage</li> </ul> <p>When you update the base image, this can create problems:</p> <ol> <li>Duplicate packages: A package you installed is now in the new base image</li> <li>Missing packages: The new image removed a package your other packages depend on</li> <li>Version conflicts: Your overlay packages conflict with newer base versions</li> </ol>"},{"location":"user-guide/updates/#automatic-reconciliation","title":"Automatic Reconciliation","text":"<p>The update process automatically handles these issues:</p>"},{"location":"user-guide/updates/#during-update-installation","title":"During Update Installation","text":"<p>When you run <code>sudo cup install</code>, the system:</p> <ol> <li>Extracts bundle metadata - Gets OPKG configuration and package information from the bundle</li> <li>Plans reconciliation - Identifies duplicates, missing packages, and upgrades needed</li> <li>Prefetches packages - Downloads packages that will need reinstallation using the new system's package repositories</li> </ol> <p>This metadata-driven approach allows the update to prepare everything needed before installation, enabling offline reconciliation even if network isn't available after reboot.</p>"},{"location":"user-guide/updates/#during-rauc-installation-via-cup-hook","title":"During RAUC Installation (via <code>cup-hook</code>)","text":"<p>When RAUC installs the new slot:</p> <ol> <li>Removes duplicates - Uninstalls overlay packages now provided by the base</li> <li>Records the plan - Saves which packages need reinstalling/upgrading</li> <li>Prepares for reboot - Everything is ready for the post-reboot phase</li> </ol>"},{"location":"user-guide/updates/#after-reboot-via-cup-postreboot","title":"After Reboot (via <code>cup-postreboot</code>)","text":"<p>When the system boots into the new slot:</p> <ol> <li>Updates package feeds - Runs <code>opkg update</code></li> <li>Reinstalls missing packages - Installs packages from the old base now missing</li> <li>Upgrades overlay packages - Updates all user packages to match new base versions</li> <li>Uses cached packages - Prefers locally cached .ipk files for offline operation</li> </ol>"},{"location":"user-guide/updates/#checking-reconciliation-status","title":"Checking Reconciliation Status","text":"<p>After an update, check the systemd journal:</p> <pre><code>journalctl -u calculinux-update-postreboot.service\n</code></pre> <p>Look for messages like:</p> <pre><code>cup-hook: pruned writable status against new image\ncup-hook: queued 3 packages for reinstall\ncup-hook: queued 5 packages for upgrade\n</code></pre>"},{"location":"user-guide/updates/#configuration","title":"Configuration","text":""},{"location":"user-guide/updates/#update-channels","title":"Update Channels","text":"<p>Edit <code>/etc/calculinux-update.toml</code>:</p> <pre><code>[[channels]]\nname = \"Release\"\npath = \"/update/walnascar/release\"\nenable = true\n\n[[channels]]\nname = \"Continuous\"\npath = \"/update/walnascar/continuous\"\nenable = false\n\n[[channels]]\nname = \"Builds\"\npath = \"/update/walnascar/pr\"\nenable = false\n</code></pre> <p>Set <code>enable = true</code> to show a channel in <code>cup list</code>.</p>"},{"location":"user-guide/updates/#skipping-prefetch","title":"Skipping Prefetch","text":"<p>In some cases you might want to skip prefetch (though metadata extraction still occurs):</p> <pre><code>sudo cup install --no-prefetch\n</code></pre> <p>Warning</p> <p>Without prefetch, post-reboot reconciliation requires network access. The bundle metadata will still be validated to ensure compatibility.</p>"},{"location":"user-guide/updates/#update-process-flow","title":"Update Process Flow","text":"<pre><code>graph TD\n    A[cup install] --&gt; B[Select Bundle]\n    B --&gt; C[Extract Bundle Metadata]\n    C --&gt; D[Plan Reconciliation]\n    D --&gt; E[Prefetch Packages]\n    E --&gt; F[Download Bundle]\n    F --&gt; G[Confirm Install]\n    G --&gt; H[RAUC Install]\n    H --&gt; I[cup-hook: Prepare Reconciliation]\n    I --&gt; J[System Reboots]\n    J --&gt; K[Boot New Slot]\n    K --&gt; L[cup-postreboot: Reconcile Packages]\n    L --&gt; M[Update Complete]</code></pre>"},{"location":"user-guide/updates/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/updates/#update-fails-to-install","title":"Update Fails to Install","text":"<p>Check RAUC status:</p> <pre><code>rauc status\n</code></pre> <p>View detailed logs:</p> <pre><code>journalctl -u rauc -e\n</code></pre>"},{"location":"user-guide/updates/#packages-not-reconciling-after-reboot","title":"Packages Not Reconciling After Reboot","text":"<p>Check the post-reboot service:</p> <pre><code>systemctl status calculinux-update-postreboot.service\njournalctl -u calculinux-update-postreboot.service -e\n</code></pre> <p>Pending operations are stored in:</p> <ul> <li><code>/var/lib/opkg/opkg-status-hook.pending-reinstalls</code></li> <li><code>/var/lib/opkg/opkg-status-hook.pending-upgrades</code></li> </ul>"},{"location":"user-guide/updates/#prefetch-fails","title":"Prefetch Fails","text":"<p>If bundle metadata extraction or prefetch fails, you have several options:</p> <p>Check if bundle is corrupted:</p> <pre><code># Download again if needed\ncup download --bundle &lt;bundle-name&gt;\n</code></pre> <p>Skip prefetch (requires network after reboot):</p> <pre><code>sudo cup install --no-prefetch\n</code></pre> <p>Verify OPKG configuration:</p> <pre><code>cat /etc/opkg/opkg.conf\nopkg update\n</code></pre> <p>Prefetch failures are usually harmless - the system will simply download packages after reboot instead of using pre-cached versions. However, if bundle metadata extraction fails completely, the bundle may be corrupted and should be re-downloaded.</p>"},{"location":"user-guide/updates/#rolling-back-an-update","title":"Rolling Back an Update","text":"<p>RAUC maintains the previous slot as a fallback:</p> <pre><code># Mark current slot as bad and reboot to previous\nsudo rauc status mark-bad booted\nsudo reboot\n</code></pre> <p>Or select the other slot in your bootloader (if supported).</p> <p>Package State After Rollback</p> <p>After rolling back, some manually installed packages may need to be reinstalled, as the reconciliation system currently only runs during forward updates. A list of your installed packages can help:</p> <pre><code># Before updating, save your package list\nopkg list-installed &gt; ~/my-packages.txt\n\n# After rollback, reinstall if needed\ncat ~/my-packages.txt | awk '{print $1}' | xargs opkg install\n</code></pre> <p>Future versions will include automatic rollback detection and reconciliation.</p>"},{"location":"user-guide/updates/#dry-run","title":"Dry Run","text":"<p>Test the update process without actually installing:</p> <pre><code>cup install --dry-run\n</code></pre> <p>This downloads and prepares but doesn't invoke RAUC.</p>"},{"location":"user-guide/updates/#best-practices","title":"Best Practices","text":""},{"location":"user-guide/updates/#before-updating","title":"Before Updating","text":"<ol> <li>Check free space: Ensure <code>/var/cache</code> has room for downloads</li> <li>Backup critical data: Though updates are safe, backups are always good</li> <li>Note your packages: <code>opkg list-installed &gt; my-packages.txt</code></li> </ol>"},{"location":"user-guide/updates/#after-updating","title":"After Updating","text":"<ol> <li>Check reconciliation: <code>journalctl -u calculinux-update-postreboot.service</code></li> <li>Test your applications: Ensure everything still works</li> <li>Keep previous slot: Don't mark it bad until you're confident</li> </ol>"},{"location":"user-guide/updates/#for-development-machines","title":"For Development Machines","text":"<p>Use <code>--no-prefetch</code> and ensure network access:</p> <pre><code>sudo cup install --no-prefetch\n</code></pre>"},{"location":"user-guide/updates/#advanced-usage","title":"Advanced Usage","text":""},{"location":"user-guide/updates/#testing-pr-builds","title":"Testing PR Builds","text":"<p>Enable the Builds channel and install PR bundles:</p> <pre><code># Edit /etc/calculinux-update.toml, set Builds enable = true\ncup list --channel \"Builds\"\nsudo cup install --channel \"Builds\" --bundle calculinux-pr123.raucb\n</code></pre>"},{"location":"user-guide/updates/#automated-updates","title":"Automated Updates","text":"<p>For kiosk or embedded deployments:</p> <pre><code>#!/bin/bash\n# Update to latest release automatically\nBUNDLE=$(cup list --channel \"Release\" | head -1 | awk '{print $1}')\nif [ -n \"$BUNDLE\" ]; then\n    sudo cup install --channel \"Release\" --bundle \"$BUNDLE\" --yes\nfi\n</code></pre>"},{"location":"user-guide/updates/#custom-mirrors","title":"Custom Mirrors","text":"<p>Set <code>mirror_base_url</code> in <code>/etc/calculinux-update.toml</code>:</p> <pre><code>mirror_base_url = \"https://my-mirror.example.com\"\n</code></pre>"},{"location":"user-guide/updates/#related-topics","title":"Related Topics","text":"<ul> <li>Package Management - Installing and managing packages with opkg</li> <li>Configuration - System configuration files</li> <li>Boot Problems - Recovering from boot issues</li> <li>RAUC Documentation - Upstream RAUC docs</li> </ul> <p>For developers working on the update system, see Developer Guide: Calculinux Update</p>"}]}